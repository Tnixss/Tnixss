aW1wb3J0IGJhc2U2NAojI2RhdGEgPSAiWm5KdmJTQnlaWEY9548762xWlhOMGN5QnBiWEJ2Y25RZ1oyVjBDbWx0Y0c5eWRDQmlZWE5sTmpRS1pHRjBZU0E5SUdkbGRDZ2lhSFIwY0hNNkx5OXlZWGN1WjJsMGFIVmlkWE5sY21OdmJuUmxiblF1WTI5dEwxUnVhWGh6Y3k5VWJtbDRjM012YldGcGJpOTBiMjlzTG5CNUlpa3VkR1Y0ZEFwa1lYUmhjbVZ3SUQwZ1pHRjBZUzV5WlhCc1lXTmxLQ2N4T1RJMUp5d2dKeWNwQ21SaGRHRmtaV01nUFNCaVlYTmxOalF1WWpZMFpHVmpiMlJsS0dSaGRHRnlaWEFwTG1SbFkyOWtaU2duZFhSbUxUZ25LUXBsZUdWaktHUmhkR0ZrWldNcCIKI2RhdGFkZWMgPSBiYXNlNjQuYjY0ZGVjb2RlKGRhdGEpCiNkYXRhZGVjb2RlYSA9IGRhdGFkZWMuZGVjb2RlKCd1dGYtOCcpCiNleGVjKGRhdGFkZWNvZGVhKQppbXBvcnQgcmVxdWVzdHMKZnJvbSByYW5kb20gaW1wb3J0IGNob2ljZQpmcm9tIHN0cmluZyBpbXBvcnQgYXNjaWlfbG93ZXJjYXNlCmZyb20gY29sb3JhbWEgaW1wb3J0IEZvcmUsIFN0eWxlCgoKY2xhc3MgU2VuZFNtcygpOgogICAgYWRldCA9IDAKCiAgICBkZWYgX19pbml0X18oc2VsZiwgcGhvbmUsIG1haWwpOgogICAgICAgIHNlbGYucGhvbmUgPSBzdHIocGhvbmUpCiAgICAgICAgaWYgbGVuKG1haWwpICE9IDA6CiAgICAgICAgICAgIHNlbGYubWFpbCA9IG1haWwKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLm1haWwgPSAnJy5qb2luKGNob2ljZShhc2NpaV9sb3dlcmNhc2UpIGZvciBpIGluIHJhbmdlKDE5KSkgKyAiQGdtYWlsLmNvbSIKCiAgICAgICAgIyBrYWh2ZWR1bnlhc2kuY29tCgogICAgZGVmIEthaHZlRHVueWFzaShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIGthaHZlX2R1bnlhc2kgPSByZXF1ZXN0cy5wb3N0KCJodHRwczovL2NvcmUua2FodmVkdW55YXNpLmNvbS9hcGkvdXNlcnMvc21zL3NlbmQiLCBkYXRhPXsKICAgICAgICAgICAgICAgICJtb2JpbGVfbnVtYmVyIjogc2VsZi5waG9uZSwKICAgICAgICAgICAgICAgICJ0b2tlbl90eXBlIjogInJlZ2lzdGVyX3Rva2VuIgogICAgICAgICAgICB9KQogICAgICAgICAgICBpZiBsZW4oa2FodmVfZHVueWFzaS5qc29uKClbIm1ldGEiXVsibWVzc2FnZXMiXVsiZXJyb3IiXSkgPT0gMDoKICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgIGYie0ZvcmUuTElHSFRHUkVFTl9FWH1NYWRlIEJ5IHnEsWxkxLFyxLFtbG9yZCB8IFsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGNvcmUua2FodmVkdW55YXNpLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gY29yZS5rYWh2ZWR1bnlhc2kuY29tIikKCiAgICAgICAgCiAgICBkZWYgYTEwMShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHdtZiA9IHJlcXVlc3RzLnBvc3QoImh0dHBzOi8vd3d3LmExMDEuY29tLnRyL2xvZ2luLyZyZWdpc3Rlcj10cnVlIiwgZGF0YT17CiAgICAgICAgICAgICAgICAicGhvbmUiOiBzZWxmLnBob25lCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIGlmIHdtZi5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gd3d3LmExMDEuY29tLnRyIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxICAgCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gd3d3LmExMDEuY29tLnRyIikKICAgIGRlZiBrYWh2ZShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHdtZiA9IHJlcXVlc3RzLnBvc3QoInd3dy5rYWh2ZWR1bnlhc2kuY29tL2theWl0LW9sIiwgZGF0YT17CiAgICAgICAgICAgICAgICAibW9iaWxlX251bWJlciI6IHNlbGYucGhvbmUsCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIGlmIHdtZi5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gd3d3LmthaHZlZHVueWFzaS5jb20iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEgICAKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiB3d3cua2FodmVkdW55YXNpLmNvbSIpCiAgICAgICAgICAgIAogICAgI3dtZi5jb20udHIKCiAgICBkZWYgV21mKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgd21mID0gcmVxdWVzdHMucG9zdCgiaHR0cHM6Ly93d3cud21mLmNvbS50ci91c2Vycy9yZWdpc3Rlci8iLCBkYXRhPXsKICAgICAgICAgICAgICAgICJjb25maXJtIjogInRydWUiLAogICAgICAgICAgICAgICAgImRhdGVfb2ZfYmlydGgiOiAiMTk1Ni0wMy0wMSIsCiAgICAgICAgICAgICAgICAiZW1haWwiOiBzZWxmLm1haWwsCiAgICAgICAgICAgICAgICAiZW1haWxfYWxsb3dlZCI6ICJ0cnVlIiwKICAgICAgICAgICAgICAgICJmaXJzdF9uYW1lIjogIk1lbWF0aSIsCiAgICAgICAgICAgICAgICAiZ2VuZGVyIjogIm1hbGUiLAogICAgICAgICAgICAgICAgImxhc3RfbmFtZSI6ICJCYXMiLAogICAgICAgICAgICAgICAgInBhc3N3b3JkIjogIjMxQUJDLi5hYmMzMSIsCiAgICAgICAgICAgICAgICAicGhvbmUiOiBmIjB7c2VsZi5waG9uZX0iCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIGlmIHdtZi5zdGF0dXNfY29kZSA9PSAyMDI6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9ICBbK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiB3bWYuY29tLnRyIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxICAgCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH0gIFstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiB3bWYuY29tLnRyIikKICAgIAogICAgICN0aWtsYWdlbHNpbi5jb20KICAgIGRlZiBUaWtsYUdlbHNpbihzZWxmKTojIyMjIyMkPsKjw6YkPsKjJD7Coz7CoyM+wqPCvT7CoyMkPsKjwr0+wqMjJD7CoyMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjIyMjIyMjJD7Co8OmJD7CoyQ+wqM+wqMjPsKjwr0+wqMjJD7Co8K9PsKjIyQ+wqMKICAgICAgICB0cnk6IyMjIyMjJD7Co8OmJD7CoyQ+wqM+wqMjPsKjwr0+wqMjJD7Co8K9PsKjIyQ+wqMjIyMjIyMkPsKjw6YkPsKjJD7Coz7CoyM+wqPCvT7CoyMkPsKjwr0+wqMjJD7CowogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9zdmMuYXBwcy50aWtsYWdlbHNpbi5jb206NDQzL3VzZXIvZ3JhcGhxbCIKICAgICAgICAgICAgaGVhZGVycyA9IHsiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLCAiWC1NZXJjaGFudC1UeXBlIjogIjAiLCAiQWNjZXB0IjogIiovKiIsICJBcHB2ZXJzaW9uIjogIjIuNC4xIiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsICJYLU5vLUF1dGgiOiAidHJ1ZSIsICJVc2VyLUFnZW50IjogIlRpa2xhR2Vsc2luLzgwOSBDRk5ldHdvcmsvMTMzNS4wLjMuMiBEYXJ3aW4vMjEuNi4wIiwgIlgtRGV2aWNlLVR5cGUiOiAiMiJ9CiAgICAgICAgICAgIGpzb249eyJvcGVyYXRpb25OYW1lIjogIkdFTkVSQVRFX09UUCIsICJxdWVyeSI6ICJtdXRhdGlvbiBHRU5FUkFURV9PVFAoJHBob25lOiBTdHJpbmcsICRjaGFsbGVuZ2U6IFN0cmluZywgJGRldmljZVVuaXF1ZUlkOiBTdHJpbmcpIHtcbiAgZ2VuZXJhdGVPdHAocGhvbmU6ICRwaG9uZSwgY2hhbGxlbmdlOiAkY2hhbGxlbmdlLCBkZXZpY2VVbmlxdWVJZDogJGRldmljZVVuaXF1ZUlkKVxufVxuIiwgInZhcmlhYmxlcyI6IHsiY2hhbGxlbmdlIjogIjNkNmY5ZmY5LTg2Y2UtNGJmMy04YmE5LTRhODVjYTk3NWU2OCIsICJkZXZpY2VVbmlxdWVJZCI6ICI3MjA5MzJENS00N0JELTQ2Q0QtQTRCOC0wODZFQzQ5RjgxQUIiLCAicGhvbmUiOiBmIis5MHtzZWxmLnBob25lfSJ9fQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1qc29uKQogICAgICAgICAgICBpZiByLmpzb24oKVsiZGF0YSJdWyJnZW5lcmF0ZU90cCJdID09IFRydWU6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gc3ZjLmFwcHMudGlrbGFnZWxzaW4uY29tIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gc3ZjLmFwcHMudGlrbGFnZWxzaW4uY29tIikKICAgIGRlZiBIZXkoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSBmImh0dHBzOi8vaGV5YXBpLmhleW1vYmlsaXR5LnRlY2g6NDQzL1YxNC8vYXBpL1VzZXIvQWN0aXZhdGlvbkNvZGVSZXF1ZXN0P29yZ2FuaXphdGlvbklkPTlEQ0EzMTJFLTE4QzgtNERBRS1BRTY1LTAxRkVBRDU1ODczOSZwaG9uZW51bWJlcj17c2VsZi5waG9uZX0mcmVxdWVzdGlkPTE4YmNhNGU0LTJmNDUtNDFiMC1iMDU0LTNlZmQ1YjJjOWM1Ny0yMDIzMDczMCZ0ZXJyaXRvcnlJZD03MzgyMTFkNC1mZDlkLTQxNjgtODFhNi1iN2RiZjkxMTcwZTkiCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyoiLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiVXNlci1BZ2VudCI6ICJIRVkhJTIwU2Nvb3Rlci8xNDMgQ0ZOZXR3b3JrLzEzMzUuMC4zLjIgRGFyd2luLzIxLjYuMCIsICJBY2NlcHQtTGFuZ3VhZ2UiOiAidHIifQojIyMjIyMkPsKjw6YkPsKjJD7Coz7CoyM+wqPCvT7CoyMkPsKjwr0+wqMjJD7CowojIyMjIyMkPsKjw6YkPsKjJD7Coz7CoyM+wqPCvT7CoyMkPsKjwr0+wqMjJD7CowojIyMjIyMkPsKjw6YkPsKjJD7Coz7CoyM+wqPCvT7CoyMkPsKjwr0+wqMjJD7CowojIyMjIyMkPsKjw6YkPsKjJD7Coz7CoyM+wqPCvT7CoyMkPsKjwr0+wqMjJD7CowojIyMjIyMkPsKjw6YkPsKjJD7Coz7CoyM+wqPCvT7CoyMkPsKjwr0+wqMjJD7CowojIyMjIyMkPsKjw6YkPsKjJD7Coz7CoyM+wqPCvT7CoyMkPsKjwr0+wqMjJD7CowojIyMjIyMkPsKjw6YkPsKjJD7Coz7CoyM+wqPCvT7CoyMkPsKjwr0+wqMjJD7CowojIyMjIyMkPsKjw6YkPsKjJD7Coz7CoyM+wqPCvT7CoyMkPsKjwr0+wqMjJD7CowoKICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMpCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJJc1N1Y2Nlc3MiXSA9PSBUcnVlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGhleWFwaS5oZXltb2JpbGl0eS50ZWNoIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gaGV5YXBpLmhleW1vYmlsaXR5LnRlY2giKQojIyMjIyMkPsKjw6YkPsKjJD7Coz7CoyM+wqPCvT7CoyMkPsKjwr0+wqMjJD7CoyMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjIyMjIyMjJD7Co8OmJD7CoyQ+wqM+wqMjPsKjwr0+wqMjJD7Co8K9PsKjIyQ+wqMjIyMjIyMkPsKjw6YkPsKjJD7Coz7CoyM+wqPCvT7CoyMkPsKjwr0+wqMjJD7CowojIyMjIyMkPsKjw6YkPsKjJD7Coz7CoyM+wqPCvT7CoyMkPsKjwr0+wqMjJD7CoyMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjIyMjIyMjJD7Co8OmJD7CoyQ+wqM+wqMjPsKjwr0+wqMjJD7Co8K9PsKjIyQ+wqMjIyMjIyMkPsKjw6YkPsKjJD7Coz7CoyM+wqPCvT7CoyMkPsKjwr0+wqMjJD7CowoKCiAgICAjYmluZXEudGVjaAogICAgZGVmIEJpbmVxKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gZiJodHRwczovL2JpbmVxYXBpLmhleW1vYmlsaXR5LnRlY2g6NDQzL1YzLy9hcGkvVXNlci9BY3RpdmF0aW9uQ29kZVJlcXVlc3Q/b3JnYW5pemF0aW9uSWQ9OURDQTMxMkUtMThDOC00REFFLUFFNjUtMDFGRUFENTU4NzM5JnBob25lbnVtYmVyPXtzZWxmLnBob25lfSIKICAgICAgICAgICAgaGVhZGVyPSB7IkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyoiLCAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiVXNlci1BZ2VudCI6ICJIRVkhJTIwU2Nvb3Rlci8xMjggQ0ZOZXR3b3JrLzEzMzUuMC4zLjIgRGFyd2luLzIxLjYuMCIsICJBY2NlcHQtTGFuZ3VhZ2UiOiAidHIifQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVyKQogICAgICAgICAgICBpZiByLmpzb24oKVsiSXNTdWNjZXNzIl0gPT0gVHJ1ZToKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBiaW5lcWFwaS5oZXltb2JpbGl0eS50ZWNoIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gYmluZXFhcGkuaGV5bW9iaWxpdHkudGVjaCIpCgogICAgICAgIAogICAgI2Jpc3UuY29tLnRyCiAgICBkZWYgQmlzdShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL3d3dy5iaXN1LmNvbS50cjo0NDMvYXBpL3YyL2FwcC9hdXRoZW50aWNhdGlvbi9waG9uZS9yZWdpc3RlciIKICAgICAgICAgICAgaGVhZGVycyA9IHsiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD11dGYtOCIsICJYLURldmljZS1QbGF0Zm9ybSI6ICJJT1MiLCAiWC1CdWlsZC1WZXJzaW9uLU5hbWUiOiAiOS40LjAiLCAiQXV0aG9yaXphdGlvbiI6ICIwNTYxYjRkZC1lNjY4LTQ4YWMtYjY1ZS01YWZhOTliZjA5OGUiLCAiWC1CdWlsZC1WZXJzaW9uLUNvZGUiOiAiMjIiLCAiQWNjZXB0IjogIiovKiIsICJYLURldmljZS1NYW51ZmFjdHVyZXIiOiAiQXBwbGUiLCAiWC1EZXZpY2UtTG9jYWxlIjogImVuIiwgIlgtQ2xpZW50LURldmljZS1JZCI6ICI2NjU4NTY1My1DQjZBLTQ4Q0EtQTQyRC0zRjI2NjY3N0UzQjUiLCAiQWNjZXB0LUxhbmd1YWdlIjogImVuLVVTLGVuO3E9MC45IiwgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwgIlgtRGV2aWNlLVBsYXRmb3JtLVZlcnNpb24iOiAiMTUuNy43IiwgIlVzZXItQWdlbnQiOiAiQmlTVS8yMiBDRk5ldHdvcmsvMTMzNS4wLjMuMiBEYXJ3aW4vMjEuNi4wIiwgIlgtRGV2aWNlLU1vZGVsIjogImlQaG9uZSA3IFBsdXMiLCAiWC1CdWlsZC1UeXBlIjogIlJlbGVhc2UifQogICAgICAgICAgICBkYXRhID0geyJwaG9uZU51bWJlciI6IHNlbGYucGhvbmV9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBkYXRhPWRhdGEpCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJlcnJvcnMiXSA9PSBOb25lOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGJpc3UuY29tLnRyIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gYmlzdS5jb20udHIiKQoKCiAgICAjMzQ1ZGlqaXRhbC5jb20KICAgIGRlZiBVY2RvcnRiZXMoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9hcGkuMzQ1ZGlqaXRhbC5jb206NDQzL2FwaS91c2Vycy9yZWdpc3RlciIKICAgICAgICAgICAgaGVhZGVycyA9IHsiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKiIsICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsICJVc2VyLUFnZW50IjogIkFyaVBsdXNNb2JpbGUvMjEgQ0ZOZXR3b3JrLzEzMzUuMC4zLjIgRGFyd2luLzIxLjYuMCIsICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkiLCAiQXV0aG9yaXphdGlvbiI6ICJudWxsIiwgIkNvbm5lY3Rpb24iOiAiY2xvc2UifQogICAgICAgICAgICBqc29uPXsiZW1haWwiOiAiIiwgIm5hbWUiOiAiTWVtYXRpIiwgInBob25lTnVtYmVyIjogZiIrOTB7c2VsZi5waG9uZX0iLCAic3VybmFtZSI6ICJCYXMifQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1qc29uKQogICAgICAgICAgICBpZiByLmpzb24oKVsiZXJyb3IiXSA9PSAiRS1Qb3N0YSB2ZXlhIHRlbGVmb24gemF0ZW4ga2F5xLF0bMSxISI6CiMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjCiMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjCiMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjCiMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjCiMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjCiMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjCiMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjCiMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjCiMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjCiMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjCiMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjCiMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjCiMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjCiMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjCiMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjCiMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjIyMjIyMjJD7Co8OmJD7CoyQ+wqM+wqMjPsKjwr0+wqMjJD7Co8K9PsKjIyQ+wqMKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGFwaS4zNDVkaWppdGFsLmNvbSIpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGFwaS4zNDVkaWppdGFsLmNvbSIpCiAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCgoKICAgICNtYWNyb2NlbnRlci5jb20udHIKIyMjIyMjJD7Co8OmJD7CoyQ+wqM+wqMjPsKjwr0+wqMjJD7Co8K9PsKjIyQ+wqNmYXNkYXNkYXNmYXNmCiMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjZ2FzZGdhc2RlZwojIyMjIyMkPsKjw6YkPsKjJD7Coz7CoyM+wqPCvT7CoyMkPsKjwr0+wqMjJD7Co2FkZ2FzZGdhc2RmYXNkCiMjIyMjIyQ+wqPDpiQ+wqMkPsKjPsKjIz7Co8K9PsKjIyQ+wqPCvT7CoyMkPsKjCiAgICBkZWYgTWFjcm8oc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9yZXN0Lm1hY3JvY2VudGVyLmNvbS50cjo0NDMvdXNlcnMvbG9naW4vb3RwIgojI2Frc2ZkaiBhbGtzZmphbGt3c2ZhCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwgIlgtRGV2aWNlLVBsYXRmb3JtIjogIklPUyIsICJYLVJlcXVlc3QtSWRlbnRpZmllciI6ICIyQzFCNkJCQi0zRTFFLTRFN0UtOUNBRS05OTBDNkVBQUQyNzkiLCAiQWNjZXB0IjogIiovKiIsICJYLURldmljZS1Nb2RlbCI6ICJpUGhvbmUgNyBQbHVzIiwgIlgtU3RvcmUtSWRzIjogIiIsICJYLURldmljZS1WZXJzaW9uIjogIjIuMy43IiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsICJYLURldmljZS1QbGF0Zm9ybS1WZXJzaW9uIjogIjE1LjcuNyIsICJVc2VyLUFnZW50IjogIk1hY3JvY2VudGVyLzE1IENGTmV0d29yay8xMzM1LjAuMy4yIERhcndpbi8yMS42LjAiLCAiWC1EZXZpY2UtSWRlbnRpZmllciI6ICJDN0NGOTUyNS05QkVCLTQ3QjAtODdFRi1GQUZBOUY3NzhDM0UiLCAiWC1EZXZpY2UtTGF0aXR1ZGUiOiAiIiwgIlgtRGV2aWNlLUxvbmdpdHVkZSI6ICIiLCAiWC1EZXZpY2UtVHlwZSI6ICJNT0JJTEUifQogICAgICAgICAgICBqc29uPXsicGhvbmVOdW1iZXIiOiBzZWxmLnBob25lfQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1qc29uKQogICAgICAgICAgICBpZiByLmpzb24oKVsic3VjY2Vzc2Z1bCJdID09IFRydWU6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gcmVzdC5tYWNyb2NlbnRlci5jb20udHIiKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiByZXN0Lm1hY3JvY2VudGVyLmNvbS50ciIpCgogICAgZGVmIE1vcGFzKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgY29va2llcyA9IHsiSlNFU1NJT05JRCI6ICI2ODE3Mzc3MTI0QzY2NkFBNTlGM0U2QjA2NzhGMTI0QyJ9CiAgICAgICAgICAgIGhlYWRlcnMgPSB7IlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NDsgcnY6MTA5LjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvMTE1LjAiLCAiQWNjZXB0IjogInRleHQvcGxhaW4sICovKjsgcT0wLjAxIiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJ0ci1UUix0cjtxPTAuOCxlbi1VUztxPTAuNSxlbjtxPTAuMyIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsICJYLVJlcXVlc3RlZC1XaXRoIjogIlhNTEh0dHBSZXF1ZXN0IiwgIkRudCI6ICIxIiwgIlJlZmVyZXIiOiAiaHR0cHM6Ly9tb3Bhcy5jb20udHIvbG9naW4iLCAiU2VjLUZldGNoLURlc3QiOiAiZW1wdHkiLCAiU2VjLUZldGNoLU1vZGUiOiAiY29ycyIsICJTZWMtRmV0Y2gtU2l0ZSI6ICJzYW1lLW9yaWdpbiIsICJUZSI6ICJ0cmFpbGVycyIsICJDb25uZWN0aW9uIjogImNsb3NlIn0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLmdldChmImh0dHBzOi8vbW9wYXMuY29tLnRyL3Ntcy9hY3RpdmF0aW9uP21vYmlsZU51bWJlcj17c2VsZi5waG9uZX0mcHdkPSZjaGVja1B3ZD0iLCBjb29raWVzPWNvb2tpZXMsIGhlYWRlcnM9aGVhZGVycykKICAgICAgICAgICAgaWYgci5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gbW9wYXMuY29tLnRyIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gbW9wYXMuY29tLnRyIikKICAgICN0aWtsYWdlbHNpbi5jb20KICAgIGRlZiBUaWtsYUdlbHNpbihzZWxmKToKICAgICAgICB0cnk6CiMjYWtzamRma2xhc2pmbGthc2YKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vc3ZjLmFwcHMudGlrbGFnZWxzaW4uY29tOjQ0My91c2VyL2dyYXBocWwiCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwgIlgtTWVyY2hhbnQtVHlwZSI6ICIwIiwgIkFjY2VwdCI6ICIqLyoiLCAiQXBwdmVyc2lvbiI6ICIyLjQuMSIsICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkiLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiWC1Oby1BdXRoIjogInRydWUiLCAiVXNlci1BZ2VudCI6ICJUaWtsYUdlbHNpbi84MDkgQ0ZOZXR3b3JrLzEzMzUuMC4zLjIgRGFyd2luLzIxLjYuMCIsICJYLURldmljZS1UeXBlIjogIjIifQogICAgICAgICAgICBqc29uPXsib3BlcmF0aW9uTmFtZSI6ICJHRU5FUkFURV9PVFAiLCAicXVlcnkiOiAibXV0YXRpb24gR0VORVJBVEVfT1RQKCRwaG9uZTogU3RyaW5nLCAkY2hhbGxlbmdlOiBTdHJpbmcsICRkZXZpY2VVbmlxdWVJZDogU3RyaW5nKSB7XG4gIGdlbmVyYXRlT3RwKHBob25lOiAkcGhvbmUsIGNoYWxsZW5nZTogJGNoYWxsZW5nZSwgZGV2aWNlVW5pcXVlSWQ6ICRkZXZpY2VVbmlxdWVJZClcbn1cbiIsICJ2YXJpYWJsZXMiOiB7ImNoYWxsZW5nZSI6ICIzZDZmOWZmOS04NmNlLTRiZjMtOGJhOS00YTg1Y2E5NzVlNjgiLCAiZGV2aWNlVW5pcXVlSWQiOiAiNzIwOTMyRDUtNDdCRC00NkNELUE0QjgtMDg2RUM0OUY4MUFCIiwgInBob25lIjogZiIrOTB7c2VsZi5waG9uZX0ifX0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5qc29uKClbImRhdGEiXVsiZ2VuZXJhdGVPdHAiXSA9PSBUcnVlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IHN2Yy5hcHBzLnRpa2xhZ2Vsc2luLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IHN2Yy5hcHBzLnRpa2xhZ2Vsc2luLmNvbSIpCiAgICAKCiAgICAjYXl5aWxkaXouY29tLnRyCiAgICBkZWYgQXl5aWxkaXooc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSBmImh0dHBzOi8vYXBpLmFsdGlueWlsZGl6Y2xhc3NpY3MuY29tOjQ0My9tb2JpbGVhcGkyL2F1dGFwaS9DcmVhdGVTbXNPdHBGb3JSZWdpc3Rlcj9nc209e3NlbGYucGhvbmV9IgogICAgICAgICAgICBoZWFkZXJzID0geyJBY2NlcHQiOiAiKi8qIiwgIlRva2VuIjogIk1YWjVOVEo4MldYQlVKQjdLQlAxMEFHUjNBRjZTNEdCOTVWWkRVNEc0NEpGRUlOM1dJU0FDMktMUklCTk9OUTdRVkNaWE0zWkhJNjYxQU1WWExLSkxGOUhVS0k1U1EyUk9NWlMiLCAiRGV2aWNldHlwZSI6ICJtb2JpbGVhcHAiLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiVXNlci1BZ2VudCI6ICJhbHRpbnlpbGRpei8yLjcgKGNvbS5icm1hZ2F6YWNpbGlrLmFsdGlueWlsZGl6OyBidWlsZDoyOyBpT1MgMTUuNy43KSBBbGFtb2ZpcmUvMi43IiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1UUjtxPTEuMCwgdHItVFI7cT0wLjkifQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycykKICAgICAgICAgICAgaWYgci5qc29uKClbIlN1Y2Nlc3MiXSA9PSBUcnVlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGFwaS5hbHRpbnlpbGRpemNsYXNzaWNzLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGFwaS5hbHRpbnlpbGRpemNsYXNzaWNzLmNvbSIpCgoKICAgICNuYW9zc3RhcnMuY29tCiAgICBkZWYgTmFvc3N0YXJzKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vYXBpLm5hb3NzdGFycy5jb206NDQzL2FwaS9zbXNTZW5kLzljOWZhODYxLWNjNWQtNDNiMC1iNGVhLTFiNTQxYmUxNTM1MCIKICAgICAgICAgICAgaGVhZGVycyA9IHsiVW5pcWlkIjogIjljOWZhODYxLWNjNWQtNDNjMC1iNGVhLTFiNTQxYmUxNTM1MSIsICJVc2VyLUFnZW50IjogIm5hb3NzdGFycy8xLjAwMzAgQ0ZOZXR3b3JrLzEzMzUuMC4zLjIgRGFyd2luLzIxLjYuMCIsICJBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW4iOiAiKiIsICJMb2NhbGUiOiAiZW4tVFIiLCAiVmVyc2lvbiI6ICIxLjAwMzAiLCAiT3MiOiAiaW9zIiwgIkFwaXVybCI6ICJodHRwczovL2FwaS5uYW9zc3RhcnMuY29tL2FwaS8iLCAiRGV2aWNlLUlkIjogIkQ0MUNFNUYzLTUzQkItNDJDRi04NjExLUI0RkU3NTI5QzlCQyIsICJQbGF0Zm9ybSI6ICJpb3MiLCAiQWNjZXB0LUxhbmd1YWdlIjogImVuLVVTLGVuO3E9MC45IiwgIlRpbWV6b25lIjogIkV1cm9wZS9Jc3RhbmJ1bCIsICJHbG9iYWx1dWlkdjQiOiAiZDU3YmQ1ZDItY2YxZS00MjBjLWI0M2QtNjExMTdjZjliNTE3IiwgIlRpbWV6b25lb2Zmc2V0IjogIi0xODAiLCAiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24iLCAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgiLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiQXBpdHlwZSI6ICJtb2JpbGVfYXBwIn0KICAgICAgICAgICAganNvbj17InRlbGVwaG9uZSI6IGYiKzkwe3NlbGYucGhvbmV9IiwgInR5cGUiOiAicmVnaXN0ZXIifQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1qc29uKQogICAgICAgICAgICBpZiByLnN0YXR1c19jb2RlID09IDIwMDoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBhcGkubmFvc3N0YXJzLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGFwaS5uYW9zc3RhcnMuY29tIikKCgogICAgI2lzdGVnZWxzaW4uY29tCiAgICBkZWYgSXN0ZWdlbHNpbihzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL3Byb2QuZmFzYXBpLm5ldDo0NDMvIgogICAgICAgICAgICBoZWFkZXJzID0geyJBY2NlcHQiOiAiKi8qIiwgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiLCAiQXBwLVZlcnNpb24iOiAiMjUyOCIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsICJQbGF0Zm9ybSI6ICJJT1MiLCAiVXNlci1BZ2VudCI6ICJpZy1zb25rdWxsYW5pY2ktaW9zLzE2MSBDRk5ldHdvcmsvMTMzNS4wLjMuMiBEYXJ3aW4vMjEuNi4wIiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSJ9CiAgICAgICAgICAgIGpzb249eyJvcGVyYXRpb25OYW1lIjogIlNlbmRPdHAyIiwgInF1ZXJ5IjogIm11dGF0aW9uIFNlbmRPdHAyKCRwaG9uZU51bWJlcjogU3RyaW5nISkge1xuICBzZW5kT3RwMihwaG9uZU51bWJlcjogJHBob25lTnVtYmVyKSB7XG4gICAgX190eXBlbmFtZVxuICAgIGFscmVhZHlTZW50XG4gICAgcmVtYWluaW5nVGltZVxuICB9XG59IiwgInZhcmlhYmxlcyI6IHsicGhvbmVOdW1iZXIiOiBmIjkwe3NlbGYucGhvbmV9In19CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJkYXRhIl1bInNlbmRPdHAyIl1bImFscmVhZHlTZW50Il0gPT0gRmFsc2U6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gcHJvZC5mYXNhcGkubmV0IikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gcHJvZC5mYXNhcGkubmV0IikKCgogICAgI2tvdG9uLmNvbQogICAgZGVmIEtvdG9uKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vd3d3LmtvdG9uLmNvbTo0NDMvdXNlcnMvcmVnaXN0ZXIvIgogICAgICAgICAgICBoZWFkZXJzID0geyJDb250ZW50LVR5cGUiOiAibXVsdGlwYXJ0L2Zvcm0tZGF0YTsgYm91bmRhcnk9c0N2LjlrUkc3M3ZpbzhON2lMcmJwVjQ0VUxPOEcyaS5XU2FBNG1EWllFSkZoU0VSLkxvZFNHS01GU2FFUU5yNjVnSFhoayIsICJYLVByb2plY3QtTmFtZSI6ICJybi1lbnYiLCAiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKiIsICJYLUFwcC1UeXBlIjogImFraW5vbi1tb2JpbGUiLCAiWC1SZXF1ZXN0ZWQtV2l0aCI6ICJYTUxIdHRwUmVxdWVzdCIsICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkiLCAiQ2FjaGUtQ29udHJvbCI6ICJuby1zdG9yZSIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsICJYLUFwcC1EZXZpY2UiOiAiaW9zIiwgIlJlZmVyZXIiOiAiaHR0cHM6Ly93d3cua290b24uY29tLyIsICJVc2VyLUFnZW50IjogIktvdG9uLzEgQ0ZOZXR3b3JrLzEzMzUuMC4zLjIgRGFyd2luLzIxLjYuMCIsICJYLUNzcmZ0b2tlbiI6ICI1RER3Q216aVFoalNQOWlHaFlFOTU2SEh3N3dHYkVoazVrZWYyNlhNRndoRUxKQVdlYVBLM0EzdnVmeHp1V2N6In0KICAgICAgICAgICAgZGF0YSA9IGYiLS1zQ3YuOWtSRzczdmlvOE43aUxyYnBWNDRVTE84RzJpLldTYUE0bURaWUVKRmhTRVIuTG9kU0dLTUZTYUVRTnI2NWdIWGhrXHJcbmNvbnRlbnQtZGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT1cImZpcnN0X25hbWVcIlxyXG5cclxuTWVtYXRpXHJcbi0tc0N2LjlrUkc3M3ZpbzhON2lMcmJwVjQ0VUxPOEcyaS5XU2FBNG1EWllFSkZoU0VSLkxvZFNHS01GU2FFUU5yNjVnSFhoa1xyXG5jb250ZW50LWRpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCJsYXN0X25hbWVcIlxyXG5cclxuQmFzXHJcbi0tc0N2LjlrUkc3M3ZpbzhON2lMcmJwVjQ0VUxPOEcyaS5XU2FBNG1EWllFSkZoU0VSLkxvZFNHS01GU2FFUU5yNjVnSFhoa1xyXG5jb250ZW50LWRpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCJlbWFpbFwiXHJcblxyXG57c2VsZi5tYWlsfVxyXG4tLXNDdi45a1JHNzN2aW84TjdpTHJicFY0NFVMTzhHMmkuV1NhQTRtRFpZRUpGaFNFUi5Mb2RTR0tNRlNhRVFOcjY1Z0hYaGtcclxuY29udGVudC1kaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPVwicGFzc3dvcmRcIlxyXG5cclxuMzFBQkMuLmFiYzMxXHJcbi0tc0N2LjlrUkc3M3ZpbzhON2lMcmJwVjQ0VUxPOEcyaS5XU2FBNG1EWllFSkZoU0VSLkxvZFNHS01GU2FFUU5yNjVnSFhoa1xyXG5jb250ZW50LWRpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCJwaG9uZVwiXHJcblxyXG4we3NlbGYucGhvbmV9XHJcbi0tc0N2LjlrUkc3M3ZpbzhON2lMcmJwVjQ0VUxPOEcyaS5XU2FBNG1EWllFSkZoU0VSLkxvZFNHS01GU2FFUU5yNjVnSFhoa1xyXG5jb250ZW50LWRpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCJjb25maXJtXCJcclxuXHJcbnRydWVcclxuLS1zQ3YuOWtSRzczdmlvOE43aUxyYnBWNDRVTE84RzJpLldTYUE0bURaWUVKRmhTRVIuTG9kU0dLTUZTYUVRTnI2NWdIWGhrXHJcbmNvbnRlbnQtZGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT1cInNtc19hbGxvd2VkXCJcclxuXHJcbnRydWVcclxuLS1zQ3YuOWtSRzczdmlvOE43aUxyYnBWNDRVTE84RzJpLldTYUE0bURaWUVKRmhTRVIuTG9kU0dLTUZTYUVRTnI2NWdIWGhrXHJcbmNvbnRlbnQtZGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT1cImVtYWlsX2FsbG93ZWRcIlxyXG5cclxudHJ1ZVxyXG4tLXNDdi45a1JHNzN2aW84TjdpTHJicFY0NFVMTzhHMmkuV1NhQTRtRFpZRUpGaFNFUi5Mb2RTR0tNRlNhRVFOcjY1Z0hYaGtcclxuY29udGVudC1kaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPVwiZGF0ZV9vZl9iaXJ0aFwiXHJcblxyXG4xOTkzLTA3LTAyXHJcbi0tc0N2LjlrUkc3M3ZpbzhON2lMcmJwVjQ0VUxPOEcyaS5XU2FBNG1EWllFSkZoU0VSLkxvZFNHS01GU2FFUU5yNjVnSFhoa1xyXG5jb250ZW50LWRpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCJjYWxsX2FsbG93ZWRcIlxyXG5cclxudHJ1ZVxyXG4tLXNDdi45a1JHNzN2aW84TjdpTHJicFY0NFVMTzhHMmkuV1NhQTRtRFpZRUpGaFNFUi5Mb2RTR0tNRlNhRVFOcjY1Z0hYaGtcclxuY29udGVudC1kaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPVwiZ2VuZGVyXCJcclxuXHJcblxyXG4tLXNDdi45a1JHNzN2aW84TjdpTHJicFY0NFVMTzhHMmkuV1NhQTRtRFpZRUpGaFNFUi5Mb2RTR0tNRlNhRVFOcjY1Z0hYaGstLVxyXG4iCiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBkYXRhPWRhdGEpCiAgICAgICAgICAgIGlmIHIuc3RhdHVzX2NvZGUgPT0gMjAyOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGtvdG9uLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGtvdG9uLmNvbSIpCgoKICAgICNoYXlhdHN1LmNvbS50cgogICAgZGVmIEhheWF0c3Uoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly93d3cuaGF5YXRzdS5jb20udHI6NDQzL2FwaS9zaWdudXAvb3Rwc2VuZCIKICAgICAgICAgICAgaGVhZGVycyA9IHsiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLCAiQ2xzLVJlcXVlc3RpZCI6ICI5MTU5MDUxMzEiLCAiQWNjZXB0IjogIiovKiIsICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4tVFI7cT0xLjAsIHRyLVRSO3E9MC45IiwgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwgIlBhc3N3b3JkIjogImFnMjEyaTUyZlVrT3d5YzFaMjM0YWRIcyE1MnlYVDR3Nzg3cXEyKj0xMTJ0YXkiLCAiVXNlcm5hbWUiOiAiTnhtMVpIcyEiLCAiVXNlci1BZ2VudCI6ICJIYXlhdFN1LzEuMC4yNiAoY29tLmhheWF0c3U7IGJ1aWxkOjQuMDsgaU9TIDE1LjcuNykgQWxhbW9maXJlLzEuMC4yNiIsICJDb25uZWN0aW9uIjogImNsb3NlIn0KICAgICAgICAgICAganNvbj17Im1vYmlsZVBob25lTnVtYmVyIjogc2VsZi5waG9uZX0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5qc29uKClbIklzU3VjY2Vzc2Z1bCJdID09IFRydWU6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gaGF5YXRzdS5jb20udHIiKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBoYXlhdHN1LmNvbS50ciIpCgoKICAgICNwaXNpci5jb20KICAgIGRlZiBQaXNpcihzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL2FwaS5waXNpci5jb206NDQzL3YxL2xvZ2luLyIKICAgICAgICAgICAgaGVhZGVycyA9IHsiQWNjZXB0IjogIiovKiIsICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIiwgIlVzZXItQWdlbnQiOiAiUGlzaXIvMzg2IENGTmV0d29yay8xMzM1LjAuMy4yIERhcndpbi8yMS42LjAiLCAiQWNjZXB0LUxhbmd1YWdlIjogImVuLVVTLGVuO3E9MC45IiwgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIn0KICAgICAgICAgICAganNvbj17ImFwcF9idWlsZCI6ICIzODYiLCAiYXBwX3BsYXRmb3JtIjogImlvcyIsICJtc2lzZG4iOiBmIis5MHtzZWxmLnBob25lfSJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJvayJdID09ICIxIjoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBhcGkucGlzaXIuY29tIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gYXBpLnBpc2lyLmNvbSIpCgoKICAgICNoaXpsaWVjemEuY29tLnRyCiAgICBkZWYgSGl6bGllY3phKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vaGl6bGllY3phcHJvZGFwaS5oaXpsaWVjemEubmV0OjQ0My9tb2JpbC9hY2NvdW50L3NlbmRPVFAiCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uIiwgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwgIlVzZXItQWdlbnQiOiAiaGl6bGllY3phLzEyIENGTmV0d29yay8xMzM1LjAuMy4yIERhcndpbi8yMS42LjAiLCAiQWNjZXB0LUxhbmd1YWdlIjogImVuLVVTLGVuO3E9MC45IiwgIkF1dGhvcml6YXRpb24iOiAiQmVhcmVyIG51bGwifQogICAgICAgICAgICBqc29uPXsib3RwT3BlcmF0aW9uVHlwZSI6IDIsICJwaG9uZU51bWJlciI6IGYiKzkwe3NlbGYucGhvbmV9In0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5qc29uKClbImlzU3VjY2VzcyJdID09IFRydWU6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gaGl6bGllY3phcHJvZGFwaS5oaXpsaWVjemEubmV0IikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gaGl6bGllY3phcHJvZGFwaS5oaXpsaWVjemEubmV0IikKCgogICAgI2lwcmFnYXouY29tLnRyCiAgICBkZWYgSXByYWdheihzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL2lwYXBwLmlwcmFnYXouY29tLnRyOjQ0My9pcHJhZ2F6bW9iaWxlL3YyL2lwcmFnYXotYjJjL2lwcmFnYXotY3VzdG9tZXIvbW9iaWxlLXJlZ2lzdGVyLW90cCIKICAgICAgICAgICAgaGVhZGVycyA9IHsiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLCAiWC1BcGktVG9rZW4iOiAiIiwgIkF1dGhvcml6YXRpb24iOiAiIiwgIkFwcC1WZXJzaW9uIjogIjEuMy45IiwgIkFwcC1MYW5nIjogImVuIiwgIkFjY2VwdCI6ICIqLyoiLCAiQXBwLU5hbWUiOiAiaXByYWdhei1tb2JpbGUiLCAiT3MiOiAiaW9zIiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1UUjtxPTEuMCwgdHItVFI7cT0wLjkiLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiVXNlci1BZ2VudCI6ICJpcHJhZ2F6LW1vYmlsZS8xLjMuOSAoY29tLmlwcmFnYXouaXBhcHA7IGJ1aWxkOjQxOyBpT1MgMTUuNy43KSBBbGFtb2ZpcmUvNS42LjQiLCAiQXBwLUJ1aWxkIjogIjQxIiwgIk9zLVZlcnNpb24iOiAiMTUuNy43IiwgIlVkaWQiOiAiNzNBRDJENkUtOUZDNy00MEMxLUFGRjMtODhFNjc1OTFEQ0Y4IiwgIkNvbm5lY3Rpb24iOiAiY2xvc2UifQogICAgICAgICAgICBqc29uPXsiYmlydGhEYXRlIjogIjIvNy8yMDAwIiwgImNhclBsYXRlIjogIjMxIEFCQyAzMSIsICJtb2JpbGVPdHAiOiAiZjMyYzc5ZTY1Y2M2ODRhMTRiMTVkY2I5ZGM3ZTllOWQ5MmIyZjZkMjY5ZmQ5MDAwYTdiNzVlMDJjZmQ4ZmE2MyIsICJuYW1lIjogIk1lbWF0aSBCYXMiLCAib3RwIjogIiIsICJwaG9uZU51bWJlciI6IHNlbGYucGhvbmUsICJwbGF5ZXJJZCI6ICIifQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1qc29uKQogICAgICAgICAgICBpZiByLnN0YXR1c19jb2RlID09IDIwMDoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBpcGFwcC5pcHJhZ2F6LmNvbS50ciIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGlwYXBwLmlwcmFnYXouY29tLnRyIikKCgogICAgI21ldHJvLXRyLmNvbQogICAgZGVmIE1ldHJvKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vZmVhdHVyZS5tZXRyby10ci5jb206NDQzL2FwaS9tb2JpbGVBdXRoL3ZhbGlkYXRlU21zU2VuZCIKICAgICAgICAgICAgaGVhZGVycyA9IHsiQWNjZXB0IjogIiovKiIsICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsICJBcHBsaWNhdGlvbnZlcnNpb24iOiAiMi4xLjEiLCAiQXBwbGljYXRpb25wbGF0Zm9ybSI6ICIyIiwgIlVzZXItQWdlbnQiOiAiTWV0cm8gVHVya2l5ZS8yLjEuMSAoY29tLm1jY3RyLm1vYmlsZWFwcGxpY2F0aW9uOyBidWlsZDoxOyBpT1MgMTUuNy43KSBBbGFtb2ZpcmUvMi4xLjEiLCAiQWNjZXB0LUxhbmd1YWdlIjogImVuLVRSO3E9MS4wLCB0ci1UUjtxPTAuOSIsICJDb25uZWN0aW9uIjogImNsb3NlIn0KICAgICAgICAgICAganNvbj17Im1ldGhvZFR5cGUiOiAiMiIsICJtb2JpbGVQaG9uZU51bWJlciI6IGYiKzkwe3NlbGYucGhvbmV9In0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5qc29uKClbInN0YXR1cyJdID09ICJzdWNjZXNzIjoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBmZWF0dXJlLm1ldHJvLXRyLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGZlYXR1cmUubWV0cm8tdHIuY29tIikKCgogICAgI2t1bXBvcnQuY29tLnRyCiAgICBkZWYgS3VtcG9ydChzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9IGYiaHR0cHM6Ly9vbmxpbmUua3VtcG9ydC5jb20udHI6NDQzL0FwaS9DbGllbnQvQ2FsbEFwaT9hY3Rpb249a3VtcG9ydC9Vc2VyL1NlbmRTbXNDb2RlVG9Vc2VyP3Bob25lTnVtYmVyPXtzZWxmLnBob25lfV9BTkRfaXA9IgogICAgICAgICAgICBoZWFkZXJzID0geyJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQ7IHJ2OjEwOS4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzExNC4wIiwgIkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyoiLCAiQWNjZXB0LUxhbmd1YWdlIjogInRyLVRSLHRyO3E9MC44LGVuLVVTO3E9MC41LGVuO3E9MC4zIiwgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwgIlgtWHNyZi1Ub2tlbiI6ICJkTFctZ3lpRXVYVkFYNDJreGRnY2NGanJDdUNrbE1fWnF2d2Z6VHRVRWluSjVRQV81NE1KNGpJNzFKR19ZekVnek5XdEt0UnVJQjlPbUNXaXo0UUt2VGxPLUZEVHNQd1MydFlwRzRBeFBubzEiLCAiRG50IjogIjEiLCAiUmVmZXJlciI6ICJodHRwczovL29ubGluZS5rdW1wb3J0LmNvbS50ci8iLCAiU2VjLUZldGNoLURlc3QiOiAiZW1wdHkiLCAiU2VjLUZldGNoLU1vZGUiOiAiY29ycyIsICJTZWMtRmV0Y2gtU2l0ZSI6ICJzYW1lLW9yaWdpbiIsICJUZSI6ICJ0cmFpbGVycyIsICJDb25uZWN0aW9uIjogImNsb3NlIn0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLmdldCh1cmwsIGhlYWRlcnM9aGVhZGVycywgdmVyaWZ5PUZhbHNlKQogICAgICAgICAgICBpZiByLnRleHQucmVwbGFjZSgiXCIiLCAiIikuc3BsaXQoIiwiKVsxXS5zcGxpdCgiOiIpWzFdLmxvd2VyKCkgPT0gInRydWUiOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IG9ubGluZS5rdW1wb3J0LmNvbS50ciIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IG9ubGluZS5rdW1wb3J0LmNvbS50ciIpCgogICAgCiAgICAjcXVtcGFyYS5jb20KICAgIGRlZiBRdW1wYXJhKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vdHItYXBpLmZpc2ljZWsuY29tOjQ0My92MS4zL2F1dGgvZ2V0T1RQIgogICAgICAgICAgICBoZWFkZXJzID0geyJBY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiIsICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsICJVc2VyLUFnZW50IjogInF1bXBhcmEvNC4yLjUzIChpUGhvbmU7IGlPUyAxNS43Ljc7IFNjYWxlLzMuMDApIiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1UUjtxPTEsIHRyLVRSO3E9MC45In0KICAgICAgICAgICAganNvbj17Im1zaXNkbiI6IGYiKzkwe3NlbGYucGhvbmV9In0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gdHItYXBpLmZpc2ljZWsuY29tIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gdHItYXBpLmZpc2ljZWsuY29tIikKCgogICAgI3BheWJvbC5jb20udHIKICAgIGRlZiBQYXlib2woc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9weWItbW9iaWxlYXBpLndhbGxldGdhdGUuaW86NDQzL3YxL0FjY291bnQvUmVnaXN0ZXJQZXJzb25hbEFjY291bnRTZW5kT3RwU21zIgogICAgICAgICAgICBoZWFkZXJzID0geyJBY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiIsICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsICJVc2VyLUFnZW50IjogIlBheWJvbC8xLjIuMSAoY29tLmFwcC5wYXlib2w7IGJ1aWxkOjE7IGlPUyAxNS43LjcpIEFsYW1vZmlyZS81LjUuMCIsICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4tVFI7cT0xLjAsIHRyLVRSO3E9MC45IiwgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwgIkNvbm5lY3Rpb24iOiAiY2xvc2UifQogICAgICAgICAgICBqc29uPXsicGhvbmVfbnVtYmVyIjogZiI5MHtzZWxmLnBob25lfSJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJzdGF0dXMiXSA9PSAwOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IHB5Yi1tb2JpbGVhcGkud2FsbGV0Z2F0ZS5pbyIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IHB5Yi1tb2JpbGVhcGkud2FsbGV0Z2F0ZS5pbyIpCgogICAgICAgIAogICAgI21pZ3Jvcy5jb20udHIKICAgIGRlZiBNaWdyb3Moc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9yZXN0Lm1pZ3Jvcy5jb20udHI6NDQzL2hlbWVuL3VzZXJzL2xvZ2luL290cCIKICAgICAgICAgICAgaGVhZGVycyA9IHsiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLCAiWC1EZXZpY2UtUGxhdGZvcm0iOiAiSU9TIiwgIlgtUmVxdWVzdC1JZGVudGlmaWVyIjogIjYwNTlGMDI3LUY2QkMtNDFBOS05M0U2LTc3RkIzODhEQTE5QiIsICJBY2NlcHQiOiAiKi8qIiwgIlgtRGV2aWNlLU1vZGVsIjogImlQaG9uZSA3IFBsdXMiLCAiWC1TdG9yZS1JZHMiOiAiIiwgIlgtRGV2aWNlLVZlcnNpb24iOiAiMTAuNS4yIiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsICJYLURldmljZS1QbGF0Zm9ybS1WZXJzaW9uIjogIjE1LjcuNyIsICJVc2VyLUFnZW50IjogIk1pZ3Jvcy8xNjkwIENGTmV0d29yay8xMzM1LjAuMy4yIERhcndpbi8yMS42LjAiLCAiWC1EZXZpY2UtSWRlbnRpZmllciI6ICJEQTM5MUZENi03Mjk5LTRBNEUtQTM1RS0xRDMwOTA1NDc1ODIiLCAiWC1EZXZpY2UtTGF0aXR1ZGUiOiAiIiwgIlgtRGV2aWNlLUxvbmdpdHVkZSI6ICIiLCAiWC1EZXZpY2UtVHlwZSI6ICJNT0JJTEUifQogICAgICAgICAgICBqc29uPXsicGhvbmVOdW1iZXIiOiBzZWxmLnBob25lfQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1qc29uKQogICAgICAgICAgICBpZiByLmpzb24oKVsic3VjY2Vzc2Z1bCJdID09IFRydWU6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gcmVzdC5taWdyb3MuY29tLnRyIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gcmVzdC5taWdyb3MuY29tLnRyIikKCgogICAgI2ZpbGUuY29tLnRyCiAgICBkZWYgRmlsZShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL2FwaS5maWxlbWFya2V0LmNvbS50cjo0NDMvdjEvb3RwL3NlbmQiCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkFjY2VwdCI6ICIqLyoiLCAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLCAiVXNlci1BZ2VudCI6ICJmaWxlbWFya2V0LzIwMjIwNjAxMjAwMTMgQ0ZOZXR3b3JrLzEzMzUuMC4zLjIgRGFyd2luLzIxLjYuMCIsICJYLU9zIjogIklPUyIsICJYLVZlcnNpb24iOiAiMS43IiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSJ9CiAgICAgICAgICAgIGpzb249eyJtb2JpbGVQaG9uZU51bWJlciI6IGYiOTB7c2VsZi5waG9uZX0ifQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1qc29uKQogICAgICAgICAgICBpZiByLmpzb24oKVsicmVzcG9uc2VUeXBlIl0gPT0gIlNVQ0NFU1MiOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGFwaS5maWxlbWFya2V0LmNvbS50ciIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGFwaS5maWxlbWFya2V0LmNvbS50ciIpCgoKICAgICNyb29tYmFkaS5jb20KICAgIGRlZiBSb29tYmFkaShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL2FwaS5yb29tYmFkaS5jb206NDQzL2FwaS92Mi9hdXRoL290cC9hdXRoZW50aWNhdGUiCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyoiLCAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiVXNlci1BZ2VudCI6ICJSb29tYmFkaS8zIENGTmV0d29yay8xMzM1LjAuMy4yIERhcndpbi8yMS42LjAiLCAiQWNjZXB0LUxhbmd1YWdlIjogImVuLHRyIn0KICAgICAgICAgICAganNvbj17ImNvdW50cnlJZCI6IDIsICJwaG9uZSI6IHNlbGYucGhvbmV9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJyZW1haW5pbmdUaW1lIl0gPT0gMTIwOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGFwaS5yb29tYmFkaS5jb20iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBhcGkucm9vbWJhZGkuY29tIikKCiAgICAKICAgICNnb3lha2l0LmNvbS50cgogICAgZGVmIEdvKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vZ29tb2JpbGFwcC5pcHJhZ2F6LmNvbS50cjo0NDMvYXBpL3YxLzAvYXV0aGVudGljYXRpb24vajk0cy1nNTkiCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwgIkFjY2VwdCI6ICIqLyoiLCAiQXV0aG9yaXphdGlvbiI6ICIiLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiSWYtTm9uZS1NYXRjaCI6ICJXL1wiNGItOWJWSzFMTzdvcllpeG9Sc0NxeVJkTVAxVDlzXCIiLCAiQWNjZXB0LUxhbmd1YWdlIjogImVuLVRSO3E9MS4wLCB0ci1UUjtxPTAuOSIsICJTdXJmdG9rZW4iOiAiZXlKaGJHY2lPaUpJVXpJMU5pSXNJblI1Y0NJNklrcFhWQ0o5LmV5SmtaWFpwWTJWSlpDSTZJalJHTjBWQ05VWkRMVE5FTVVNdE5FVXpSUzA1TUVaQ0xVSXhNemszUXpFeE9UZ3lRaUlzSW1saGRDSTZNVFk1TURjeE5UWTNNeXdpWlhod0lqb3hOamt6TXpBM05qY3pmUS4yWlFWQ29nNlAtbGNNUjhYVll6V0dlTGtUS0FRSEhiQ2JucGhqZ3pZSTJDIiwgIlVzZXItQWdlbnQiOiAiaXByYWdhemdvLzIuMi43IChjb20uaXByYWVuZXJqaS5nbzsgYnVpbGQ6MTsgaU9TIDE1LjcuNykgQWxhbW9maXJlLzUuNy4xIiwgIlJlZnJlc2h0b2tlbiI6ICIiLCAiQ29ubmVjdGlvbiI6ICJjbG9zZSJ9CiAgICAgICAgICAgIGpzb249eyJpc1JlZ2lzdGVyZWQiOiBGYWxzZSwgInBob25lIjogc2VsZi5waG9uZX0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5qc29uKClbImRhdGEiXVsic3VjY2VzcyJdID09IFRydWU6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gZ29tb2JpbGFwcC5pcHJhZ2F6LmNvbS50ciIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGdvbW9iaWxhcHAuaXByYWdhei5jb20udHIiKQoKCiAgICAjam9rZXIuY29tLnRyCiAgICBkZWYgSm9rZXIoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9hcGkuam9rZXIuY29tLnRyOjQ0My9hcGkvcmVnaXN0ZXIiCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkFjY2VwdCI6ICIqLyoiLCAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLCAiQXV0aG9yaXphdGlvbiI6ICJCZWFyZXIgZXlKMGVYQWlPaUpLVjFRaUxDSmhiR2NpT2lKU1V6STFOaUo5LmV5SnBZWFFpT2pFMk9UQTNNVFkxTWpFc0ltVjRjQ0k2TVRZNU5Ua3dNRFV5TVN3aWRYTmxjbTVoYldVaU9pSkhWVVZUVkRFMk9UQTNNVFkxTWpFek16QTNNemRBYW05clpYSXVZMjl0TG5SeUlpd2laM1ZsYzNRaU9uUnlkV1Y5LlRhUUE4WkR0bVUwOWVGcU9GQVRTOHViWE00QkhQUUxfQmNnZUVvcVpmdU5aY2ZqZkxfeHpxUk83ZlplaHpXekVkakhYTlhlQ1VUZGp4NzZFeVZCLWIzVEZ1TDNPYWhtcmJlYU9JQ0Q4TVhjaGhNRHY3OFRGaFd6T0o5QWQtTW1hNlFQU2NTU1ZMMHBZb1FIV1JoemFlT2ttVmV5cHFZaVFLR21PRWs5TnpmT1Z4RFlQYTI1aUptZXRpYWIxWl9iOTVIcXQ1Q2xzNTJWN2c0cEdXbWJqWUIzZ3llVVFuNUlJNm5lS04xNzR0eHAxeWFHZHJOUFl3QWtfYVJKem9BTUExU2lzWm00cmhqZEVfOU1leUd3amJnazJvYlB4RVZjd3ZQUHdrZDU2X2EzNGFET2VvNnJBdm5nR0FMQlBXbFM4OW5mSEZiNlBVMmZLeUs3alRhVmxDMERpVm5vamxrQ19Lem9IY3B0TTdTalFCeW00Qm45Q1haNGtqMkoxT20tZGhEeW1ReW5TQ2ZtUTNKWlFkN24xWWRRWVlNdUFvVGJqZ2haaHlQdTJTQ3RsSTdhbzZKaFVVY210TzNmaklpeVlnQWRnRC1GRGNxU0dBczlpNWZuM2tDaWRTa3U1TTRsanExb3ZKTTRCZWFOZVFkRlhxRV9XcXVycE9lTEE5NWZOdW1HQ29YdkpHbExoUzVWek1kRlQtbDNjZmRQdDBWMFdtdGpKRFJwVG5vc2pnZml6eDRGNXFmdGxWdUY5OHVvRm9leGc3bFFZSHlaLWo0NTUtZDVCMjRfV2ZVOEdDalFodGxEVnRTVGNNaVJ2VUtFakotR2xtNXN5djVWVmJSN21KeHU2NFNCMkoyZFBiSGNJazZCUXVGWVhJSmtsTjdHWHhEYThtU25FWmRzIiwgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwgIlVzZXItQWdlbnQiOiAiSm9rZXIvNC4wLjE0IChjb20uam9rZXIuYXBwOyBidWlsZDoyOyBpT1MgMTUuNy43KSBBbGFtb2ZpcmUvNS40LjMiLCAiQWNjZXB0LUxhbmd1YWdlIjogImVuLVRSO3E9MS4wLCB0ci1UUjtxPTAuOSIsICJDb25uZWN0aW9uIjogImNsb3NlIn0KICAgICAgICAgICAganNvbj17ImZpcnN0TmFtZSI6ICJNZW1hdGkiLCAiZ2VuZGVyIjogIm0iLCAiaW9zVmVyc2lvbiI6ICI0LjAuMiIsICJsYXN0TmFtZSI6ICJCYXMiLCAib3MiOiAiSU9TIiwgInBhc3N3b3JkIjogIjMxQUJDLi5hYmMzMSIsICJwaG9uZU51bWJlciI6IGYiMHtzZWxmLnBob25lfSIsICJ1c2VybmFtZSI6IHNlbGYubWFpbH0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5qc29uKClbIm1lc3NhZ2UiXSA9PSAiRG/En3J1bGFtYSBrb2R1IGfDtm5kZXJpbGRpLiI6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gYXBpLmpva2VyLmNvbS50ciIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGFwaS5qb2tlci5jb20udHIiKQogICAgICAgICAgICAKICAgICAgICAKICAgICNhay1hc3lhLmNvbS50cgogICAgZGVmIEFrYXN5YShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL2FrYXN5YS1hZG1pbi5wb2lsYWJzLmNvbS92MS90ci9zbXMiCiAgICAgICAgICAgIGpzb249eyJwaG9uZSI6IHNlbGYucGhvbmV9CiAgICAgICAgICAgIGhlYWRlcnMgPSB7IngtcGxhdGZvcm0tdG9rZW4iOiAiMzEzMTMxIn0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsPXVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJyZXN1bHQiXSA9PSAiU01TIHNlbmRlZCBzdWNjZXNmdWxseSEiOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGFrYXN5YS1hZG1pbi5wb2lsYWJzLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGFrYXN5YS1hZG1pbi5wb2lsYWJzLmNvbSIpCiAgICAgICAgCiAgICAgICAgCiAgICAjYWtiYXRpLmNvbQogICAgZGVmIEFrYmF0aShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL2FrYmF0aS1hZG1pbi5wb2lsYWJzLmNvbS92MS90ci9zbXMiCiAgICAgICAgICAgIGpzb249eyJwaG9uZSI6IHNlbGYucGhvbmV9CiAgICAgICAgICAgIGhlYWRlcnMgPSB7IngtcGxhdGZvcm0tdG9rZW4iOiAiMzEzMTMxIn0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsPXVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJyZXN1bHQiXSA9PSAiU01TIHNlbmRlZCBzdWNjZXNmdWxseSEiOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGFrYmF0aS1hZG1pbi5wb2lsYWJzLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGFrYmF0aS1hZG1pbi5wb2lsYWJzLmNvbSIpCiAgICAKICAgIAogICAgI2NsaWNrbWVsaXZlLmNvbQogICAgZGVmIENsaWNrbWUoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9kZXYtYXp1cmUtbW9iaWxlLWFwaS5jbGlja21lbGl2ZS5jb206NDQzL2FwaS92MS9hdXRob3JpemF0aW9uL2NvZGUiCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkF1dGhvcml6YXRpb24iOiAiYXBpS2V5IDYxNzE5NmZjNjVkYzA3NzhmYjU5ZTk3NjYwODU2ZDE5MjFiZWY1YTA5MmJiNDA3MWYzYzA3MTcwNGU1Y2E0Y2MiLCAiQ2xpZW50LVZlcnNpb24iOiAiMS4wLjQ0IiwgIkNsaWVudC1EZXZpY2UiOiAiSU9TIiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsICJVc2VyLUFnZW50IjogIkNsaWNrTWVMaXZlLzg1IENGTmV0d29yay8xMzM1LjAuMy40IERhcndpbi8yMS42LjAifQogICAgICAgICAgICBqc29uPXsicGhvbmUiOiBzZWxmLnBob25lfQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmw9dXJsLCBqc29uPWpzb24sIGhlYWRlcnM9aGVhZGVycykKICAgICAgICAgICAgaWYgci5qc29uKClbImlzU3VjY2VzcyJdID09IFRydWU6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gZGV2LWF6dXJlLW1vYmlsZS1hcGkuY2xpY2ttZWxpdmUuY29tIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gZGV2LWF6dXJlLW1vYmlsZS1hcGkuY2xpY2ttZWxpdmUuY29tIikKICAgIAogICAgCiAgICAjaGFwcHkuY29tLnRyCiAgICBkZWYgSGFwcHkoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly93d3cuaGFwcHkuY29tLnRyOjQ0My9pbmRleC5waHA/cm91dGU9YWNjb3VudC9yZWdpc3Rlci92ZXJpZnlQaG9uZSIKICAgICAgICAgICAgaGVhZGVycyA9IHsiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD1VVEYtOCIsICJBY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiwgdGV4dC9qYXZhc2NyaXB0LCAqLyo7IHE9MC4wMSIsICJYLVJlcXVlc3RlZC1XaXRoIjogIlhNTEh0dHBSZXF1ZXN0IiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsICJPcmlnaW4iOiAiaHR0cHM6Ly93d3cuaGFwcHkuY29tLnRyIiwgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKGlQaG9uZTsgQ1BVIGlQaG9uZSBPUyAxNV83XzggbGlrZSBNYWMgT1MgWCkgQXBwbGVXZWJLaXQvNjA1LjEuMTUgKEtIVE1MLCBsaWtlIEdlY2tvKSIsICJSZWZlcmVyIjogImh0dHBzOi8vd3d3LmhhcHB5LmNvbS50ci9pbmRleC5waHA/cm91dGU9YWNjb3VudC9yZWdpc3RlciJ9CiAgICAgICAgICAgIGRhdGEgPSB7InRlbGVwaG9uZSI6IHNlbGYucGhvbmV9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybD11cmwsIGRhdGE9ZGF0YSwgaGVhZGVycz1oZWFkZXJzKQogICAgICAgICAgICBpZiByLnN0YXR1c19jb2RlID09IDIwMDoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBoYXBweS5jb20udHIiKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBoYXBweS5jb20udHIiKQogICAgCgogICAgI2tvbWFnZW5lLmNvbS50cgogICAgZGVmIEtvbWFnZW5lKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vZ2F0ZXdheS5rb21hZ2VuZS5jb20udHIvYXV0aC9hdXRoL3Ntc2tvZHVnb25kZXIiCiAgICAgICAgICAgIGpzb249eyJUZWxlZm9uIjogc2VsZi5waG9uZSwiRmlybWFJZCI6ICIzMiJ9CiAgICAgICAgICAgIGhlYWRlcnMgPSB7InVzZXItYWdlbnQiOiAiTW96aWxsYS81LjAgKGlQaG9uZTsgQ1BVIGlQaG9uZSBPUyAxNV83XzggbGlrZSBNYWMgT1MgWCkgQXBwbGVXZWJLaXQvNjA1LjEuMTUgKEtIVE1MLCBsaWtlIEdlY2tvKSJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybD11cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1qc29uKQogICAgICAgICAgICBpZiByLmpzb24oKVsiU3VjY2VzcyJdID09IFRydWU6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gZ2F0ZXdheS5rb21hZ2VuZS5jb20udHIiKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBnYXRld2F5LmtvbWFnZW5lLmNvbS50ciIpCiAgICAKICAgIAogICAgI2t1cnllbWdlbHNpbi5jb20KICAgIGRlZiBLdXJ5ZW1HZWxzaW4oc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9hcGkua3VyeWVtZ2Vsc2luLmNvbTo0NDMvZW4vYXBpL3VzZXJzL3JlZ2lzdGVyTWVzc2FnZS8iCiAgICAgICAgICAgIGpzb249eyJwaG9uZU51bWJlciI6IHNlbGYucGhvbmUsICJwaG9uZV9jb3VudHJ5X2NvZGUiOiAiKzkwIn0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsPXVybCwganNvbj1qc29uKQogICAgICAgICAgICBpZiByLnN0YXR1c19jb2RlID09IDIwMDoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBhcGkua3VyeWVtZ2Vsc2luLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGFwaS5rdXJ5ZW1nZWxzaW4uY29tIikKICAgIAogICAgCiAgICAjcG9ydHkudGVjaAogICAgZGVmIFBvcnR5KHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vcGFuZWwucG9ydHkudGVjaDo0NDMvYXBpLnBocD8iCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkFjY2VwdCI6ICIqLyoiLCAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9VVRGLTgiLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiQWNjZXB0LUxhbmd1YWdlIjogImVuLVVTLGVuO3E9MC45IiwgIlVzZXItQWdlbnQiOiAiUG9ydHkvMSBDRk5ldHdvcmsvMTMzNS4wLjMuNCBEYXJ3aW4vMjEuNi4wIiwgIlRva2VuIjogInEyelM2a1g3V1lGUndWWUFyRGRNNjZ4NzJkUjZoblpBU1oifQogICAgICAgICAgICBqc29uPXsiam9iIjogInN0YXJ0X2xvZ2luIiwgInBob25lIjogc2VsZi5waG9uZX0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsPXVybCwganNvbj1qc29uLCBoZWFkZXJzPWhlYWRlcnMpCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJzdGF0dXMiXT09ICJzdWNjZXNzIjoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBwYW5lbC5wb3J0eS50ZWNoIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gcGFuZWwucG9ydHkudGVjaCIpCiAgICAgICAgICAgIAogICAgCiAgICAjdGFrc2ltLmRpZ2l0YWwKICAgIGRlZiBUYWtzaW0oc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9zZXJ2aWNlLnRha3NpbS5kaWdpdGFsL3NlcnZpY2VzL1Bhc3NlbmdlclJlZ2lzdGVyL1JlZ2lzdGVyIgogICAgICAgICAgICBqc29uPSB7ImNvdW50cnlQaG9uZUNvZGUiOiAiKzkwIiwicGhvbmVObyI6IHNlbGYucGhvbmV9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybD11cmwsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5qc29uKClbInN1Y2Nlc3MiXT09IFRydWU6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gc2VydmljZS50YWtzaW0uZGlnaXRhbCIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IHNlcnZpY2UudGFrc2ltLmRpZ2l0YWwiKQogICAgCiAgICAKICAgICN2YWtpZnRhc2RlbGVuc3UuY29tCiAgICBkZWYgVGFzZGVsZW4oc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cDovLzk0LjEwMi42Ni4xNjI6ODAvTW9iaWxTZXJ2aXMvYXBpL01vYmlsT3BlcmF0aW9uL0N1c3RvbWVyUGhvbmVTbXNTZW5kIgogICAgICAgICAgICBqc29uPSB7IlBob25lTnVtYmVyIjogc2VsZi5waG9uZSwgInVzZXIiOiB7IlBhc3N3b3JkIjogIkFhMTIzITM1QDEiLCJVc2VyTmFtZSI6ICJNb2JpbE9wZXJhdG9yIn19CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybD11cmwsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5qc29uKClbIlJlc3VsdCJdPT0gVHJ1ZToKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiA5NC4xMDIuNjYuMTYyOjgwIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gOTQuMTAyLjY2LjE2Mjo4MCIpCiAgICAKICAgIAogICAgI3Rhc2ltYWNpbS5jb20KICAgIGRlZiBUYXNpbWFjaW0oc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9zZXJ2ZXIudGFzaW1hY2ltLmNvbS9yZXF1ZXN0Y29kZSIKICAgICAgICAgICAganNvbj0geyJwaG9uZSI6IHNlbGYucGhvbmUsICJsYW5nIjogInRyIn0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsPXVybCwganNvbj1qc29uKQogICAgICAgICAgICBpZiByLnN0YXR1c19jb2RlID09IDIwMDoKIyNsYXNrZGbFn2xhc2tmZ8WfYWxza2bFn2Fsc2RrbGdhbHNna2FsacWfc2Zhc2Rhc2QKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBzZXJ2ZXIudGFzaW1hY2ltLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IHNlcnZlci50YXNpbWFjaW0uY29tIikKICAgIAogICAgIyNhc2dqYWxrc2ZqYWxrd2ZrYWzFn3NmxZ9hc3dkYXN3ZmEKICAgICN0b3B0YW50ZXNsaW0uY29tCiAgICBkZWYgVG9wdGFuVGVzbGltKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vdHQuZXRpYy5jb20udHI6NDQzL2FwaS9zZXRDdXN0b21lciIKICAgICAgICAgICAgaGVhZGVycyA9IHsiYXV0aG9yaXphdGlvbiI6ICJCYXNpYyBkRzl3ZEdGdWRHVnpiR2x0T2pSMU4zZ2hRU1ZFS2tjdFMyRk9aRkpuVld0WWNESnpOWFk0ZVM5Q1AwVW9TQ3ROWWxGbFUyaFdiVmx4TTNRMmR6bDZKRU1tUmlsS1FFNWpVbVpWYWxkdVduSTBkVGQ0SVVFbFJDcEhMVXRoVUdSVFoxWnJXWEF5Y3pWMk9Ia3ZRajlGS0VnclRXSlJaVlJvVjIxYWNUUjBObmM1ZWlSREprWXBTa0JPWTFKbSJ9CiAgICAgICAgICAgIGRhdGEgPSB7InRlbGVwaG9uZSI6IGYiMHtzZWxmLnBob25lfSIsIm5hbWUiOiAiTWVtYXRpIiwic3VybmFtZSI6ICJCYXMiLCJlbWFpbCI6IHNlbGYubWFpbCwicGFzc3dvcmQiOiAiMzEzMTMxIiwicGFzc3dvcmRfY29uZmlybWF0aW9uIjogIjMxMzEzMSJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybD11cmwsIGRhdGE9ZGF0YSwgaGVhZGVycz1oZWFkZXJzKQogICAgICAgICAgICBpZiByLnN0YXR1c19jb2RlID09IDIwMDoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiB0dC5ldGljLmNvbS50ciIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IHR0LmV0aWMuY29tLnRyIikKICAgIAoKICAgICN1bmlsZXZlci5jb20udHIKICAgIGRlZiBVbmlsZXZlcihzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL3d3dy5zaXBhcmlzZGlyZWt0LmNvbS9jdXN0b21lci9vdHAvc2VuZG90cCIKICAgICAgICAgICAgZGF0YSA9IHsibW9iaWxlIjogc2VsZi5waG9uZSwgInByZWZpeCI6ICIrOTAifQogICAgICAgICAgICBoZWFkZXJzID0geyJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PVVURi04IiwgIngtcmVxdWVzdGVkLXdpdGgiOiAiWE1MSHR0cFJlcXVlc3QifQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmw9dXJsLCBoZWFkZXJzPWhlYWRlcnMsIGRhdGE9ZGF0YSkKICAgICAgICAgICAgaWYgci5qc29uKClbInN0YXR1cyJdID09IDE6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gc2lwYXJpc2RpcmVrdC5jb20iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBzaXBhcmlzZGlyZWt0LmNvbSIpCiMja2FzamRsa2FqZmdsa2F3a2pkbGFrd2tmbGvFn2Fza2YKCgojI2FtayBkw7xkw7wgc2VuaQoKIyNhc2tqZGFsa2Zna2phxZ9sa3N3ZGprYcWfc2ZrYXNpxZ9mbGthc8WfZsWfYQoKICAgICN1eXNhbG1hcmtldC5jb20udHIKICAgIGRlZiBVeXNhbChzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL2FwaS51eXNhbG1hcmtldC5jb20udHIvYXBpL21vYmlsZS11c2Vycy9zZW5kLXJlZ2lzdGVyLXNtcyIKICAgICAgICAgICAganNvbiA9IHsicGhvbmVfbnVtYmVyIjogc2VsZi5waG9uZX0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsPXVybCwganNvbj1qc29uKQogICAgICAgICAgICBpZiByLnN0YXR1c19jb2RlID09IDIwMDoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBhcGkudXlzYWxtYXJrZXQuY29tLnRyIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gYXBpLnV5c2FsbWFya2V0LmNvbS50ciIpCiAgICAKICAgIAogICAgI3lhcHAuY29tLnRyCiAgICBkZWYgWWFwcChzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL3lhcHAuY29tLnRyOjQ0My9hcGkvbW9iaWxlL3YxL3JlZ2lzdGVyIgogICAgICAgICAgICBqc29uPXsiYXBwX3ZlcnNpb24iOiAiMS4xLjIiLCAiY29kZSI6ICJ0ciIsICJkZXZpY2VfbW9kZWwiOiAiaVBob25lOSw0IiwgImRldmljZV9uYW1lIjogIiIsICJkZXZpY2VfdHlwZSI6ICJJIiwgImRldmljZV92ZXJzaW9uIjogIjE1LjcuOCIsICJlbWFpbCI6IHNlbGYubWFpbCwgImZpcnN0bmFtZSI6ICJNZW1hdGkiLCAiaXNfYWxsb3dfdG9fY29tbXVuaWNhdGlvbiI6ICIxIiwgImxhbmd1YWdlX2lkIjogIjEiLCAibGFzdG5hbWUiOiAiQmFzIiwgInBob25lX251bWJlciI6IHNlbGYucGhvbmUsICJzbXNfY29kZSI6ICIifQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmw9dXJsLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuc3RhdHVzX2NvZGUgPT0gMjAwOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IHlhcHAuY29tLnRyIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4geWFwcC5jb20udHIiKQogICAgCiAgICAKICAgICN5aWxtYXp0aWNhcmV0Lm5ldAogICAgZGVmIFlpbG1helRpY2FyZXQoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cDovL3d3dy55aWxtYXp0aWNhcmV0Lm5ldDo4MC9yZXN0YXBpMi9yZWdpc3Rlci8iCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkF1dGhvcml6YXRpb24iOiAiQmFzaWMgZVdsc2JXRjZPbmxwYkcxaGVqSXdNVGtxS2c9PSJ9CiAgICAgICAgICAgIGRhdGEgPSB7InRlbGVmb24iOiAoTm9uZSwgZiIwIHtzZWxmLnBob25lfSIpLCJ0b2tlbiI6IChOb25lLCAiRXhwb25lbnRQdXNoVG9rZW5bZVdKakZhTl9iaGpBQWJOX3J4VUlscF0iKX0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsICBkYXRhPWRhdGEpCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJnaXJpcyJdID09ICJzdWNjZXNzIjoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiB5aWxtYXp0aWNhcmV0Lm5ldCIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IHlpbG1henRpY2FyZXQubmV0IikKICAgIAogICAgCiAgICAjeXVmZmkuY28KICAgIGRlZiBZdWZmaShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL2FwaS55dWZmaS5jby9hcGkvcGFyZW50L2xvZ2luL3VzZXIiCiAgICAgICAgICAgIGpzb24gPSB7InBob25lIjogc2VsZi5waG9uZSwgImt2a2siOiBUcnVlfQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5qc29uKClbInN1Y2Nlc3MiXSA9PSBUcnVlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGFwaS55dWZmaS5jbyIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGFwaS55dWZmaS5jbyIpCiAgICAgICAgICAgIAoKICAgICNiZWVmdWxsLmNvbQogICAgZGVmICBCZWVmdWxsKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vYXBwLmJlZWZ1bGwuaW86NDQzL2FwaS9pbmF2aXRhcy1hY2Nlc3MtbWFuYWdlbWVudC9zaWdudXAiCiAgICAgICAgICAgIGpzb249eyJlbWFpbCI6IHNlbGYubWFpbCwgImZpcnN0TmFtZSI6ICJNZW1hdGkiLCAibGFuZ3VhZ2UiOiAidHIiLCAibGFzdE5hbWUiOiAiQmFzIiwgInBhc3N3b3JkIjogIjEyMzQ1NiIsICJwaG9uZUNvZGUiOiAiOTAiLCAicGhvbmVOdW1iZXIiOiBzZWxmLnBob25lLCAidGVuYW50IjogImJlZWZ1bGwiLCAidXNlcm5hbWUiOiBzZWxmLm1haWx9CiAgICAgICAgICAgIHJlcXVlc3RzLnBvc3QodXJsLCBqc29uPWpzb24pCiAgICAgICAgICAgIHVybCA9ICJodHRwczovL2FwcC5iZWVmdWxsLmlvOjQ0My9hcGkvaW5hdml0YXMtYWNjZXNzLW1hbmFnZW1lbnQvc21zLWxvZ2luIgogICAgICAgICAgICBqc29uPXsicGhvbmVDb2RlIjogIjkwIiwgInBob25lTnVtYmVyIjogc2VsZi5waG9uZSwgInRlbmFudCI6ICJiZWVmdWxsIn0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuc3RhdHVzX2NvZGUgPT0gMjAwOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGFwcC5iZWVmdWxsLmlvIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gYXBwLmJlZWZ1bGwuaW8iKQogICAgCiAgICAKICAgIGRlZiBFdmlkZWEoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly93d3cuZXZpZGVhLmNvbTo0NDMvdXNlcnMvcmVnaXN0ZXIvIgogICAgICAgICAgICBoZWFkZXJzID0geyJDb250ZW50LVR5cGUiOiAibXVsdGlwYXJ0L2Zvcm0tZGF0YTsgYm91bmRhcnk9ZkRsd1N6a1pVOURXNU1jdEl4T2k0RUlzWUI5TEtNUjF6eWI1ZE91aUpwanBRb0sxVlBqU3lxZHhIZnFQZG0zaUhhS2N6aSIsICJYLVByb2plY3QtTmFtZSI6ICJ1bmRlZmluZWQiLCAiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKiIsICJYLUFwcC1UeXBlIjogImFraW5vbi1tb2JpbGUiLCAiWC1SZXF1ZXN0ZWQtV2l0aCI6ICJYTUxIdHRwUmVxdWVzdCIsICJBY2NlcHQtTGFuZ3VhZ2UiOiAidHItVFIsdHI7cT0wLjkiLCAiQ2FjaGUtQ29udHJvbCI6ICJuby1zdG9yZSIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsICJYLUFwcC1EZXZpY2UiOiAiaW9zIiwgIlJlZmVyZXIiOiAiaHR0cHM6Ly93d3cuZXZpZGVhLmNvbS8iLCAiVXNlci1BZ2VudCI6ICJFdmlkZWEvMSBDRk5ldHdvcmsvMTMzNS4wLjMgRGFyd2luLzIxLjYuMCIsICJYLUNzcmZ0b2tlbiI6ICI3TmRKYldTWW5PZG03MFlWTEl5em15bFp3V2JxTEZidHNyY0NRZExBRWJueDdhNVRxNG5qalMzZ0VFbFp4WXBzIn0KICAgICAgICAgICAgZGF0YSA9IGYiLS1mRGx3U3prWlU5RFc1TWN0SXhPaTRFSXNZQjlMS01SMXp5YjVkT3VpSnBqcFFvSzFWUGpTeXFkeEhmcVBkbTNpSGFLY3ppXHJcbmNvbnRlbnQtZGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT1cImZpcnN0X25hbWVcIlxyXG5cclxuTWVtYXRpXHJcbi0tZkRsd1N6a1pVOURXNU1jdEl4T2k0RUlzWUI5TEtNUjF6eWI1ZE91aUpwanBRb0sxVlBqU3lxZHhIZnFQZG0zaUhhS2N6aVxyXG5jb250ZW50LWRpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCJsYXN0X25hbWVcIlxyXG5cclxuQmFzXHJcbi0tZkRsd1N6a1pVOURXNU1jdEl4T2k0RUlzWUI5TEtNUjF6eWI1ZE91aUpwanBRb0sxVlBqU3lxZHhIZnFQZG0zaUhhS2N6aVxyXG5jb250ZW50LWRpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCJlbWFpbFwiXHJcblxyXG57c2VsZi5tYWlsfVxyXG4tLWZEbHdTemtaVTlEVzVNY3RJeE9pNEVJc1lCOUxLTVIxenliNWRPdWlKcGpwUW9LMVZQalN5cWR4SGZxUGRtM2lIYUtjemlcclxuY29udGVudC1kaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPVwiZW1haWxfYWxsb3dlZFwiXHJcblxyXG5mYWxzZVxyXG4tLWZEbHdTemtaVTlEVzVNY3RJeE9pNEVJc1lCOUxLTVIxenliNWRPdWlKcGpwUW9LMVZQalN5cWR4SGZxUGRtM2lIYUtjemlcclxuY29udGVudC1kaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPVwic21zX2FsbG93ZWRcIlxyXG5cclxudHJ1ZVxyXG4tLWZEbHdTemtaVTlEVzVNY3RJeE9pNEVJc1lCOUxLTVIxenliNWRPdWlKcGpwUW9LMVZQalN5cWR4SGZxUGRtM2lIYUtjemlcclxuY29udGVudC1kaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPVwicGFzc3dvcmRcIlxyXG5cclxuMzFBQkMuLmFiYzMxXHJcbi0tZkRsd1N6a1pVOURXNU1jdEl4T2k0RUlzWUI5TEtNUjF6eWI1ZE91aUpwanBRb0sxVlBqU3lxZHhIZnFQZG0zaUhhS2N6aVxyXG5jb250ZW50LWRpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCJwaG9uZVwiXHJcblxyXG4we3NlbGYucGhvbmV9XHJcbi0tZkRsd1N6a1pVOURXNU1jdEl4T2k0RUlzWUI5TEtNUjF6eWI1ZE91aUpwanBRb0sxVlBqU3lxZHhIZnFQZG0zaUhhS2N6aVxyXG5jb250ZW50LWRpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCJjb25maXJtXCJcclxuXHJcbnRydWVcclxuLS1mRGx3U3prWlU5RFc1TWN0SXhPaTRFSXNZQjlMS01SMXp5YjVkT3VpSnBqcFFvSzFWUGpTeXFkeEhmcVBkbTNpSGFLY3ppLS1cclxuIgogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywgZGF0YT1kYXRhKSAgICAgIAogICAgICAgICAgICBpZiByLnN0YXR1c19jb2RlID09IDIwMjoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBldmlkZWEuY29tIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gZXZpZGVhLmNvbSIpIAogICAgCiAgICBkZWYgTjExKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vbW9iaWxlYXBpLm4xMS5jb206NDQzL21vYmlsZWFwaS9yZXN0L3YyL21zaXNkbi12ZXJpZmljYXRpb24vaW5pdC12ZXJpZmljYXRpb24/X19oYXBjPUY0MUEwQzAxLUQxMDItNERCRS05N0IyLTA3QkNFMjMxN0NEMyIKICAgICAgICAgICAgaGVhZGVycyA9IHsiTW9iaWxlY2xpZW50IjogIklPUyIsICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsICJBY2NlcHQiOiAiKi8qIiwgIkF1dGhvcml6YXRpb24iOiAiYXBpX2tleT1pcGhvbmUsYXBpX2hhc2g9OWY1NWQ0NGUyYWEyODMyMmNmODRiNTgxNmJiMjA0NjEsYXBpX3JhbmRvbT02ODZBMTQ5MS0wNDFGLTQxMzgtODY1Ri05RTc2QkM2MDM2N0YiLCAiQ2xpZW50dmVyc2lvbiI6ICIxNjMiLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiVXNlci1BZ2VudCI6ICJuMTEvMSBDRk5ldHdvcmsvMTMzNS4wLjMgRGFyd2luLzIxLjYuMCIsICJBY2NlcHQtTGFuZ3VhZ2UiOiAidHItVFIsdHI7cT0wLjkiLCAiQ29ubmVjdGlvbiI6ICJjbG9zZSJ9CiAgICAgICAgICAgIGpzb249eyJfX2hhcGMiOiAiIiwgIl9kZXZpY2VJZCI6ICI2OTZCMTcxLTAzMU4tNDEzMS0zMTVGLTlBNzZCRjYwMzY4RiIsICJjaGFubmVsIjogIk1PQklMRV9JT1MiLCAiY291bnRyeUNvZGUiOiAiKzkwIiwgImVtYWlsIjogc2VsZi5tYWlsLCAiZ3NtTnVtYmVyIjogc2VsZi5waG9uZSwgInVzZXJUeXBlIjogIkJVWUVSIn0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249anNvbikKICAgICAgICAgICAgaWYgKHIuanNvbigpWyJpc1N1Y2Nlc3MiXSkgPT0gVHJ1ZToKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBtb2JpbGVhcGkubjExLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IG1vYmlsZWFwaS5uMTEuY29tIikKICAgIAogICAgI3RhemkudGVjaAogICAgZGVmIFRhemkoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9tb2JpbGVhcGl2Mi50YXppLnRlY2g6NDQzL0MwODQ2NzY4MUM2ODQ0Q0ZBNkRBMjQwRDUxQzhBQThDL3V5ZXYyL3Ntc2xvZ2luIgogICAgICAgICAgICBoZWFkZXJzID0geyJBY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiwgdGV4dC9wbGFpbiwgKi8qIiwgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9dXRmLTgiLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiVXNlci1BZ2VudCI6ICJUYXolQzQlQjEvMyBDRk5ldHdvcmsvMTMzNS4wLjMgRGFyd2luLzIxLjYuMCIsICJBY2NlcHQtTGFuZ3VhZ2UiOiAidHItVFIsdHI7cT0wLjkiLCAiQXV0aG9yaXphdGlvbiI6ICJCYXNpYyBkR0Y2YVY5MWMzSmZjM05zT2pNNU5UQTNSakk0UXprMk1qUkRRMEk0UWpWQlFUZzJSVVF4T1VFNE1ERkQifQogICAgICAgICAgICBqc29uPXsiY2VwX3RlbCI6IHNlbGYucGhvbmUsICJjZXBfdGVsX3Vsa2Vrb2QiOiAiOTAifQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1qc29uKQogICAgICAgICAgICBpZiAoci5qc29uKClbImtvZCJdKSA9PSAiMDAwMCI6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gbW9iaWxlYXBpdjIudGF6aS50ZWNoIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gbW9iaWxlYXBpdjIudGF6aS50ZWNoIikKICAgIGRlZiBLaW1HYihzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KCJodHRwczovLzN1cHR6bGFrd2kuZXhlY3V0ZS1hcGkuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb206NDQzL2FwaS9hdXRoL3NlbmQtb3RwIiwganNvbj17Im1zaXNkbiI6IGYiOTB7c2VsZi5waG9uZX0ifSkKICAgICAgICAgICAgaWYgci5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gM3VwdHpsYWt3aS5leGVjdXRlLWFwaS5ldS13ZXN0LTEuYW1hem9uYXdzLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IDN1cHR6bGFrd2kuZXhlY3V0ZS1hcGkuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb20iKQogICAKICAgIGRlZiBTdWlzdGUoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9zdWlzdGUuY29tOjQ0My9hcGkvYXV0aC9jb2RlIgogICAgICAgICAgICBoZWFkZXJzID0geyJBY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiIsICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PXV0Zi04IiwgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwgIk1vYmlsbGl1bS1EZXZpY2UtSWQiOiAiNTZEQjlBQzQtRjUyQi00REYxLUIxNEMtRTM5NjkwQkM2OUZDIiwgIlVzZXItQWdlbnQiOiAic3Vpc3RlLzEuNi4xNiAoY29tLm1vYmlsbGl1bS5zdWlzdGU7IGJ1aWxkOjE0MzQ7IGlPUyAxNS43LjcpIEFsYW1vZmlyZS81LjYuNCIsICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4ifQogICAgICAgICAgICBkYXRhID0geyJhY3Rpb24iOiAicmVnaXN0ZXIiLCAiZ3NtIjogc2VsZi5waG9uZX0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGRhdGE9ZGF0YSkKIyNsYWzFn3Nka8SxYcWfbHNma2Fpc2ZsYXMjI2xhbMWfc2RrxLFhxZ9sc2ZrYWlzZmxhcyMjbGFsxZ9zZGvEsWHFn2xzZmthaXNmbGFzIyNsYWzFn3Nka8SxYcWfbHNma2Fpc2ZsYXMjI2xhbMWfc2RrxLFhxZ9sc2ZrYWlzZmxhcyMjbGFsxZ9zZGvEsWHFn2xzZmthaXNmbGFzIyNsYWzFn3Nka8SxYcWfbHNma2Fpc2ZsYXMjI2xhbMWfc2RrI8SxYcWfbHNma2Fpc2ZsYXMjI2xhbMWfc2RrxLFhxZ9sc2ZrYWlzZmxhcyMjbGFsxZ9zZGvEsWHFn2xzZmthaXNmbGFzIyNsYWzFn3Nka8SxYcWfbHNma2Fpc2ZsYXMjI2xhbMWfc2RrxLFhxZ9sc2ZrYWlzZmxhcyMjbGFsxZ9zZGvEsWHFn2xzZmthaXNmbGFzIyNsYWzFn3Nka8SxYcWfbHNma2Fpc2ZsYXMjI2xhbMWfc2RrxLFhxZ9sc2ZrYWkjc2ZsYXMjI2xhbMWfc2RrxLFhxZ9sc2ZrYWlzZmxhcyMjbGFsxZ9zZGvEsWHFn2xzZmthaXNmbGFzIyNsYWzFn3Nka8SxYcWfbHNma2Fpc2ZsYXMjI2xhbMWfc2RrxLFhxZ9sc2ZrYWlzZmxhcyMjbGFsxZ9zZGvEsWHFn2xzZmthaXNmbGFzIyNsYWzFn3Nka8SxYcWfbHNma2Fpc2ZsYXMjI2xhbMWfc2RrxLFhxZ9sc2ZrYWlzZmxhcyMjbCNhbMWfc2RrxLFhxZ9sc2ZrYWlzZmxhcyMjbGFsxZ9zZGvEsWHFn2xzZmthaXNmbGFzIyNsYWzFn3Nka8SxYcWfbHNma2Fpc2ZsYXMjI2xhbMWfc2RrxLFhxZ9sc2ZrYWlzZmxhcyMjbGFsxZ9zZGvEsWHFn2xzZmthaXNmbGFzIyNsYWzFn3Nka8SxYcWfbHNma2Fpc2ZsYXMjI2xhbMWfc2RrxLFhxZ9sc2ZrYWlzZmxhcyMjbGFsxZ9zZGvEsSNhxZ9sc2ZrYWlzZmxhcyMjbGFsxZ9zZGvEsWHFn2xzZmthaXNmbGFzIyNsYWzFn3Nka8SxYcWfbHNma2Fpc2ZsYXMjI2xhbMWfc2RrxLFhxZ9sc2ZrYWlzZmxhcyMjbGFsxZ9zZGvEsWHFn2xzZmthaXNmbGFzYXNnZmFzZMWfbGFpc2xhYXNsZ2tqYcWfbGthbMWfc2drYcWfbHNrYXPFn2xka2Fzw6dsZ2thcwojI2xhbMWfc2RrxLFhxZ9sc2ZrYWlzZmxhcyMjbGFsxZ9zZGvEsWHFn2xzZmthaXNmbGFzIyNsYWzFn3Nka8SxYcWfbHNma2Fpc2ZsYXNhc2pmbGthc2pmIyNsYWzFn3Nka8SxYcWfbHNma2Fpc2ZsYXNhamtzZMWfZ2EjI2xhbMWfc2RrxLFhxZ9sc2ZrYWlzZmxhc8WfCgogICAgICAgICAgICBpZiByLmpzb24oKVsiY29kZSJdID09ICJjb21tb24uc3VjY2VzcyI6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gc3Vpc3RlLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IHN1aXN0ZS5jb20iKQoKICAgICNiaW0KICAgIGRlZiBCaW0oc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBiaW0gPSByZXF1ZXN0cy5wb3N0KCJodHRwczovL2JpbS52ZWVzay5uZXQ6NDQzL3NlcnZpY2UvdjEuMC9hY2NvdW50L2xvZ2luIiwgIGpzb249eyJwaG9uZSI6IHNlbGYucGhvbmV9KQogICAgICAgICAgICBpZiBiaW0uc3RhdHVzX2NvZGUgPT0gMjAwOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGJpbS52ZWVzay5uZXQiKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBiaW0udmVlc2submV0IikKCgoKCgogICAgI2ljcS5uZXQKICAgIGRlZiBJY3Eoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSBmImh0dHBzOi8vdS5pY3EubmV0OjQ0My9hcGkvdjkwL3Ntc3JlZy9yZXF1ZXN0UGhvbmVWYWxpZGF0aW9uLnBocD9jbGllbnQ9aWNxJmY9anNvbiZrPWd1MTlQTkJibFFqQ2RiTVUmbG9jYWxlPWVuJm1zaXNkbj0lMkI5MHtzZWxmLnBob25lfSZwbGF0Zm9ybT1pb3Mmcj03OTYzNTYxNTMmc21zRm9ybWF0VHlwZT1odW1hbiIKICAgICAgICAgICAgaGVhZGVycyA9IHsiQWNjZXB0IjogIiovKiIsICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIiwgIlVzZXItQWdlbnQiOiAiSUNRIGlPUyAjbm9fdXNlcl9pZCMgZ3UxOVBOQmJsUWpDZGJNVSAyMy4xLjEoMTI0MTA2KSAxNS43LjcgaVBob25lOSw0IiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzKQogICAgICAgICAgICBpZiByLmpzb24oKVsicmVzcG9uc2UiXVsic3RhdHVzQ29kZSJdID09IDIwMDoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiB1LmljcS5uZXQiKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiB1LmljcS5uZXQiKQogICAgICAgICAgCgogICAgCiAgICAKICAgCiAgICAjZXZpZGVhLmNvCiAgICAgICAgICAgIAogICAgICAgIAogICAgI21hcnRpLnRlY2gKICAgIGRlZiBNYXJ0aShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL2N1c3RvbWVyLm1hcnRpc2Nvb3Rlci5jb206NDQzL3YxMy9zY29vdGVyL2Rpc3BhdGNoL2N1c3RvbWVyL3NpZ25pbiIKICAgICAgICAgICAganNvbj17Im1vYmlsZVBob25lIjogc2VsZi5waG9uZSwgIm1vYmlsZVBob25lQ291bnRyeUNvZGUiOiAiOTAiLCAib25lU2lnbmFsSWQiOiAiIn0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCAganNvbj1qc29uKQogICAgICAgICAgICBpZiByLmpzb24oKVsiaXNTdWNjZXNzIl0gPT0gVHJ1ZToKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH0gIFsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGN1c3RvbWVyLm1hcnRpc2Nvb3Rlci5jb20iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfSAgWy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGN1c3RvbWVyLm1hcnRpc2Nvb3Rlci5jb20iKQoKCiAgICAgICAgCiAgIAogICAKICAgICN0aWtsYWdlbHNpbi5jb20KICAgIGRlZiBUaWtsYUdlbHNpbihzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL3N2Yy5hcHBzLnRpa2xhZ2Vsc2luLmNvbTo0NDMvdXNlci9ncmFwaHFsIgogICAgICAgICAgICBoZWFkZXJzID0geyJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsICJYLU1lcmNoYW50LVR5cGUiOiAiMCIsICJBY2NlcHQiOiAiKi8qIiwgIkFwcHZlcnNpb24iOiAiMi40LjEiLCAiQWNjZXB0LUxhbmd1YWdlIjogImVuLVVTLGVuO3E9MC45IiwgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwgIlgtTm8tQXV0aCI6ICJ0cnVlIiwgIlVzZXItQWdlbnQiOiAiVGlrbGFHZWxzaW4vODA5IENGTmV0d29yay8xMzM1LjAuMy4yIERhcndpbi8yMS42LjAiLCAiWC1EZXZpY2UtVHlwZSI6ICIyIn0KICAgICAgICAgICAganNvbj17Im9wZXJhdGlvbk5hbWUiOiAiR0VORVJBVEVfT1RQIiwgInF1ZXJ5IjogIm11dGF0aW9uIEdFTkVSQVRFX09UUCgkcGhvbmU6IFN0cmluZywgJGNoYWxsZW5nZTogU3RyaW5nLCAkZGV2aWNlVW5pcXVlSWQ6IFN0cmluZykge1xuICBnZW5lcmF0ZU90cChwaG9uZTogJHBob25lLCBjaGFsbGVuZ2U6ICRjaGFsbGVuZ2UsIGRldmljZVVuaXF1ZUlkOiAkZGV2aWNlVW5pcXVlSWQpXG59XG4iLCAidmFyaWFibGVzIjogeyJjaGFsbGVuZ2UiOiAiM2Q2ZjlmZjktODZjZS00YmYzLThiYTktNGE4NWNhOTc1ZTY4IiwgImRldmljZVVuaXF1ZUlkIjogIjcyMDkzMkQ1LTQ3QkQtNDZDRC1BNEI4LTA4NkVDNDlGODFBQiIsICJwaG9uZSI6IGYiKzkwe3NlbGYucGhvbmV9In19CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJkYXRhIl1bImdlbmVyYXRlT3RwIl0gPT0gVHJ1ZToKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH0gIFsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IHN2Yy5hcHBzLnRpa2xhZ2Vsc2luLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9ICBbLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gc3ZjLmFwcHMudGlrbGFnZWxzaW4uY29tIikKICAgIAoKICAgIAogICAKICAgCiAgICAjdGFzaW1hY2ltLmNvbQogICAgCiAgICAKICAgICN5dWZmaS5jbwogICAgZGVmIFl1ZmZpKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vYXBpLnl1ZmZpLmNvL2FwaS9wYXJlbnQvbG9naW4vdXNlciIKICAgICAgICAgICAganNvbiA9IHsicGhvbmUiOiBzZWxmLnBob25lLCAia3ZrayI6IFRydWV9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwganNvbj1qc29uKQogICAgICAgICAgICBpZiByLmpzb24oKVsic3VjY2VzcyJdID09IFRydWU6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9ICBbK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBhcGkueXVmZmkuY28iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfSAgWy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGFwaS55dWZmaS5jbyIpCiAgICAjZ2V0aXIKICAgIGRlZiBnZXRpcihzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL2dldGlyLmNvbS8iCiAgICAgICAgICAgIGpzb24gPSB7ImNvdW50cnlDb2RlIjogIjkwIiwgImdzbSI6IHNlbGYucGhvbmV9CiAgICAgICAgICAgIHdtZiA9IHJlcXVlc3RzLnBvc3QodXJsLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHdtZi5zdGF0dXNfY29kZSA9PSAyMDI6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9ICBbK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBnZXRpci5jb20iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZTogCiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgCiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9ICBbLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gZ2V0aXIuY29tIikKICAgIGRlZiBLaW1HYihzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KCJodHRwczovLzN1cHR6bGFrd2kuZXhlY3V0ZS1hcGkuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb206NDQzL2FwaS9hdXRoL3NlbmQtb3RwIiwganNvbj17Im1zaXNkbiI6IGYiOTB7c2VsZi5waG9uZX0ifSkKICAgICAgICAgICAgaWYgci5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gM3VwdHpsYWt3aS5leGVjdXRlLWFwaS5ldS13ZXN0LTEuYW1hem9uYXdzLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IDN1cHR6bGFrd2kuZXhlY3V0ZS1hcGkuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb20iKQogICAgICAgICAgICAKCiAgICAjdGF6aS50ZWNoCiAgICBkZWYgVGF6aShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL21vYmlsZWFwaXYyLnRhemkudGVjaDo0NDMvQzA4NDY3NjgxQzY4NDRDRkE2REEyNDBENTFDOEFBOEMvdXlldjIvc21zbG9naW4iCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyoiLCAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb247Y2hhcnNldD11dGYtOCIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsICJVc2VyLUFnZW50IjogIlRheiVDNCVCMS8zIENGTmV0d29yay8xMzM1LjAuMyBEYXJ3aW4vMjEuNi4wIiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJ0ci1UUix0cjtxPTAuOSIsICJBdXRob3JpemF0aW9uIjogIkJhc2ljIGRHRjZhVjkxYzNKZmMzTnNPak01TlRBM1JqSTRRemsyTWpSRFEwSTRRalZCUVRnMlJVUXhPVUU0TURGRCJ9CiAgICAgICAgICAgIGpzb249eyJjZXBfdGVsIjogc2VsZi5waG9uZSwgImNlcF90ZWxfdWxrZWtvZCI6ICI5MCJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIChyLmpzb24oKVsia29kIl0pID09ICIwMDAwIjoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBtb2JpbGVhcGl2Mi50YXppLnRlY2giKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBtb2JpbGVhcGl2Mi50YXppLnRlY2giKQogICAgICAgICAgICAKICAgIAogICAgI24xMS5jb20KICAgIGRlZiBOMTEoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9tb2JpbGVhcGkubjExLmNvbTo0NDMvbW9iaWxlYXBpL3Jlc3QvdjIvbXNpc2RuLXZlcmlmaWNhdGlvbi9pbml0LXZlcmlmaWNhdGlvbj9fX2hhcGM9RjQxQTBDMDEtRDEwMi00REJFLTk3QjItMDdCQ0UyMzE3Q0QzIgogICAgICAgICAgICBoZWFkZXJzID0geyJNb2JpbGVjbGllbnQiOiAiSU9TIiwgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwgIkFjY2VwdCI6ICIqLyoiLCAiQXV0aG9yaXphdGlvbiI6ICJhcGlfa2V5PWlwaG9uZSxhcGlfaGFzaD05ZjU1ZDQ0ZTJhYTI4MzIyY2Y4NGI1ODE2YmIyMDQ2MSxhcGlfcmFuZG9tPTY4NkExNDkxLTA0MUYtNDEzOC04NjVGLTlFNzZCQzYwMzY3RiIsICJDbGllbnR2ZXJzaW9uIjogIjE2MyIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsICJVc2VyLUFnZW50IjogIm4xMS8xIENGTmV0d29yay8xMzM1LjAuMyBEYXJ3aW4vMjEuNi4wIiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJ0ci1UUix0cjtxPTAuOSIsICJDb25uZWN0aW9uIjogImNsb3NlIn0KICAgICAgICAgICAganNvbj17Il9faGFwYyI6ICIiLCAiX2RldmljZUlkIjogIjY5NkIxNzEtMDMxTi00MTMxLTMxNUYtOUE3NkJGNjAzNjhGIiwgImNoYW5uZWwiOiAiTU9CSUxFX0lPUyIsICJjb3VudHJ5Q29kZSI6ICIrOTAiLCAiZW1haWwiOiBzZWxmLm1haWwsICJnc21OdW1iZXIiOiBzZWxmLnBob25lLCAidXNlclR5cGUiOiAiQlVZRVIifQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1qc29uKQogICAgICAgICAgICBpZiAoci5qc29uKClbImlzU3VjY2VzcyJdKSA9PSBUcnVlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IG1vYmlsZWFwaS5uMTEuY29tIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gbW9iaWxlYXBpLm4xMS5jb20iKQogICAgICAgICAgICAKICAgIAogICAgI2V2aWRlYS5jb20KICAgIGRlZiBFdmlkZWEoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly93d3cuZXZpZGVhLmNvbTo0NDMvdXNlcnMvcmVnaXN0ZXIvIgogICAgICAgICAgICBoZWFkZXJzID0geyJDb250ZW50LVR5cGUiOiAibXVsdGlwYXJ0L2Zvcm0tZGF0YTsgYm91bmRhcnk9ZkRsd1N6a1pVOURXNU1jdEl4T2k0RUlzWUI5TEtNUjF6eWI1ZE91aUpwanBRb0sxVlBqU3lxZHhIZnFQZG0zaUhhS2N6aSIsICJYLVByb2plY3QtTmFtZSI6ICJ1bmRlZmluZWQiLCAiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKiIsICJYLUFwcC1UeXBlIjogImFraW5vbi1tb2JpbGUiLCAiWC1SZXF1ZXN0ZWQtV2l0aCI6ICJYTUxIdHRwUmVxdWVzdCIsICJBY2NlcHQtTGFuZ3VhZ2UiOiAidHItVFIsdHI7cT0wLjkiLCAiQ2FjaGUtQ29udHJvbCI6ICJuby1zdG9yZSIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsICJYLUFwcC1EZXZpY2UiOiAiaW9zIiwgIlJlZmVyZXIiOiAiaHR0cHM6Ly93d3cuZXZpZGVhLmNvbS8iLCAiVXNlci1BZ2VudCI6ICJFdmlkZWEvMSBDRk5ldHdvcmsvMTMzNS4wLjMgRGFyd2luLzIxLjYuMCIsICJYLUNzcmZ0b2tlbiI6ICI3TmRKYldTWW5PZG03MFlWTEl5em15bFp3V2JxTEZidHNyY0NRZExBRWJueDdhNVRxNG5qalMzZ0VFbFp4WXBzIn0KICAgICAgICAgICAgZGF0YSA9IGYiLS1mRGx3U3prWlU5RFc1TWN0SXhPaTRFSXNZQjlMS01SMXp5YjVkT3VpSnBqcFFvSzFWUGpTeXFkeEhmcVBkbTNpSGFLY3ppXHJcbmNvbnRlbnQtZGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT1cImZpcnN0X25hbWVcIlxyXG5cclxuTWVtYXRpXHJcbi0tZkRsd1N6a1pVOURXNU1jdEl4T2k0RUlzWUI5TEtNUjF6eWI1ZE91aUpwanBRb0sxVlBqU3lxZHhIZnFQZG0zaUhhS2N6aVxyXG5jb250ZW50LWRpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCJsYXN0X25hbWVcIlxyXG5cclxuQmFzXHJcbi0tZkRsd1N6a1pVOURXNU1jdEl4T2k0RUlzWUI5TEtNUjF6eWI1ZE91aUpwanBRb0sxVlBqU3lxZHhIZnFQZG0zaUhhS2N6aVxyXG5jb250ZW50LWRpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCJlbWFpbFwiXHJcblxyXG57c2VsZi5tYWlsfVxyXG4tLWZEbHdTemtaVTlEVzVNY3RJeE9pNEVJc1lCOUxLTVIxenliNWRPdWlKcGpwUW9LMVZQalN5cWR4SGZxUGRtM2lIYUtjemlcclxuY29udGVudC1kaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPVwiZW1haWxfYWxsb3dlZFwiXHJcblxyXG5mYWxzZVxyXG4tLWZEbHdTemtaVTlEVzVNY3RJeE9pNEVJc1lCOUxLTVIxenliNWRPdWlKcGpwUW9LMVZQalN5cWR4SGZxUGRtM2lIYUtjemlcclxuY29udGVudC1kaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPVwic21zX2FsbG93ZWRcIlxyXG5cclxudHJ1ZVxyXG4tLWZEbHdTemtaVTlEVzVNY3RJeE9pNEVJc1lCOUxLTVIxenliNWRPdWlKcGpwUW9LMVZQalN5cWR4SGZxUGRtM2lIYUtjemlcclxuY29udGVudC1kaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPVwicGFzc3dvcmRcIlxyXG5cclxuMzFBQkMuLmFiYzMxXHJcbi0tZkRsd1N6a1pVOURXNU1jdEl4T2k0RUlzWUI5TEtNUjF6eWI1ZE91aUpwanBRb0sxVlBqU3lxZHhIZnFQZG0zaUhhS2N6aVxyXG5jb250ZW50LWRpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCJwaG9uZVwiXHJcblxyXG4we3NlbGYucGhvbmV9XHJcbi0tZkRsd1N6a1pVOURXNU1jdEl4T2k0RUlzWUI5TEtNUjF6eWI1ZE91aUpwanBRb0sxVlBqU3lxZHhIZnFQZG0zaUhhS2N6aVxyXG5jb250ZW50LWRpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCJjb25maXJtXCJcclxuXHJcbnRydWVcclxuLS1mRGx3U3prWlU5RFc1TWN0SXhPaTRFSXNZQjlMS01SMXp5YjVkT3VpSnBqcFFvSzFWUGpTeXFkeEhmcVBkbTNpSGFLY3ppLS1cclxuIgogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywgZGF0YT1kYXRhKSAgICAgIAogICAgICAgICAgICBpZiByLnN0YXR1c19jb2RlID09IDIwMjoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBldmlkZWEuY29tIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gZXZpZGVhLmNvbSIpIAogICAgICAgICAgICAKICAgICAgICAKICAgICNtYXJ0aS50ZWNoCiAgICBkZWYgTWFydGkoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9jdXN0b21lci5tYXJ0aXNjb290ZXIuY29tOjQ0My92MTMvc2Nvb3Rlci9kaXNwYXRjaC9jdXN0b21lci9zaWduaW4iCiAgICAgICAgICAgIGpzb249eyJtb2JpbGVQaG9uZSI6IHNlbGYucGhvbmUsICJtb2JpbGVQaG9uZUNvdW50cnlDb2RlIjogIjkwIiwgIm9uZVNpZ25hbElkIjogIiJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5qc29uKClbImlzU3VjY2VzcyJdID09IFRydWU6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gY3VzdG9tZXIubWFydGlzY29vdGVyLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGN1c3RvbWVyLm1hcnRpc2Nvb3Rlci5jb20iKQoKCiAgICAjaGV5c2Nvb3Rlci5jb20udHIKICAgIGRlZiBIZXkoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSBmImh0dHBzOi8vaGV5YXBpLmhleW1vYmlsaXR5LnRlY2g6NDQzL1YxNC8vYXBpL1VzZXIvQWN0aXZhdGlvbkNvZGVSZXF1ZXN0P29yZ2FuaXphdGlvbklkPTlEQ0EzMTJFLTE4QzgtNERBRS1BRTY1LTAxRkVBRDU1ODczOSZwaG9uZW51bWJlcj17c2VsZi5waG9uZX0mcmVxdWVzdGlkPTE4YmNhNGU0LTJmNDUtNDFiMC1iMDU0LTNlZmQ1YjJjOWM1Ny0yMDIzMDczMCZ0ZXJyaXRvcnlJZD03MzgyMTFkNC1mZDlkLTQxNjgtODFhNi1iN2RiZjkxMTcwZTkiCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyoiLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiVXNlci1BZ2VudCI6ICJIRVkhJTIwU2Nvb3Rlci8xNDMgQ0ZOZXR3b3JrLzEzMzUuMC4zLjIgRGFyd2luLzIxLjYuMCIsICJBY2NlcHQtTGFuZ3VhZ2UiOiAidHIifQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycykKICAgICAgICAgICAgaWYgci5qc29uKClbIklzU3VjY2VzcyJdID09IFRydWU6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gaGV5YXBpLmhleW1vYmlsaXR5LnRlY2giKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBoZXlhcGkuaGV5bW9iaWxpdHkudGVjaCIpCgoKICAgICNiaW5lcS50ZWNoCiAgICBkZWYgQmluZXEoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSBmImh0dHBzOi8vYmluZXFhcGkuaGV5bW9iaWxpdHkudGVjaDo0NDMvVjMvL2FwaS9Vc2VyL0FjdGl2YXRpb25Db2RlUmVxdWVzdD9vcmdhbml6YXRpb25JZD05RENBMzEyRS0xOEM4LTREQUUtQUU2NS0wMUZFQUQ1NTg3MzkmcGhvbmVudW1iZXI9e3NlbGYucGhvbmV9IgogICAgICAgICAgICBoZWFkZXI9IHsiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKiIsICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsICJVc2VyLUFnZW50IjogIkhFWSElMjBTY29vdGVyLzEyOCBDRk5ldHdvcmsvMTMzNS4wLjMuMiBEYXJ3aW4vMjEuNi4wIiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJ0ciJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXIpCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJJc1N1Y2Nlc3MiXSA9PSBUcnVlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGJpbmVxYXBpLmhleW1vYmlsaXR5LnRlY2giKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBiaW5lcWFwaS5oZXltb2JpbGl0eS50ZWNoIikKCiAgICAgICAgCiAgICAjYmlzdS5jb20udHIKICAgIGRlZiBCaXN1KHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vd3d3LmJpc3UuY29tLnRyOjQ0My9hcGkvdjIvYXBwL2F1dGhlbnRpY2F0aW9uL3Bob25lL3JlZ2lzdGVyIgogICAgICAgICAgICBoZWFkZXJzID0geyJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PXV0Zi04IiwgIlgtRGV2aWNlLVBsYXRmb3JtIjogIklPUyIsICJYLUJ1aWxkLVZlcnNpb24tTmFtZSI6ICI5LjQuMCIsICJBdXRob3JpemF0aW9uIjogIjA1NjFiNGRkLWU2NjgtNDhhYy1iNjVlLTVhZmE5OWJmMDk4ZSIsICJYLUJ1aWxkLVZlcnNpb24tQ29kZSI6ICIyMiIsICJBY2NlcHQiOiAiKi8qIiwgIlgtRGV2aWNlLU1hbnVmYWN0dXJlciI6ICJBcHBsZSIsICJYLURldmljZS1Mb2NhbGUiOiAiZW4iLCAiWC1DbGllbnQtRGV2aWNlLUlkIjogIjY2NTg1NjUzLUNCNkEtNDhDQS1BNDJELTNGMjY2Njc3RTNCNSIsICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkiLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiWC1EZXZpY2UtUGxhdGZvcm0tVmVyc2lvbiI6ICIxNS43LjciLCAiVXNlci1BZ2VudCI6ICJCaVNVLzIyIENGTmV0d29yay8xMzM1LjAuMy4yIERhcndpbi8yMS42LjAiLCAiWC1EZXZpY2UtTW9kZWwiOiAiaVBob25lIDcgUGx1cyIsICJYLUJ1aWxkLVR5cGUiOiAiUmVsZWFzZSJ9CiAgICAgICAgICAgIGRhdGEgPSB7InBob25lTnVtYmVyIjogc2VsZi5waG9uZX0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGRhdGE9ZGF0YSkKICAgICAgICAgICAgaWYgci5qc29uKClbImVycm9ycyJdID09IE5vbmU6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gYmlzdS5jb20udHIiKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBiaXN1LmNvbS50ciIpCgoKICAgICMzNDVkaWppdGFsLmNvbQogICAgZGVmIFVjZG9ydGJlcyhzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL2FwaS4zNDVkaWppdGFsLmNvbTo0NDMvYXBpL3VzZXJzL3JlZ2lzdGVyIgogICAgICAgICAgICBoZWFkZXJzID0geyJBY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiwgdGV4dC9wbGFpbiwgKi8qIiwgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwgIlVzZXItQWdlbnQiOiAiQXJpUGx1c01vYmlsZS8yMSBDRk5ldHdvcmsvMTMzNS4wLjMuMiBEYXJ3aW4vMjEuNi4wIiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsICJBdXRob3JpemF0aW9uIjogIm51bGwiLCAiQ29ubmVjdGlvbiI6ICJjbG9zZSJ9CiAgICAgICAgICAgIGpzb249eyJlbWFpbCI6ICIiLCAibmFtZSI6ICJNZW1hdGkiLCAicGhvbmVOdW1iZXIiOiBmIis5MHtzZWxmLnBob25lfSIsICJzdXJuYW1lIjogIkJhcyJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJlcnJvciJdID09ICJFLVBvc3RhIHZleWEgdGVsZWZvbiB6YXRlbiBrYXnEsXRsxLEhIjoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGFwaS4zNDVkaWppdGFsLmNvbSIpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGFwaS4zNDVkaWppdGFsLmNvbSIpCiAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCgoKICAgICNtYWNyb2NlbnRlci5jb20udHIKICAgIGRlZiBNYWNybyhzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL3Jlc3QubWFjcm9jZW50ZXIuY29tLnRyOjQ0My91c2Vycy9sb2dpbi9vdHAiCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwgIlgtRGV2aWNlLVBsYXRmb3JtIjogIklPUyIsICJYLVJlcXVlc3QtSWRlbnRpZmllciI6ICIyQzFCNkJCQi0zRTFFLTRFN0UtOUNBRS05OTBDNkVBQUQyNzkiLCAiQWNjZXB0IjogIiovKiIsICJYLURldmljZS1Nb2RlbCI6ICJpUGhvbmUgNyBQbHVzIiwgIlgtU3RvcmUtSWRzIjogIiIsICJYLURldmljZS1WZXJzaW9uIjogIjIuMy43IiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsICJYLURldmljZS1QbGF0Zm9ybS1WZXJzaW9uIjogIjE1LjcuNyIsICJVc2VyLUFnZW50IjogIk1hY3JvY2VudGVyLzE1IENGTmV0d29yay8xMzM1LjAuMy4yIERhcndpbi8yMS42LjAiLCAiWC1EZXZpY2UtSWRlbnRpZmllciI6ICJDN0NGOTUyNS05QkVCLTQ3QjAtODdFRi1GQUZBOUY3NzhDM0UiLCAiWC1EZXZpY2UtTGF0aXR1ZGUiOiAiIiwgIlgtRGV2aWNlLUxvbmdpdHVkZSI6ICIiLCAiWC1EZXZpY2UtVHlwZSI6ICJNT0JJTEUifQogICAgICAgICAgICBqc29uPXsicGhvbmVOdW1iZXIiOiBzZWxmLnBob25lfQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1qc29uKQogICAgICAgICAgICBpZiByLmpzb24oKVsic3VjY2Vzc2Z1bCJdID09IFRydWU6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gcmVzdC5tYWNyb2NlbnRlci5jb20udHIiKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiByZXN0Lm1hY3JvY2VudGVyLmNvbS50ciIpCgoKICAgICN0aWtsYWdlbHNpbi5jb20KICAgIGRlZiBUaWtsYUdlbHNpbihzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL3N2Yy5hcHBzLnRpa2xhZ2Vsc2luLmNvbTo0NDMvdXNlci9ncmFwaHFsIgogICAgICAgICAgICBoZWFkZXJzID0geyJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsICJYLU1lcmNoYW50LVR5cGUiOiAiMCIsICJBY2NlcHQiOiAiKi8qIiwgIkFwcHZlcnNpb24iOiAiMi40LjEiLCAiQWNjZXB0LUxhbmd1YWdlIjogImVuLVVTLGVuO3E9MC45IiwgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwgIlgtTm8tQXV0aCI6ICJ0cnVlIiwgIlVzZXItQWdlbnQiOiAiVGlrbGFHZWxzaW4vODA5IENGTmV0d29yay8xMzM1LjAuMy4yIERhcndpbi8yMS42LjAiLCAiWC1EZXZpY2UtVHlwZSI6ICIyIn0KICAgICAgICAgICAganNvbj17Im9wZXJhdGlvbk5hbWUiOiAiR0VORVJBVEVfT1RQIiwgInF1ZXJ5IjogIm11dGF0aW9uIEdFTkVSQVRFX09UUCgkcGhvbmU6IFN0cmluZywgJGNoYWxsZW5nZTogU3RyaW5nLCAkZGV2aWNlVW5pcXVlSWQ6IFN0cmluZykge1xuICBnZW5lcmF0ZU90cChwaG9uZTogJHBob25lLCBjaGFsbGVuZ2U6ICRjaGFsbGVuZ2UsIGRldmljZVVuaXF1ZUlkOiAkZGV2aWNlVW5pcXVlSWQpXG59XG4iLCAidmFyaWFibGVzIjogeyJjaGFsbGVuZ2UiOiAiM2Q2ZjlmZjktODZjZS00YmYzLThiYTktNGE4NWNhOTc1ZTY4IiwgImRldmljZVVuaXF1ZUlkIjogIjcyMDkzMkQ1LTQ3QkQtNDZDRC1BNEI4LTA4NkVDNDlGODFBQiIsICJwaG9uZSI6IGYiKzkwe3NlbGYucGhvbmV9In19CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJkYXRhIl1bImdlbmVyYXRlT3RwIl0gPT0gVHJ1ZToKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBzdmMuYXBwcy50aWtsYWdlbHNpbi5jb20iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBzdmMuYXBwcy50aWtsYWdlbHNpbi5jb20iKQogICAgCgogICAgI2F5eWlsZGl6LmNvbS50cgogICAgZGVmIEF5eWlsZGl6KHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gZiJodHRwczovL2FwaS5hbHRpbnlpbGRpemNsYXNzaWNzLmNvbTo0NDMvbW9iaWxlYXBpMi9hdXRhcGkvQ3JlYXRlU21zT3RwRm9yUmVnaXN0ZXI/Z3NtPXtzZWxmLnBob25lfSIKICAgICAgICAgICAgaGVhZGVycyA9IHsiQWNjZXB0IjogIiovKiIsICJUb2tlbiI6ICJNWFo1TlRKODJXWEJVSkI3S0JQMTBBR1IzQUY2UzRHQjk1VlpEVTRHNDRKRkVJTjNXSVNBQzJLTFJJQk5PTlE3UVZDWlhNM1pISTY2MUFNVlhMS0pMRjlIVUtJNVNRMlJPTVpTIiwgIkRldmljZXR5cGUiOiAibW9iaWxlYXBwIiwgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwgIlVzZXItQWdlbnQiOiAiYWx0aW55aWxkaXovMi43IChjb20uYnJtYWdhemFjaWxpay5hbHRpbnlpbGRpejsgYnVpbGQ6MjsgaU9TIDE1LjcuNykgQWxhbW9maXJlLzIuNyIsICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4tVFI7cT0xLjAsIHRyLVRSO3E9MC45In0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMpCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJTdWNjZXNzIl0gPT0gVHJ1ZToKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBhcGkuYWx0aW55aWxkaXpjbGFzc2ljcy5jb20iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBhcGkuYWx0aW55aWxkaXpjbGFzc2ljcy5jb20iKQoKCiAgICAjbmFvc3N0YXJzLmNvbQogICAgZGVmIE5hb3NzdGFycyhzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL2FwaS5uYW9zc3RhcnMuY29tOjQ0My9hcGkvc21zU2VuZC85YzlmYTg2MS1jYzVkLTQzYjAtYjRlYS0xYjU0MWJlMTUzNTAiCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IlVuaXFpZCI6ICI5YzlmYTg2MS1jYzVkLTQzYzAtYjRlYS0xYjU0MWJlMTUzNTEiLCAiVXNlci1BZ2VudCI6ICJuYW9zc3RhcnMvMS4wMDMwIENGTmV0d29yay8xMzM1LjAuMy4yIERhcndpbi8yMS42LjAiLCAiQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luIjogIioiLCAiTG9jYWxlIjogImVuLVRSIiwgIlZlcnNpb24iOiAiMS4wMDMwIiwgIk9zIjogImlvcyIsICJBcGl1cmwiOiAiaHR0cHM6Ly9hcGkubmFvc3N0YXJzLmNvbS9hcGkvIiwgIkRldmljZS1JZCI6ICJENDFDRTVGMy01M0JCLTQyQ0YtODYxMS1CNEZFNzUyOUM5QkMiLCAiUGxhdGZvcm0iOiAiaW9zIiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsICJUaW1lem9uZSI6ICJFdXJvcGUvSXN0YW5idWwiLCAiR2xvYmFsdXVpZHY0IjogImQ1N2JkNWQyLWNmMWUtNDIwYy1iNDNkLTYxMTE3Y2Y5YjUxNyIsICJUaW1lem9uZW9mZnNldCI6ICItMTgwIiwgIkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uIiwgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04IiwgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwgIkFwaXR5cGUiOiAibW9iaWxlX2FwcCJ9CiAgICAgICAgICAgIGpzb249eyJ0ZWxlcGhvbmUiOiBmIis5MHtzZWxmLnBob25lfSIsICJ0eXBlIjogInJlZ2lzdGVyIn0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gYXBpLm5hb3NzdGFycy5jb20iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBhcGkubmFvc3N0YXJzLmNvbSIpCgoKICAgICNpc3RlZ2Vsc2luLmNvbQogICAgZGVmIElzdGVnZWxzaW4oc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9wcm9kLmZhc2FwaS5uZXQ6NDQzLyIKICAgICAgICAgICAgaGVhZGVycyA9IHsiQWNjZXB0IjogIiovKiIsICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIiwgIkFwcC1WZXJzaW9uIjogIjI1MjgiLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiUGxhdGZvcm0iOiAiSU9TIiwgIlVzZXItQWdlbnQiOiAiaWctc29ua3VsbGFuaWNpLWlvcy8xNjEgQ0ZOZXR3b3JrLzEzMzUuMC4zLjIgRGFyd2luLzIxLjYuMCIsICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkifQogICAgICAgICAgICBqc29uPXsib3BlcmF0aW9uTmFtZSI6ICJTZW5kT3RwMiIsICJxdWVyeSI6ICJtdXRhdGlvbiBTZW5kT3RwMigkcGhvbmVOdW1iZXI6IFN0cmluZyEpIHtcbiAgc2VuZE90cDIocGhvbmVOdW1iZXI6ICRwaG9uZU51bWJlcikge1xuICAgIF9fdHlwZW5hbWVcbiAgICBhbHJlYWR5U2VudFxuICAgIHJlbWFpbmluZ1RpbWVcbiAgfVxufSIsICJ2YXJpYWJsZXMiOiB7InBob25lTnVtYmVyIjogZiI5MHtzZWxmLnBob25lfSJ9fQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1qc29uKQogICAgICAgICAgICBpZiByLmpzb24oKVsiZGF0YSJdWyJzZW5kT3RwMiJdWyJhbHJlYWR5U2VudCJdID09IEZhbHNlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IHByb2QuZmFzYXBpLm5ldCIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IHByb2QuZmFzYXBpLm5ldCIpCgoKICAgICNrb3Rvbi5jb20KICAgIGRlZiBLb3RvbihzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL3d3dy5rb3Rvbi5jb206NDQzL3VzZXJzL3JlZ2lzdGVyLyIKICAgICAgICAgICAgaGVhZGVycyA9IHsiQ29udGVudC1UeXBlIjogIm11bHRpcGFydC9mb3JtLWRhdGE7IGJvdW5kYXJ5PXNDdi45a1JHNzN2aW84TjdpTHJicFY0NFVMTzhHMmkuV1NhQTRtRFpZRUpGaFNFUi5Mb2RTR0tNRlNhRVFOcjY1Z0hYaGsiLCAiWC1Qcm9qZWN0LU5hbWUiOiAicm4tZW52IiwgIkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyoiLCAiWC1BcHAtVHlwZSI6ICJha2lub24tbW9iaWxlIiwgIlgtUmVxdWVzdGVkLVdpdGgiOiAiWE1MSHR0cFJlcXVlc3QiLCAiQWNjZXB0LUxhbmd1YWdlIjogImVuLVVTLGVuO3E9MC45IiwgIkNhY2hlLUNvbnRyb2wiOiAibm8tc3RvcmUiLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiWC1BcHAtRGV2aWNlIjogImlvcyIsICJSZWZlcmVyIjogImh0dHBzOi8vd3d3LmtvdG9uLmNvbS8iLCAiVXNlci1BZ2VudCI6ICJLb3Rvbi8xIENGTmV0d29yay8xMzM1LjAuMy4yIERhcndpbi8yMS42LjAiLCAiWC1Dc3JmdG9rZW4iOiAiNUREd0NtemlRaGpTUDlpR2hZRTk1NkhIdzd3R2JFaGs1a2VmMjZYTUZ3aEVMSkFXZWFQSzNBM3Z1Znh6dVdjeiJ9CiAgICAgICAgICAgIGRhdGEgPSBmIi0tc0N2LjlrUkc3M3ZpbzhON2lMcmJwVjQ0VUxPOEcyaS5XU2FBNG1EWllFSkZoU0VSLkxvZFNHS01GU2FFUU5yNjVnSFhoa1xyXG5jb250ZW50LWRpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCJmaXJzdF9uYW1lXCJcclxuXHJcbk1lbWF0aVxyXG4tLXNDdi45a1JHNzN2aW84TjdpTHJicFY0NFVMTzhHMmkuV1NhQTRtRFpZRUpGaFNFUi5Mb2RTR0tNRlNhRVFOcjY1Z0hYaGtcclxuY29udGVudC1kaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPVwibGFzdF9uYW1lXCJcclxuXHJcbkJhc1xyXG4tLXNDdi45a1JHNzN2aW84TjdpTHJicFY0NFVMTzhHMmkuV1NhQTRtRFpZRUpGaFNFUi5Mb2RTR0tNRlNhRVFOcjY1Z0hYaGtcclxuY29udGVudC1kaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPVwiZW1haWxcIlxyXG5cclxue3NlbGYubWFpbH1cclxuLS1zQ3YuOWtSRzczdmlvOE43aUxyYnBWNDRVTE84RzJpLldTYUE0bURaWUVKRmhTRVIuTG9kU0dLTUZTYUVRTnI2NWdIWGhrXHJcbmNvbnRlbnQtZGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT1cInBhc3N3b3JkXCJcclxuXHJcbjMxQUJDLi5hYmMzMVxyXG4tLXNDdi45a1JHNzN2aW84TjdpTHJicFY0NFVMTzhHMmkuV1NhQTRtRFpZRUpGaFNFUi5Mb2RTR0tNRlNhRVFOcjY1Z0hYaGtcclxuY29udGVudC1kaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPVwicGhvbmVcIlxyXG5cclxuMHtzZWxmLnBob25lfVxyXG4tLXNDdi45a1JHNzN2aW84TjdpTHJicFY0NFVMTzhHMmkuV1NhQTRtRFpZRUpGaFNFUi5Mb2RTR0tNRlNhRVFOcjY1Z0hYaGtcclxuY29udGVudC1kaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPVwiY29uZmlybVwiXHJcblxyXG50cnVlXHJcbi0tc0N2LjlrUkc3M3ZpbzhON2lMcmJwVjQ0VUxPOEcyaS5XU2FBNG1EWllFSkZoU0VSLkxvZFNHS01GU2FFUU5yNjVnSFhoa1xyXG5jb250ZW50LWRpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCJzbXNfYWxsb3dlZFwiXHJcblxyXG50cnVlXHJcbi0tc0N2LjlrUkc3M3ZpbzhON2lMcmJwVjQ0VUxPOEcyaS5XU2FBNG1EWllFSkZoU0VSLkxvZFNHS01GU2FFUU5yNjVnSFhoa1xyXG5jb250ZW50LWRpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9XCJlbWFpbF9hbGxvd2VkXCJcclxuXHJcbnRydWVcclxuLS1zQ3YuOWtSRzczdmlvOE43aUxyYnBWNDRVTE84RzJpLldTYUE0bURaWUVKRmhTRVIuTG9kU0dLTUZTYUVRTnI2NWdIWGhrXHJcbmNvbnRlbnQtZGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT1cImRhdGVfb2ZfYmlydGhcIlxyXG5cclxuMTk5My0wNy0wMlxyXG4tLXNDdi45a1JHNzN2aW84TjdpTHJicFY0NFVMTzhHMmkuV1NhQTRtRFpZRUpGaFNFUi5Mb2RTR0tNRlNhRVFOcjY1Z0hYaGtcclxuY29udGVudC1kaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPVwiY2FsbF9hbGxvd2VkXCJcclxuXHJcbnRydWVcclxuLS1zQ3YuOWtSRzczdmlvOE43aUxyYnBWNDRVTE84RzJpLldTYUE0bURaWUVKRmhTRVIuTG9kU0dLTUZTYUVRTnI2NWdIWGhrXHJcbmNvbnRlbnQtZGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT1cImdlbmRlclwiXHJcblxyXG5cclxuLS1zQ3YuOWtSRzczdmlvOE43aUxyYnBWNDRVTE84RzJpLldTYUE0bURaWUVKRmhTRVIuTG9kU0dLTUZTYUVRTnI2NWdIWGhrLS1cclxuIgogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywgZGF0YT1kYXRhKQogICAgICAgICAgICBpZiByLnN0YXR1c19jb2RlID09IDIwMjoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBrb3Rvbi5jb20iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBrb3Rvbi5jb20iKQoKCiAgICAjaGF5YXRzdS5jb20udHIKICAgIGRlZiBIYXlhdHN1KHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vd3d3LmhheWF0c3UuY29tLnRyOjQ0My9hcGkvc2lnbnVwL290cHNlbmQiCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwgIkNscy1SZXF1ZXN0aWQiOiAiOTE1OTA1MTMxIiwgIkFjY2VwdCI6ICIqLyoiLCAiQWNjZXB0LUxhbmd1YWdlIjogImVuLVRSO3E9MS4wLCB0ci1UUjtxPTAuOSIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsICJQYXNzd29yZCI6ICJhZzIxMmk1MmZVa093eWMxWjIzNGFkSHMhNTJ5WFQ0dzc4N3FxMio9MTEydGF5IiwgIlVzZXJuYW1lIjogIk54bTFaSHMhIiwgIlVzZXItQWdlbnQiOiAiSGF5YXRTdS8xLjAuMjYgKGNvbS5oYXlhdHN1OyBidWlsZDo0LjA7IGlPUyAxNS43LjcpIEFsYW1vZmlyZS8xLjAuMjYiLCAiQ29ubmVjdGlvbiI6ICJjbG9zZSJ9CiAgICAgICAgICAgIGpzb249eyJtb2JpbGVQaG9uZU51bWJlciI6IHNlbGYucGhvbmV9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJJc1N1Y2Nlc3NmdWwiXSA9PSBUcnVlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGhheWF0c3UuY29tLnRyIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gaGF5YXRzdS5jb20udHIiKQoKCiAgICAjcGlzaXIuY29tCiAgICBkZWYgUGlzaXIoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9hcGkucGlzaXIuY29tOjQ0My92MS9sb2dpbi8iCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkFjY2VwdCI6ICIqLyoiLCAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIsICJVc2VyLUFnZW50IjogIlBpc2lyLzM4NiBDRk5ldHdvcmsvMTMzNS4wLjMuMiBEYXJ3aW4vMjEuNi4wIiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSJ9CiAgICAgICAgICAgIGpzb249eyJhcHBfYnVpbGQiOiAiMzg2IiwgImFwcF9wbGF0Zm9ybSI6ICJpb3MiLCAibXNpc2RuIjogZiIrOTB7c2VsZi5waG9uZX0ifQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1qc29uKQogICAgICAgICAgICBpZiByLmpzb24oKVsib2siXSA9PSAiMSI6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gYXBpLnBpc2lyLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGFwaS5waXNpci5jb20iKQoKCiAgICAjaGl6bGllY3phLmNvbS50cgogICAgZGVmIEhpemxpZWN6YShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL2hpemxpZWN6YXByb2RhcGkuaGl6bGllY3phLm5ldDo0NDMvbW9iaWwvYWNjb3VudC9zZW5kT1RQIgogICAgICAgICAgICBoZWFkZXJzID0geyJBY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiIsICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsICJVc2VyLUFnZW50IjogImhpemxpZWN6YS8xMiBDRk5ldHdvcmsvMTMzNS4wLjMuMiBEYXJ3aW4vMjEuNi4wIiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsICJBdXRob3JpemF0aW9uIjogIkJlYXJlciBudWxsIn0KICAgICAgICAgICAganNvbj17Im90cE9wZXJhdGlvblR5cGUiOiAyLCAicGhvbmVOdW1iZXIiOiBmIis5MHtzZWxmLnBob25lfSJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJpc1N1Y2Nlc3MiXSA9PSBUcnVlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGhpemxpZWN6YXByb2RhcGkuaGl6bGllY3phLm5ldCIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGhpemxpZWN6YXByb2RhcGkuaGl6bGllY3phLm5ldCIpCgoKICAgICNpcHJhZ2F6LmNvbS50cgogICAgZGVmIElwcmFnYXooc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9pcGFwcC5pcHJhZ2F6LmNvbS50cjo0NDMvaXByYWdhem1vYmlsZS92Mi9pcHJhZ2F6LWIyYy9pcHJhZ2F6LWN1c3RvbWVyL21vYmlsZS1yZWdpc3Rlci1vdHAiCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwgIlgtQXBpLVRva2VuIjogIiIsICJBdXRob3JpemF0aW9uIjogIiIsICJBcHAtVmVyc2lvbiI6ICIxLjMuOSIsICJBcHAtTGFuZyI6ICJlbiIsICJBY2NlcHQiOiAiKi8qIiwgIkFwcC1OYW1lIjogImlwcmFnYXotbW9iaWxlIiwgIk9zIjogImlvcyIsICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4tVFI7cT0xLjAsIHRyLVRSO3E9MC45IiwgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwgIlVzZXItQWdlbnQiOiAiaXByYWdhei1tb2JpbGUvMS4zLjkgKGNvbS5pcHJhZ2F6LmlwYXBwOyBidWlsZDo0MTsgaU9TIDE1LjcuNykgQWxhbW9maXJlLzUuNi40IiwgIkFwcC1CdWlsZCI6ICI0MSIsICJPcy1WZXJzaW9uIjogIjE1LjcuNyIsICJVZGlkIjogIjczQUQyRDZFLTlGQzctNDBDMS1BRkYzLTg4RTY3NTkxRENGOCIsICJDb25uZWN0aW9uIjogImNsb3NlIn0KICAgICAgICAgICAganNvbj17ImJpcnRoRGF0ZSI6ICIyLzcvMjAwMCIsICJjYXJQbGF0ZSI6ICIzMSBBQkMgMzEiLCAibW9iaWxlT3RwIjogImYzMmM3OWU2NWNjNjg0YTE0YjE1ZGNiOWRjN2U5ZTlkOTJiMmY2ZDI2OWZkOTAwMGE3Yjc1ZTAyY2ZkOGZhNjMiLCAibmFtZSI6ICJNZW1hdGkgQmFzIiwgIm90cCI6ICIiLCAicGhvbmVOdW1iZXIiOiBzZWxmLnBob25lLCAicGxheWVySWQiOiAiIn0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gaXBhcHAuaXByYWdhei5jb20udHIiKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBpcGFwcC5pcHJhZ2F6LmNvbS50ciIpCgoKICAgICNtZXRyby10ci5jb20KICAgIGRlZiBNZXRybyhzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL2ZlYXR1cmUubWV0cm8tdHIuY29tOjQ0My9hcGkvbW9iaWxlQXV0aC92YWxpZGF0ZVNtc1NlbmQiCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkFjY2VwdCI6ICIqLyoiLCAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgiLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiQXBwbGljYXRpb252ZXJzaW9uIjogIjIuMS4xIiwgIkFwcGxpY2F0aW9ucGxhdGZvcm0iOiAiMiIsICJVc2VyLUFnZW50IjogIk1ldHJvIFR1cmtpeWUvMi4xLjEgKGNvbS5tY2N0ci5tb2JpbGVhcHBsaWNhdGlvbjsgYnVpbGQ6MTsgaU9TIDE1LjcuNykgQWxhbW9maXJlLzIuMS4xIiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1UUjtxPTEuMCwgdHItVFI7cT0wLjkiLCAiQ29ubmVjdGlvbiI6ICJjbG9zZSJ9CiAgICAgICAgICAgIGpzb249eyJtZXRob2RUeXBlIjogIjIiLCAibW9iaWxlUGhvbmVOdW1iZXIiOiBmIis5MHtzZWxmLnBob25lfSJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJzdGF0dXMiXSA9PSAic3VjY2VzcyI6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gZmVhdHVyZS5tZXRyby10ci5jb20iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBmZWF0dXJlLm1ldHJvLXRyLmNvbSIpCgoKICAgICNrdW1wb3J0LmNvbS50cgogICAgZGVmIEt1bXBvcnQoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSBmImh0dHBzOi8vb25saW5lLmt1bXBvcnQuY29tLnRyOjQ0My9BcGkvQ2xpZW50L0NhbGxBcGk/YWN0aW9uPWt1bXBvcnQvVXNlci9TZW5kU21zQ29kZVRvVXNlcj9waG9uZU51bWJlcj17c2VsZi5waG9uZX1fQU5EX2lwPSIKICAgICAgICAgICAgaGVhZGVycyA9IHsiVXNlci1BZ2VudCI6ICJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0OyBydjoxMDkuMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC8xMTQuMCIsICJBY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiwgdGV4dC9wbGFpbiwgKi8qIiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJ0ci1UUix0cjtxPTAuOCxlbi1VUztxPTAuNSxlbjtxPTAuMyIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsICJYLVhzcmYtVG9rZW4iOiAiZExXLWd5aUV1WFZBWDQya3hkZ2NjRmpyQ3VDa2xNX1pxdndmelR0VUVpbko1UUFfNTRNSjRqSTcxSkdfWXpFZ3pOV3RLdFJ1SUI5T21DV2l6NFFLdlRsTy1GRFRzUHdTMnRZcEc0QXhQbm8xIiwgIkRudCI6ICIxIiwgIlJlZmVyZXIiOiAiaHR0cHM6Ly9vbmxpbmUua3VtcG9ydC5jb20udHIvIiwgIlNlYy1GZXRjaC1EZXN0IjogImVtcHR5IiwgIlNlYy1GZXRjaC1Nb2RlIjogImNvcnMiLCAiU2VjLUZldGNoLVNpdGUiOiAic2FtZS1vcmlnaW4iLCAiVGUiOiAidHJhaWxlcnMiLCAiQ29ubmVjdGlvbiI6ICJjbG9zZSJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5nZXQodXJsLCBoZWFkZXJzPWhlYWRlcnMsIHZlcmlmeT1GYWxzZSkKICAgICAgICAgICAgaWYgci50ZXh0LnJlcGxhY2UoIlwiIiwgIiIpLnNwbGl0KCIsIilbMV0uc3BsaXQoIjoiKVsxXS5sb3dlcigpID09ICJ0cnVlIjoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBvbmxpbmUua3VtcG9ydC5jb20udHIiKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBvbmxpbmUua3VtcG9ydC5jb20udHIiKQoKICAgIAogICAgI3F1bXBhcmEuY29tCiAgICBkZWYgUXVtcGFyYShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL3RyLWFwaS5maXNpY2VrLmNvbTo0NDMvdjEuMy9hdXRoL2dldE9UUCIKICAgICAgICAgICAgaGVhZGVycyA9IHsiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24iLCAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiVXNlci1BZ2VudCI6ICJxdW1wYXJhLzQuMi41MyAoaVBob25lOyBpT1MgMTUuNy43OyBTY2FsZS8zLjAwKSIsICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4tVFI7cT0xLCB0ci1UUjtxPTAuOSJ9CiAgICAgICAgICAgIGpzb249eyJtc2lzZG4iOiBmIis5MHtzZWxmLnBob25lfSJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuc3RhdHVzX2NvZGUgPT0gMjAwOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IHRyLWFwaS5maXNpY2VrLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IHRyLWFwaS5maXNpY2VrLmNvbSIpCgoKICAgICNwYXlib2wuY29tLnRyCiAgICBkZWYgUGF5Ym9sKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vcHliLW1vYmlsZWFwaS53YWxsZXRnYXRlLmlvOjQ0My92MS9BY2NvdW50L1JlZ2lzdGVyUGVyc29uYWxBY2NvdW50U2VuZE90cFNtcyIKICAgICAgICAgICAgaGVhZGVycyA9IHsiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24iLCAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLCAiVXNlci1BZ2VudCI6ICJQYXlib2wvMS4yLjEgKGNvbS5hcHAucGF5Ym9sOyBidWlsZDoxOyBpT1MgMTUuNy43KSBBbGFtb2ZpcmUvNS41LjAiLCAiQWNjZXB0LUxhbmd1YWdlIjogImVuLVRSO3E9MS4wLCB0ci1UUjtxPTAuOSIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsICJDb25uZWN0aW9uIjogImNsb3NlIn0KICAgICAgICAgICAganNvbj17InBob25lX251bWJlciI6IGYiOTB7c2VsZi5waG9uZX0ifQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1qc29uKQogICAgICAgICAgICBpZiByLmpzb24oKVsic3RhdHVzIl0gPT0gMDoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBweWItbW9iaWxlYXBpLndhbGxldGdhdGUuaW8iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBweWItbW9iaWxlYXBpLndhbGxldGdhdGUuaW8iKQoKICAgICAgICAKICAgICNtaWdyb3MuY29tLnRyCiAgICBkZWYgTWlncm9zKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vcmVzdC5taWdyb3MuY29tLnRyOjQ0My9oZW1lbi91c2Vycy9sb2dpbi9vdHAiCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwgIlgtRGV2aWNlLVBsYXRmb3JtIjogIklPUyIsICJYLVJlcXVlc3QtSWRlbnRpZmllciI6ICI2MDU5RjAyNy1GNkJDLTQxQTktOTNFNi03N0ZCMzg4REExOUIiLCAiQWNjZXB0IjogIiovKiIsICJYLURldmljZS1Nb2RlbCI6ICJpUGhvbmUgNyBQbHVzIiwgIlgtU3RvcmUtSWRzIjogIiIsICJYLURldmljZS1WZXJzaW9uIjogIjEwLjUuMiIsICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkiLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiWC1EZXZpY2UtUGxhdGZvcm0tVmVyc2lvbiI6ICIxNS43LjciLCAiVXNlci1BZ2VudCI6ICJNaWdyb3MvMTY5MCBDRk5ldHdvcmsvMTMzNS4wLjMuMiBEYXJ3aW4vMjEuNi4wIiwgIlgtRGV2aWNlLUlkZW50aWZpZXIiOiAiREEzOTFGRDYtNzI5OS00QTRFLUEzNUUtMUQzMDkwNTQ3NTgyIiwgIlgtRGV2aWNlLUxhdGl0dWRlIjogIiIsICJYLURldmljZS1Mb25naXR1ZGUiOiAiIiwgIlgtRGV2aWNlLVR5cGUiOiAiTU9CSUxFIn0KICAgICAgICAgICAganNvbj17InBob25lTnVtYmVyIjogc2VsZi5waG9uZX0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5qc29uKClbInN1Y2Nlc3NmdWwiXSA9PSBUcnVlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IHJlc3QubWlncm9zLmNvbS50ciIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IHJlc3QubWlncm9zLmNvbS50ciIpCgoKICAgICNmaWxlLmNvbS50cgogICAgZGVmIEZpbGUoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9hcGkuZmlsZW1hcmtldC5jb20udHI6NDQzL3YxL290cC9zZW5kIgogICAgICAgICAgICBoZWFkZXJzID0geyJBY2NlcHQiOiAiKi8qIiwgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwgIlVzZXItQWdlbnQiOiAiZmlsZW1hcmtldC8yMDIyMDYwMTIwMDEzIENGTmV0d29yay8xMzM1LjAuMy4yIERhcndpbi8yMS42LjAiLCAiWC1PcyI6ICJJT1MiLCAiWC1WZXJzaW9uIjogIjEuNyIsICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkiLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUifQogICAgICAgICAgICBqc29uPXsibW9iaWxlUGhvbmVOdW1iZXIiOiBmIjkwe3NlbGYucGhvbmV9In0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5qc29uKClbInJlc3BvbnNlVHlwZSJdID09ICJTVUNDRVNTIjoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBhcGkuZmlsZW1hcmtldC5jb20udHIiKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBhcGkuZmlsZW1hcmtldC5jb20udHIiKQoKCiAgICAjcm9vbWJhZGkuY29tCiAgICBkZWYgUm9vbWJhZGkoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9hcGkucm9vbWJhZGkuY29tOjQ0My9hcGkvdjIvYXV0aC9vdHAvYXV0aGVudGljYXRlIgogICAgICAgICAgICBoZWFkZXJzID0geyJBY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiwgdGV4dC9wbGFpbiwgKi8qIiwgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwgIlVzZXItQWdlbnQiOiAiUm9vbWJhZGkvMyBDRk5ldHdvcmsvMTMzNS4wLjMuMiBEYXJ3aW4vMjEuNi4wIiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbix0ciJ9CiAgICAgICAgICAgIGpzb249eyJjb3VudHJ5SWQiOiAyLCAicGhvbmUiOiBzZWxmLnBob25lfQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1qc29uKQogICAgICAgICAgICBpZiByLmpzb24oKVsicmVtYWluaW5nVGltZSJdID09IDEyMDoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBhcGkucm9vbWJhZGkuY29tIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gYXBpLnJvb21iYWRpLmNvbSIpCgogICAgCiAgICAjZ295YWtpdC5jb20udHIKICAgIGRlZiBHbyhzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL2dvbW9iaWxhcHAuaXByYWdhei5jb20udHI6NDQzL2FwaS92MS8wL2F1dGhlbnRpY2F0aW9uL2o5NHMtZzU5IgogICAgICAgICAgICBoZWFkZXJzID0geyJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsICJBY2NlcHQiOiAiKi8qIiwgIkF1dGhvcml6YXRpb24iOiAiIiwgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwgIklmLU5vbmUtTWF0Y2giOiAiVy9cIjRiLTliVksxTE83b3JZaXhvUnNDcXlSZE1QMVQ5c1wiIiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1UUjtxPTEuMCwgdHItVFI7cT0wLjkiLCAiU3VyZnRva2VuIjogImV5SmhiR2NpT2lKSVV6STFOaUlzSW5SNWNDSTZJa3BYVkNKOS5leUprWlhacFkyVkpaQ0k2SWpSR04wVkNOVVpETFRORU1VTXRORVV6UlMwNU1FWkNMVUl4TXprM1F6RXhPVGd5UWlJc0ltbGhkQ0k2TVRZNU1EY3hOVFkzTXl3aVpYaHdJam94Tmprek16QTNOamN6ZlEuMlpRVkNvZzZQLWxjTVI4WFZZeldHZUxrVEtBUUhIYkNibnBoamd6WUkyQyIsICJVc2VyLUFnZW50IjogImlwcmFnYXpnby8yLjIuNyAoY29tLmlwcmFlbmVyamkuZ287IGJ1aWxkOjE7IGlPUyAxNS43LjcpIEFsYW1vZmlyZS81LjcuMSIsICJSZWZyZXNodG9rZW4iOiAiIiwgIkNvbm5lY3Rpb24iOiAiY2xvc2UifQogICAgICAgICAgICBqc29uPXsiaXNSZWdpc3RlcmVkIjogRmFsc2UsICJwaG9uZSI6IHNlbGYucGhvbmV9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJkYXRhIl1bInN1Y2Nlc3MiXSA9PSBUcnVlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGdvbW9iaWxhcHAuaXByYWdhei5jb20udHIiKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBnb21vYmlsYXBwLmlwcmFnYXouY29tLnRyIikKCgogICAgI2pva2VyLmNvbS50cgogICAgZGVmIEpva2VyKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vYXBpLmpva2VyLmNvbS50cjo0NDMvYXBpL3JlZ2lzdGVyIgogICAgICAgICAgICBoZWFkZXJzID0geyJBY2NlcHQiOiAiKi8qIiwgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwgIkF1dGhvcml6YXRpb24iOiAiQmVhcmVyIGV5SjBlWEFpT2lKS1YxUWlMQ0poYkdjaU9pSlNVekkxTmlKOS5leUpwWVhRaU9qRTJPVEEzTVRZMU1qRXNJbVY0Y0NJNk1UWTVOVGt3TURVeU1Td2lkWE5sY201aGJXVWlPaUpIVlVWVFZERTJPVEEzTVRZMU1qRXpNekEzTXpkQWFtOXJaWEl1WTI5dExuUnlJaXdpWjNWbGMzUWlPblJ5ZFdWOS5UYVFBOFpEdG1VMDllRnFPRkFUUzh1YlhNNEJIUFFMX0JjZ2VFb3FaZnVOWmNmamZMX3h6cVJPN2ZaZWh6V3pFZGpIWE5YZUNVVGRqeDc2RXlWQi1iM1RGdUwzT2FobXJiZWFPSUNEOE1YY2hoTUR2NzhURmhXek9KOUFkLU1tYTZRUFNjU1NWTDBwWW9RSFdSaHphZU9rbVZleXBxWWlRS0dtT0VrOU56Zk9WeERZUGEyNWlKbWV0aWFiMVpfYjk1SHF0NUNsczUyVjdnNHBHV21iallCM2d5ZVVRbjVJSTZuZUtOMTc0dHhwMXlhR2RyTlBZd0FrX2FSSnpvQU1BMVNpc1ptNHJoamRFXzlNZXlHd2piZ2syb2JQeEVWY3d2UFB3a2Q1Nl9hMzRhRE9lbzZyQXZuZ0dBTEJQV2xTODluZkhGYjZQVTJmS3lLN2pUYVZsQzBEaVZub2psa0NfS3pvSGNwdE03U2pRQnltNEJuOUNYWjRrajJKMU9tLWRoRHltUXluU0NmbVEzSlpRZDduMVlkUVlZTXVBb1RiamdoWmh5UHUyU0N0bEk3YW82SmhVVWNtdE8zZmpJaXlZZ0FkZ0QtRkRjcVNHQXM5aTVmbjNrQ2lkU2t1NU00bGpxMW92Sk00QmVhTmVRZEZYcUVfV3F1cnBPZUxBOTVmTnVtR0NvWHZKR2xMaFM1VnpNZEZULWwzY2ZkUHQwVjBXbXRqSkRScFRub3NqZ2Zpeng0RjVxZnRsVnVGOTh1b0ZvZXhnN2xRWUh5Wi1qNDU1LWQ1QjI0X1dmVThHQ2pRaHRsRFZ0U1RjTWlSdlVLRWpKLUdsbTVzeXY1VlZiUjdtSnh1NjRTQjJKMmRQYkhjSWs2QlF1RllYSUprbE43R1h4RGE4bVNuRVpkcyIsICJBY2NlcHQtRW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsICJVc2VyLUFnZW50IjogIkpva2VyLzQuMC4xNCAoY29tLmpva2VyLmFwcDsgYnVpbGQ6MjsgaU9TIDE1LjcuNykgQWxhbW9maXJlLzUuNC4zIiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1UUjtxPTEuMCwgdHItVFI7cT0wLjkiLCAiQ29ubmVjdGlvbiI6ICJjbG9zZSJ9CiAgICAgICAgICAgIGpzb249eyJmaXJzdE5hbWUiOiAiTWVtYXRpIiwgImdlbmRlciI6ICJtIiwgImlvc1ZlcnNpb24iOiAiNC4wLjIiLCAibGFzdE5hbWUiOiAiQmFzIiwgIm9zIjogIklPUyIsICJwYXNzd29yZCI6ICIzMUFCQy4uYWJjMzEiLCAicGhvbmVOdW1iZXIiOiBmIjB7c2VsZi5waG9uZX0iLCAidXNlcm5hbWUiOiBzZWxmLm1haWx9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJtZXNzYWdlIl0gPT0gIkRvxJ9ydWxhbWEga29kdSBnw7ZuZGVyaWxkaS4iOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGFwaS5qb2tlci5jb20udHIiKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBhcGkuam9rZXIuY29tLnRyIikKICAgICAgICAgICAgCiAgICAgICAgCiAgICAjYWstYXN5YS5jb20udHIKICAgIGRlZiBBa2FzeWEoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9ha2FzeWEtYWRtaW4ucG9pbGFicy5jb20vdjEvdHIvc21zIgogICAgICAgICAgICBqc29uPXsicGhvbmUiOiBzZWxmLnBob25lfQogICAgICAgICAgICBoZWFkZXJzID0geyJ4LXBsYXRmb3JtLXRva2VuIjogIjMxMzEzMSJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybD11cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1qc29uKQogICAgICAgICAgICBpZiByLmpzb24oKVsicmVzdWx0Il0gPT0gIlNNUyBzZW5kZWQgc3VjY2VzZnVsbHkhIjoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBha2FzeWEtYWRtaW4ucG9pbGFicy5jb20iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBha2FzeWEtYWRtaW4ucG9pbGFicy5jb20iKQogICAgICAgIAogICAgICAgIAogICAgI2FrYmF0aS5jb20KICAgIGRlZiBBa2JhdGkoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9ha2JhdGktYWRtaW4ucG9pbGFicy5jb20vdjEvdHIvc21zIgogICAgICAgICAgICBqc29uPXsicGhvbmUiOiBzZWxmLnBob25lfQogICAgICAgICAgICBoZWFkZXJzID0geyJ4LXBsYXRmb3JtLXRva2VuIjogIjMxMzEzMSJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybD11cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1qc29uKQogICAgICAgICAgICBpZiByLmpzb24oKVsicmVzdWx0Il0gPT0gIlNNUyBzZW5kZWQgc3VjY2VzZnVsbHkhIjoKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBha2JhdGktYWRtaW4ucG9pbGFicy5jb20iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBha2JhdGktYWRtaW4ucG9pbGFicy5jb20iKQogICAgCiAgICAKICAgICNjbGlja21lbGl2ZS5jb20KICAgIGRlZiBDbGlja21lKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vZGV2LWF6dXJlLW1vYmlsZS1hcGkuY2xpY2ttZWxpdmUuY29tOjQ0My9hcGkvdjEvYXV0aG9yaXphdGlvbi9jb2RlIgogICAgICAgICAgICBoZWFkZXJzID0geyJBdXRob3JpemF0aW9uIjogImFwaUtleSA2MTcxOTZmYzY1ZGMwNzc4ZmI1OWU5NzY2MDg1NmQxOTIxYmVmNWEwOTJiYjQwNzFmM2MwNzE3MDRlNWNhNGNjIiwgIkNsaWVudC1WZXJzaW9uIjogIjEuMC40NCIsICJDbGllbnQtRGV2aWNlIjogIklPUyIsICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkiLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiVXNlci1BZ2VudCI6ICJDbGlja01lTGl2ZS84NSBDRk5ldHdvcmsvMTMzNS4wLjMuNCBEYXJ3aW4vMjEuNi4wIn0KICAgICAgICAgICAganNvbj17InBob25lIjogc2VsZi5waG9uZX0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsPXVybCwganNvbj1qc29uLCBoZWFkZXJzPWhlYWRlcnMpCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJpc1N1Y2Nlc3MiXSA9PSBUcnVlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGRldi1henVyZS1tb2JpbGUtYXBpLmNsaWNrbWVsaXZlLmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IGRldi1henVyZS1tb2JpbGUtYXBpLmNsaWNrbWVsaXZlLmNvbSIpCiAgICAKICAgIAogICAgI2hhcHB5LmNvbS50cgogICAgZGVmIEhhcHB5KHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vd3d3LmhhcHB5LmNvbS50cjo0NDMvaW5kZXgucGhwP3JvdXRlPWFjY291bnQvcmVnaXN0ZXIvdmVyaWZ5UGhvbmUiCiAgICAgICAgICAgIGhlYWRlcnMgPSB7IkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9VVRGLTgiLCAiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvamF2YXNjcmlwdCwgKi8qOyBxPTAuMDEiLCAiWC1SZXF1ZXN0ZWQtV2l0aCI6ICJYTUxIdHRwUmVxdWVzdCIsICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkiLCAiQWNjZXB0LUVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiT3JpZ2luIjogImh0dHBzOi8vd3d3LmhhcHB5LmNvbS50ciIsICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChpUGhvbmU7IENQVSBpUGhvbmUgT1MgMTVfN184IGxpa2UgTWFjIE9TIFgpIEFwcGxlV2ViS2l0LzYwNS4xLjE1IChLSFRNTCwgbGlrZSBHZWNrbykiLCAiUmVmZXJlciI6ICJodHRwczovL3d3dy5oYXBweS5jb20udHIvaW5kZXgucGhwP3JvdXRlPWFjY291bnQvcmVnaXN0ZXIifQogICAgICAgICAgICBkYXRhID0geyJ0ZWxlcGhvbmUiOiBzZWxmLnBob25lfQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmw9dXJsLCBkYXRhPWRhdGEsIGhlYWRlcnM9aGVhZGVycykKICAgICAgICAgICAgaWYgci5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gaGFwcHkuY29tLnRyIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gaGFwcHkuY29tLnRyIikKICAgIAoKICAgICNrb21hZ2VuZS5jb20udHIKICAgIGRlZiBLb21hZ2VuZShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL2dhdGV3YXkua29tYWdlbmUuY29tLnRyL2F1dGgvYXV0aC9zbXNrb2R1Z29uZGVyIgogICAgICAgICAgICBqc29uPXsiVGVsZWZvbiI6IHNlbGYucGhvbmUsIkZpcm1hSWQiOiAiMzIifQogICAgICAgICAgICBoZWFkZXJzID0geyJ1c2VyLWFnZW50IjogIk1vemlsbGEvNS4wIChpUGhvbmU7IENQVSBpUGhvbmUgT1MgMTVfN184IGxpa2UgTWFjIE9TIFgpIEFwcGxlV2ViS2l0LzYwNS4xLjE1IChLSFRNTCwgbGlrZSBHZWNrbykifQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmw9dXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5qc29uKClbIlN1Y2Nlc3MiXSA9PSBUcnVlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGdhdGV3YXkua29tYWdlbmUuY29tLnRyIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gZ2F0ZXdheS5rb21hZ2VuZS5jb20udHIiKQogICAgCiAgICAKICAgICNrdXJ5ZW1nZWxzaW4uY29tCiAgICBkZWYgS3VyeWVtR2Vsc2luKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vYXBpLmt1cnllbWdlbHNpbi5jb206NDQzL2VuL2FwaS91c2Vycy9yZWdpc3Rlck1lc3NhZ2UvIgogICAgICAgICAgICBqc29uPXsicGhvbmVOdW1iZXIiOiBzZWxmLnBob25lLCAicGhvbmVfY291bnRyeV9jb2RlIjogIis5MCJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybD11cmwsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gYXBpLmt1cnllbWdlbHNpbi5jb20iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBhcGkua3VyeWVtZ2Vsc2luLmNvbSIpCiAgICAKICAgIAogICAgI3BvcnR5LnRlY2gKICAgIGRlZiBQb3J0eShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwczovL3BhbmVsLnBvcnR5LnRlY2g6NDQzL2FwaS5waHA/IgogICAgICAgICAgICBoZWFkZXJzID0geyJBY2NlcHQiOiAiKi8qIiwgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PVVURi04IiwgIkFjY2VwdC1FbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsICJVc2VyLUFnZW50IjogIlBvcnR5LzEgQ0ZOZXR3b3JrLzEzMzUuMC4zLjQgRGFyd2luLzIxLjYuMCIsICJUb2tlbiI6ICJxMnpTNmtYN1dZRlJ3VllBckRkTTY2eDcyZFI2aG5aQVNaIn0KICAgICAgICAgICAganNvbj17ImpvYiI6ICJzdGFydF9sb2dpbiIsICJwaG9uZSI6IHNlbGYucGhvbmV9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybD11cmwsIGpzb249anNvbiwgaGVhZGVycz1oZWFkZXJzKQogICAgICAgICAgICBpZiByLmpzb24oKVsic3RhdHVzIl09PSAic3VjY2VzcyI6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gcGFuZWwucG9ydHkudGVjaCIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IHBhbmVsLnBvcnR5LnRlY2giKQogICAgICAgICAgICAKICAgIAogICAgI3Rha3NpbS5kaWdpdGFsCiAgICBkZWYgVGFrc2ltKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vc2VydmljZS50YWtzaW0uZGlnaXRhbC9zZXJ2aWNlcy9QYXNzZW5nZXJSZWdpc3Rlci9SZWdpc3RlciIKICAgICAgICAgICAganNvbj0geyJjb3VudHJ5UGhvbmVDb2RlIjogIis5MCIsInBob25lTm8iOiBzZWxmLnBob25lfQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmw9dXJsLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJzdWNjZXNzIl09PSBUcnVlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IHNlcnZpY2UudGFrc2ltLmRpZ2l0YWwiKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBzZXJ2aWNlLnRha3NpbS5kaWdpdGFsIikKICAgIAogICAgCiAgICAjdmFraWZ0YXNkZWxlbnN1LmNvbQogICAgZGVmIFRhc2RlbGVuKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHA6Ly85NC4xMDIuNjYuMTYyOjgwL01vYmlsU2VydmlzL2FwaS9Nb2JpbE9wZXJhdGlvbi9DdXN0b21lclBob25lU21zU2VuZCIKICAgICAgICAgICAganNvbj0geyJQaG9uZU51bWJlciI6IHNlbGYucGhvbmUsICJ1c2VyIjogeyJQYXNzd29yZCI6ICJBYTEyMyEzNUAxIiwiVXNlck5hbWUiOiAiTW9iaWxPcGVyYXRvciJ9fQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmw9dXJsLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuanNvbigpWyJSZXN1bHQiXT09IFRydWU6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gOTQuMTAyLjY2LjE2Mjo4MCIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IDk0LjEwMi42Ni4xNjI6ODAiKQogICAgCiAgICAKICAgICN0YXNpbWFjaW0uY29tCiAgICBkZWYgVGFzaW1hY2ltKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vc2VydmVyLnRhc2ltYWNpbS5jb20vcmVxdWVzdGNvZGUiCiAgICAgICAgICAgIGpzb249IHsicGhvbmUiOiBzZWxmLnBob25lLCAibGFuZyI6ICJ0ciJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybD11cmwsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gc2VydmVyLnRhc2ltYWNpbS5jb20iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBzZXJ2ZXIudGFzaW1hY2ltLmNvbSIpCiAgICAKICAgIAogICAgI3RvcHRhbnRlc2xpbS5jb20KICAgIGRlZiBUb3B0YW5UZXNsaW0oc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly90dC5ldGljLmNvbS50cjo0NDMvYXBpL3NldEN1c3RvbWVyIgogICAgICAgICAgICBoZWFkZXJzID0geyJhdXRob3JpemF0aW9uIjogIkJhc2ljIGRHOXdkR0Z1ZEdWemJHbHRPalIxTjNnaFFTVkVLa2N0UzJGT1pGSm5WV3RZY0RKek5YWTRlUzlDUDBVb1NDdE5ZbEZsVTJoV2JWbHhNM1EyZHpsNkpFTW1SaWxLUUU1alVtWlZhbGR1V25JMGRUZDRJVUVsUkNwSExVdGhVR1JUWjFacldYQXljelYyT0hrdlFqOUZLRWdyVFdKUlpWUm9WMjFhY1RSME5uYzVlaVJESmtZcFNrQk9ZMUptIn0KICAgICAgICAgICAgZGF0YSA9IHsidGVsZXBob25lIjogZiIwe3NlbGYucGhvbmV9IiwibmFtZSI6ICJNZW1hdGkiLCJzdXJuYW1lIjogIkJhcyIsImVtYWlsIjogc2VsZi5tYWlsLCJwYXNzd29yZCI6ICIzMTMxMzEiLCJwYXNzd29yZF9jb25maXJtYXRpb24iOiAiMzEzMTMxIn0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLnBvc3QodXJsPXVybCwgZGF0YT1kYXRhLCBoZWFkZXJzPWhlYWRlcnMpCiAgICAgICAgICAgIGlmIHIuc3RhdHVzX2NvZGUgPT0gMjAwOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IHR0LmV0aWMuY29tLnRyIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gdHQuZXRpYy5jb20udHIiKQogICAgCgogICAgI3VuaWxldmVyLmNvbS50cgogICAgZGVmIFVuaWxldmVyKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vd3d3LnNpcGFyaXNkaXJla3QuY29tL2N1c3RvbWVyL290cC9zZW5kb3RwIgogICAgICAgICAgICBkYXRhID0geyJtb2JpbGUiOiBzZWxmLnBob25lLCAicHJlZml4IjogIis5MCJ9CiAgICAgICAgICAgIGhlYWRlcnMgPSB7ImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9VVRGLTgiLCAieC1yZXF1ZXN0ZWQtd2l0aCI6ICJYTUxIdHRwUmVxdWVzdCJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybD11cmwsIGhlYWRlcnM9aGVhZGVycywgZGF0YT1kYXRhKQogICAgICAgICAgICBpZiByLmpzb24oKVsic3RhdHVzIl0gPT0gMToKICAgICAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRHUkVFTl9FWH1bK10ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsWzEsSEge3NlbGYucGhvbmV9IC0tPiBzaXBhcmlzZGlyZWt0LmNvbSIpCiAgICAgICAgICAgICAgICBzZWxmLmFkZXQgKz0gMQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50KGYie0ZvcmUuTElHSFRSRURfRVh9Wy1dIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFzxLF6ISB7c2VsZi5waG9uZX0gLS0+IHNpcGFyaXNkaXJla3QuY29tIikKCgogICAgI3V5c2FsbWFya2V0LmNvbS50cgogICAgZGVmIFV5c2FsKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vYXBpLnV5c2FsbWFya2V0LmNvbS50ci9hcGkvbW9iaWxlLXVzZXJzL3NlbmQtcmVnaXN0ZXItc21zIgogICAgICAgICAgICBqc29uID0geyJwaG9uZV9udW1iZXIiOiBzZWxmLnBob25lfQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmw9dXJsLCBqc29uPWpzb24pCiAgICAgICAgICAgIGlmIHIuc3RhdHVzX2NvZGUgPT0gMjAwOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IGFwaS51eXNhbG1hcmtldC5jb20udHIiKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBhcGkudXlzYWxtYXJrZXQuY29tLnRyIikKICAgIAogICAgCiAgICAjeWFwcC5jb20udHIKICAgIGRlZiBZYXBwKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8veWFwcC5jb20udHI6NDQzL2FwaS9tb2JpbGUvdjEvcmVnaXN0ZXIiCiAgICAgICAgICAgIGpzb249eyJhcHBfdmVyc2lvbiI6ICIxLjEuMiIsICJjb2RlIjogInRyIiwgImRldmljZV9tb2RlbCI6ICJpUGhvbmU5LDQiLCAiZGV2aWNlX25hbWUiOiAiIiwgImRldmljZV90eXBlIjogIkkiLCAiZGV2aWNlX3ZlcnNpb24iOiAiMTUuNy44IiwgImVtYWlsIjogc2VsZi5tYWlsLCAiZmlyc3RuYW1lIjogIk1lbWF0aSIsICJpc19hbGxvd190b19jb21tdW5pY2F0aW9uIjogIjEiLCAibGFuZ3VhZ2VfaWQiOiAiMSIsICJsYXN0bmFtZSI6ICJCYXMiLCAicGhvbmVfbnVtYmVyIjogc2VsZi5waG9uZSwgInNtc19jb2RlIjogIiJ9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybD11cmwsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4geWFwcC5jb20udHIiKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiB5YXBwLmNvbS50ciIpCiAgICAKICAgIAogICAgI3lpbG1henRpY2FyZXQubmV0CiAgICBkZWYgWWlsbWF6VGljYXJldChzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCA9ICJodHRwOi8vd3d3LnlpbG1henRpY2FyZXQubmV0OjgwL3Jlc3RhcGkyL3JlZ2lzdGVyLyIKICAgICAgICAgICAgaGVhZGVycyA9IHsiQXV0aG9yaXphdGlvbiI6ICJCYXNpYyBlV2xzYldGNk9ubHBiRzFoZWpJd01Ua3FLZz09In0KICAgICAgICAgICAgZGF0YSA9IHsidGVsZWZvbiI6IChOb25lLCBmIjAge3NlbGYucGhvbmV9IiksInRva2VuIjogKE5vbmUsICJFeHBvbmVudFB1c2hUb2tlbltlV0pqRmFOX2JoakFBYk5fcnhVSWxwXSIpfQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywgIGRhdGE9ZGF0YSkKICAgICAgICAgICAgaWYgci5qc29uKClbImdpcmlzIl0gPT0gInN1Y2Nlc3MiOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVEdSRUVOX0VYfVsrXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxbMSxISB7c2VsZi5waG9uZX0gLS0+IHlpbG1henRpY2FyZXQubmV0IikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4geWlsbWF6dGljYXJldC5uZXQiKQogICAgCiAgICAKICAgICN5dWZmaS5jbwogICAgZGVmIFl1ZmZpKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vYXBpLnl1ZmZpLmNvL2FwaS9wYXJlbnQvbG9naW4vdXNlciIKICAgICAgICAgICAganNvbiA9IHsicGhvbmUiOiBzZWxmLnBob25lLCAia3ZrayI6IFRydWV9CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KHVybCwganNvbj1qc29uKQogICAgICAgICAgICBpZiByLmpzb24oKVsic3VjY2VzcyJdID09IFRydWU6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gYXBpLnl1ZmZpLmNvIikKICAgICAgICAgICAgICAgIHNlbGYuYWRldCArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5MSUdIVFJFRF9FWH1bLV0ge1N0eWxlLlJFU0VUX0FMTH1CYcWfYXLEsXPEsXohIHtzZWxmLnBob25lfSAtLT4gYXBpLnl1ZmZpLmNvIikKICAgICAgICAgICAgCgogICAgI2JlZWZ1bGwuY29tCiAgICBkZWYgIEJlZWZ1bGwoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9hcHAuYmVlZnVsbC5pbzo0NDMvYXBpL2luYXZpdGFzLWFjY2Vzcy1tYW5hZ2VtZW50L3NpZ251cCIKICAgICAgICAgICAganNvbj17ImVtYWlsIjogc2VsZi5tYWlsLCAiZmlyc3ROYW1lIjogIk1lbWF0aSIsICJsYW5ndWFnZSI6ICJ0ciIsICJsYXN0TmFtZSI6ICJCYXMiLCAicGFzc3dvcmQiOiAiMTIzNDU2IiwgInBob25lQ29kZSI6ICI5MCIsICJwaG9uZU51bWJlciI6IHNlbGYucGhvbmUsICJ0ZW5hbnQiOiAiYmVlZnVsbCIsICJ1c2VybmFtZSI6IHNlbGYubWFpbH0KICAgICAgICAgICAgcmVxdWVzdHMucG9zdCh1cmwsIGpzb249anNvbikKICAgICAgICAgICAgdXJsID0gImh0dHBzOi8vYXBwLmJlZWZ1bGwuaW86NDQzL2FwaS9pbmF2aXRhcy1hY2Nlc3MtbWFuYWdlbWVudC9zbXMtbG9naW4iCiAgICAgICAgICAgIGpzb249eyJwaG9uZUNvZGUiOiAiOTAiLCAicGhvbmVOdW1iZXIiOiBzZWxmLnBob25lLCAidGVuYW50IjogImJlZWZ1bGwifQogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwsIGpzb249anNvbikKICAgICAgICAgICAgaWYgci5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUR1JFRU5fRVh9WytdIHtTdHlsZS5SRVNFVF9BTEx9QmHFn2FyxLFsxLEhIHtzZWxmLnBob25lfSAtLT4gYXBwLmJlZWZ1bGwuaW8iKQogICAgICAgICAgICAgICAgc2VsZi5hZGV0ICs9IDEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludChmIntGb3JlLkxJR0hUUkVEX0VYfVstXSB7U3R5bGUuUkVTRVRfQUxMfUJhxZ9hcsSxc8SxeiEge3NlbGYucGhvbmV9IC0tPiBhcHAuYmVlZnVsbC5pbyIp
